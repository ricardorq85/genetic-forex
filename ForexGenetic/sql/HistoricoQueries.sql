SELECT DISTINCT OWNER FROM ALL_TABLES;
SELECT * FROM ALL_TABLES;
STARTUP MOUNT;
RECOVER DATABASE;
SHUTDOWN IMMEDIATE;
shutdown immediate;
startup mount;
SHUTDOWN IMMEDIATE; startup mount;
select open_mode from v$database;
SELECT TRUNC(FECHA_PROCESO), COUNT(DISTINCT ID_INDIVIDUO) FROM FOREX.PROCESO GROUP BY TRUNC(FECHA_PROCESO) ORDER BY TRUNC(FECHA_PROCESO) DESC;
SELECT COUNT(DISTINCT ID_INDIVIDUO) FROM FOREX.PROCESO;
SELECT ID_INDIVIDUO, FECHA_HISTORICO, TO_CHAR(FECHA_PROCESO, 'YYYY/MM/DD HH24:MI:SS') FECHA_PROCESO FROM FOREX.PROCESO ORDER BY FECHA_PROCESO DESC;
SELECT COUNT(DISTINCT ID_INDIVIDUO) FROM FOREX.OPERACION;
SELECT ADD_MONTHS(TO_DATE(MAXIMOS.FECHA,'YYYY/MM'),1), ADD_MONTHS(TO_DATE(MAXIMOS.FECHA,'YYYY/MM'),2), MAXIMOS.MAX_PIPS, MIN(IND.ID) FROM INDIVIDUO IND INNER JOIN (SELECT ID_INDIVIDUO, SUM(PIPS) PIPS_IND FROM OPERACION WHERE FECHA_APERTURA > TO_DATE('2012/05','YYYY/MM') GROUP BY ID_INDIVIDUO, TO_CHAR(FECHA_APERTURA,'YYYY/MM')) OPER1 ON IND.ID=OPER1.ID_INDIVIDUO INNER JOIN ( SELECT FECHA, MAX(PIPS) MAX_PIPS FROM (SELECT OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') FECHA, SUM(OPER.PIPS) PIPS, COUNT(*) CANTIDAD, ROUND(AVG(PIPS),5) PROMEDIO FROM OPERACION OPER WHERE OPER.FECHA_APERTURA > TO_DATE('2012/05','YYYY/MM') GROUP BY OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') HAVING SUM(OPER.PIPS)>0) GROUP BY FECHA) MAXIMOS ON MAXIMOS.MAX_PIPS=OPER1.PIPS_IND GROUP BY MAXIMOS.FECHA, MAXIMOS.MAX_PIPS ORDER BY MAXIMOS.FECHA ASC;
SELECT ADD_MONTHS(TO_DATE(MAXIMOS.FECHA,'YYYY/MM'),1), MAXIMOS.MAX_PIPS, MIN(IND.ID) FROM INDIVIDUO IND INNER JOIN (SELECT ID_INDIVIDUO, SUM(PIPS) PIPS_IND FROM OPERACION WHERE FECHA_APERTURA > TO_DATE('2012/05','YYYY/MM') GROUP BY ID_INDIVIDUO, TO_CHAR(FECHA_APERTURA,'YYYY/MM')) OPER1 ON IND.ID=OPER1.ID_INDIVIDUO INNER JOIN ( SELECT FECHA, MAX(PIPS) MAX_PIPS FROM (SELECT OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') FECHA, SUM(OPER.PIPS) PIPS, COUNT(*) CANTIDAD, ROUND(AVG(PIPS),5) PROMEDIO FROM OPERACION OPER WHERE OPER.FECHA_APERTURA > TO_DATE('2012/05','YYYY/MM') GROUP BY OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') HAVING SUM(OPER.PIPS)>0) GROUP BY FECHA) MAXIMOS ON MAXIMOS.MAX_PIPS=OPER1.PIPS_IND GROUP BY MAXIMOS.FECHA, MAXIMOS.MAX_PIPS ORDER BY MAXIMOS.FECHA ASC;
SELECT ADD_MONTHS(SYSDATE,1) FROM DUAL;
SELECT MAXIMOS.FECHA, MAXIMOS.MAX_PIPS, MIN(IND.ID) FROM INDIVIDUO IND INNER JOIN (SELECT ID_INDIVIDUO, SUM(PIPS) PIPS_IND FROM OPERACION WHERE FECHA_APERTURA > TO_DATE('2012/05','YYYY/MM') GROUP BY ID_INDIVIDUO, TO_CHAR(FECHA_APERTURA,'YYYY/MM')) OPER1 ON IND.ID=OPER1.ID_INDIVIDUO INNER JOIN ( SELECT FECHA, MAX(PIPS) MAX_PIPS FROM (SELECT OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') FECHA, SUM(OPER.PIPS) PIPS, COUNT(*) CANTIDAD, ROUND(AVG(PIPS),5) PROMEDIO FROM OPERACION OPER WHERE OPER.FECHA_APERTURA > TO_DATE('2012/05','YYYY/MM') GROUP BY OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') HAVING SUM(OPER.PIPS)>0) GROUP BY FECHA) MAXIMOS ON MAXIMOS.MAX_PIPS=OPER1.PIPS_IND GROUP BY MAXIMOS.FECHA, MAXIMOS.MAX_PIPS ORDER BY MAXIMOS.FECHA ASC;
SELECT * FROM FOREX.OPERACION WHERE ID_INDIVIDUO IN ('1338955830567.96025') ORDER BY FECHA_APERTURA DESC;
SELECT ID_INDIVIDUO, TO_CHAR(FECHA_APERTURA,'YYYY/MM'), SUM(PIPS) FROM FOREX.OPERACION WHERE ID_INDIVIDUO IN ('1338955830567.96025') GROUP BY ID_INDIVIDUO, TO_CHAR(FECHA_APERTURA, 'YYYY/MM') ORDER BY ID_INDIVIDUO, TO_CHAR(FECHA_APERTURA, 'YYYY/MM') DESC;
SELECT ID_INDIVIDUO, TO_CHAR(FECHA_APERTURA,'YYYY/MM'), SUM(PIPS) FROM FOREX.OPERACION WHERE ID_INDIVIDUO IN ('1341687718670.3603') GROUP BY ID_INDIVIDUO, TO_CHAR(FECHA_APERTURA, 'YYYY/MM') ORDER BY ID_INDIVIDUO, TO_CHAR(FECHA_APERTURA, 'YYYY/MM') DESC;
SELECT ID_INDIVIDUO, TO_CHAR(FECHA_APERTURA,'YYYY/MM'), SUM(PIPS) FROM FOREX.OPERACION WHERE ID_INDIVIDUO IN ('1341687718670.3603') GROUP BY ID_INDIVIDUO, TO_CHAR(FECHA_APERTURA, 'YYYY/MM') ORDER BY ID_INDIVIDUO, TO_CHAR(FECHA_APERTURA, 'YYYY/MM') ASC;
SELECT OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') FECHA, SUM(OPER.PIPS), COUNT(*) CANTIDAD,ROUND(AVG(PIPS),5) PROMEDIO FROM OPERACION OPER WHERE OPER.FECHA_APERTURA > TO_DATE('2012/07','YYYY/MM') GROUP BY OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') HAVING SUM(OPER.PIPS)>0 ORDER BY TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') ASC, SUM(OPER.PIPS) DESC, OPER.ID_INDIVIDUO DESC;
SELECT OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') FECHA, SUM(OPER.PIPS), COUNT(*) CANTIDAD,ROUND(AVG(PIPS),5) PROMEDIO FROM OPERACION OPER WHERE OPER.FECHA_APERTURA > TO_DATE('2012/05','YYYY/MM') GROUP BY OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') HAVING SUM(OPER.PIPS)>0 ORDER BY TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') ASC, SUM(OPER.PIPS) DESC, OPER.ID_INDIVIDUO DESC;
SELECT OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') FECHA, SUM(OPER.PIPS), COUNT(*) CANTIDAD,ROUND(AVG(PIPS),5) PROMEDIO FROM OPERACION OPER WHERE OPER.FECHA_APERTURA > TO_DATE('2012/08','YYYY/MM') GROUP BY OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') HAVING SUM(OPER.PIPS)>0 ORDER BY TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') ASC, SUM(OPER.PIPS) DESC, OPER.ID_INDIVIDUO DESC;
SELECT OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') FECHA, SUM(OPER.PIPS), COUNT(*) CANTIDAD,ROUND(AVG(PIPS),5) PROMEDIO FROM OPERACION OPER WHERE OPER.FECHA_APERTURA > TO_DATE('2012/06','YYYY/MM') GROUP BY OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') HAVING SUM(OPER.PIPS)>0 ORDER BY TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') ASC, SUM(OPER.PIPS) DESC, OPER.ID_INDIVIDUO DESC;
SELECT OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') FECHA, SUM(OPER.PIPS), COUNT(*) CANTIDAD,ROUND(AVG(PIPS),5) PROMEDIO FROM OPERACION OPER WHERE OPER.FECHA_APERTURA > TO_DATE('2012/05','YYYY/MM') GROUP BY OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') HAVING SUM(OPER.PIPS)>0 ORDER BY SUM(OPER.PIPS) DESC, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') ASC, OPER.ID_INDIVIDUO DESC;
SELECT OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') FECHA, SUM(OPER.PIPS), COUNT(*) CANTIDAD,ROUND(AVG(PIPS),5) PROMEDIO FROM OPERACION OPER WHERE OPER.FECHA_APERTURA > TO_DATE('2012/05','YYYY/MM') GROUP BY OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') HAVING SUM(OPER.PIPS)>0 ORDER BY SUM(OPER.PIPS), TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM'), OPER.ID_INDIVIDUO DESC;
SELECT OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') FECHA, SUM(OPER.PIPS), COUNT(*) CANTIDAD,ROUND(AVG(PIPS),5) PROMEDIO FROM OPERACION OPER WHERE OPER.FECHA_APERTURA > TO_DATE('2012/05','YYYY/MM') GROUP BY OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') HAVING SUM(OPER.PIPS)>0 ORDER BY TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM'), OPER.ID_INDIVIDUO DESC;
file:/C:/Users/ricardorq85/Documents/ricardorq85/Informacion/FOREX/DATABASE/ToFileString.sql
SELECT OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') FECHA, SUM(OPER.PIPS), COUNT(*) CANTIDAD,ROUND(AVG(PIPS),5) PROMEDIO FROM OPERACION OPER WHERE OPER.FECHA_APERTURA > TO_DATE('2012/05','YYYY/MM') GROUP BY OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') HAVING SUM(OPER.PIPS)>0 ORDER BY OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') DESC;
SELECT FECHA, MAX(PIPS) MAX_PIPS FROM (SELECT OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') FECHA, SUM(OPER.PIPS) PIPS, COUNT(*) CANTIDAD, ROUND(AVG(PIPS),5) PROMEDIO FROM OPERACION OPER WHERE OPER.FECHA_APERTURA > TO_DATE('2012/05','YYYY/MM') GROUP BY OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') HAVING SUM(OPER.PIPS)>0) GROUP BY FECHA;
SELECT FECHA, MAX(PIPS) MAX_PIPS FROM (SELECT OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') FECHA, SUM(OPER.PIPS) PIPS, COUNT(*) CANTIDAD, ROUND(AVG(PIPS),5) PROMEDIO FROM OPERACION OPER WHERE OPER.FECHA_APERTURA > TO_DATE('2012/05','YYYY/MM') GROUP BY OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') HAVING SUM(OPER.PIPS)>0) GROUP BY FECHA ORDER BY FECHA ASC;
SELECT OPER.ID_INDIVIDUO, SUM(OPER.PIPS), COUNT(*) CANTIDAD,ROUND(AVG(PIPS),5) PROMEDIO FROM OPERACION OPER WHERE OPER.FECHA_APERTURA > TO_DATE('2012/05','YYYY/MM') GROUP BY OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') HAVING SUM(OPER.PIPS)>0 ORDER BY SUM(OPER.PIPS) DESC;
SELECT OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') FECHA, SUM(OPER.PIPS), COUNT(*) CANTIDAD,ROUND(AVG(PIPS),5) PROMEDIO FROM OPERACION OPER WHERE OPER.FECHA_APERTURA > TO_DATE('2012/05','YYYY/MM') GROUP BY OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') HAVING SUM(OPER.PIPS)>0 ORDER BY SUM(OPER.PIPS) DESC;
SELECT OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM'), SUM(OPER.PIPS), COUNT(*) CANTIDAD,ROUND(AVG(PIPS),5) PROMEDIO FROM OPERACION OPER WHERE OPER.FECHA_APERTURA > TO_DATE('2012/05','YYYY/MM') GROUP BY OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') HAVING SUM(OPER.PIPS)>0 ORDER BY SUM(OPER.PIPS) DESC;
SELECT OPER.ID_INDIVIDUO, SUM(OPER.PIPS), COUNT(*) CANTIDAD,ROUND(AVG(PIPS),5) PROMEDIO FROM OPERACION OPER WHERE OPER.FECHA_APERTURA > TO_DATE('2012/05','YYYY/MM') GROUP BY OPER.ID_INDIVIDUO HAVING SUM(OPER.PIPS)>0 ORDER BY SUM(OPER.PIPS) DESC;
SELECT ID_INDIVIDUO, SUM(PIPS) PIPS_IND FROM OPERACION WHERE FECHA_APERTURA > TO_DATE('2012/05','YYYY/MM') GROUP BY ID_INDIVIDUO
SELECT FECHA, MAX(PIPS) MAX_PIPS FROM (SELECT OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') FECHA, SUM(OPER.PIPS) PIPS, COUNT(*) CANTIDAD, ROUND(AVG(PIPS),5) PROMEDIO FROM OPERACION OPER WHERE OPER.FECHA_APERTURA > TO_DATE('2012/05','YYYY/MM') GROUP BY OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') HAVING SUM(OPER.PIPS)>0) GROUP BY FECHA
SELECT FECHA, MAX(PIPS) FROM (SELECT OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') FECHA, SUM(OPER.PIPS) PIPS, COUNT(*) CANTIDAD, ROUND(AVG(PIPS),5) PROMEDIO FROM OPERACION OPER WHERE OPER.FECHA_APERTURA > TO_DATE('2012/05','YYYY/MM') GROUP BY OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') HAVING SUM(OPER.PIPS)>0) GROUP BY FECHA ORDER BY FECHA ASC;
SELECT OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') FECHA, SUM(OPER.PIPS), COUNT(*) CANTIDAD, ROUND(AVG(PIPS),5) PROMEDIO FROM OPERACION OPER WHERE OPER.FECHA_APERTURA > TO_DATE('2012/05','YYYY/MM') GROUP BY OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') HAVING SUM(OPER.PIPS)>0 ORDER BY TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') ASC;
SELECT OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') FECHA, SUM(OPER.PIPS), COUNT(*) CANTIDAD, ROUND(AVG(PIPS),5) PROMEDIO FROM OPERACION OPER WHERE OPER.FECHA_APERTURA > TO_DATE('2012/05','YYYY/MM') GROUP BY OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') HAVING SUM(OPER.PIPS)>0 ORDER BY TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') ASC;
SELECT OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM'), SUM(OPER.PIPS), COUNT(*) CANTIDAD, ROUND(AVG(PIPS),5) PROMEDIO FROM OPERACION OPER WHERE OPER.FECHA_APERTURA > TO_DATE('2012/05','YYYY/MM') GROUP BY OPER.ID_INDIVIDUO, TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') HAVING SUM(OPER.PIPS)>0 ORDER BY TO_CHAR(OPER.FECHA_APERTURA,'YYYY/MM') ASC;
SELECT * FROM DETALLES_ESTADISTICAS WHERE ID_INDIVIDUO='1338955830567.96025';
SELECT * FROM FOREX.OPERACION --WHERE ID_INDIVIDUO IN ('1338955830567.96025') ORDER BY FECHA_APERTURA DESC;
SELECT * FROM FOREX.OPERACION WHERE ID_INDIVIDUO IN ('1338955830567.96025') ORDER BY FECHA_APERTURA ASC;
SELECT OPER.ID_INDIVIDUO, SUM(OPER.PIPS), COUNT(*) CANTIDAD,ROUND(AVG(PIPS),5) PROMEDIO FROM OPERACION OPER WHERE OPER.FECHA_APERTURA > TO_DATE('2012/05','YYYY/MM') GROUP BY OPER.ID_INDIVIDUO HAVING SUM(OPER.PIPS)>0 ORDER BY SUM(OPER.PIPS) DESC;
SELECT OPER.ID_INDIVIDUO, SUM(OPER.PIPS), COUNT(*) CANTIDAD,ROUND(AVG(PIPS),5) PROMEDIO FROM OPERACION OPER WHERE OPER.FECHA_APERTURA > TO_DATE('2012','YYYY') GROUP BY OPER.ID_INDIVIDUO HAVING SUM(OPER.PIPS)>0 ORDER BY SUM(OPER.PIPS) DESC;
SELECT * FROM FOREX.OPERACION WHERE ID_INDIVIDUO IN ('1338955830567.84033') ORDER BY FECHA_APERTURA ASC;
SELECT * FROM FOREX.OPERACION WHERE ID_INDIVIDUO IN ('1338955830567.39721') ORDER BY FECHA_APERTURA ASC;
SELECT OPER.ID_INDIVIDUO, SUM(OPER.PIPS), COUNT(*) CANTIDAD,ROUND(AVG(PIPS),5) PROMEDIO FROM OPERACION OPER WHERE OPER.FECHA_APERTURA > TO_DATE('2012','YYYY') GROUP BY OPER.ID_INDIVIDUO HAVING SUM(OPER.PIPS)>0 ORDER BY COUNT(*) DESC;
SELECT OPER.ID_INDIVIDUO, SUM(OPER.PIPS), COUNT(*) CANTIDAD,ROUND(AVG(PIPS),5) PROMEDIO FROM OPERACION OPER WHERE OPER.FECHA_APERTURA > TO_DATE('2012','YYYY') GROUP BY OPER.ID_INDIVIDUO ORDER BY COUNT(*) DESC;
SELECT OPER.ID_INDIVIDUO, SUM(OPER.PIPS) FROM OPERACION OPER WHERE OPER.FECHA_APERTURA > TO_DATE('2012','YYYY') GROUP BY OPER.ID_INDIVIDUO ORDER BY SUM(OPER.PIPS) DESC;
SELECT OPER.ID_INDIVIDUO, SUM(OPER.PIPS), COUNT(*) CANTIDAD, AVG(PIPS) PROMEDIO FROM OPERACION OPER WHERE OPER.FECHA_APERTURA > TO_DATE('2012','YYYY') GROUP BY OPER.ID_INDIVIDUO ORDER BY SUM(OPER.PIPS) DESC;
SELECT OPER.ID_INDIVIDUO, SUM(OPER.PIPS), COUNT(*), AVG(PIPS) FROM OPERACION OPER WHERE OPER.FECHA_APERTURA > TO_DATE('2012','YYYY') GROUP BY OPER.ID_INDIVIDUO ORDER BY SUM(OPER.PIPS) DESC;
SELECT OPER.ID_INDIVIDUO, SUM(OPER.PIPS) FROM OPERACION OPER WHERE OPER.FECHA_APERTURA > TO_DATE('2012','YYYY') GROUP BY OPER.ID_INDIVIDUO ORDER BY SUM(OPER.PIPS);
SELECT ID_INDIVIDUO, COUNT(*) FROM ( SELECT ID_INDIVIDUO, TO_CHAR(FECHA_APERTURA,'YYYY/MM') MES_APERTURA, SUM(PIPS) SUMA_PIPS FROM FOREX.OPERACION GROUP BY ID_INDIVIDUO, TO_CHAR(FECHA_APERTURA, 'YYYY/MM') ) PIPS_X_MES WHERE PIPS_X_MES.ID_INDIVIDUO NOT IN ( SELECT ID_INDIVIDUO FROM FOREX.OPERACION GROUP BY ID_INDIVIDUO, TO_CHAR(FECHA_APERTURA, 'YYYY/MM') HAVING SUM(PIPS) < 0) GROUP BY ID_INDIVIDUO HAVING COUNT(*)>1 ORDER BY COUNT(*) DESC;
SELECT ID_INDIVIDUO, COUNT(*), SUM(PIPS) FROM FOREX.OPERACION GROUP BY ID_INDIVIDUO ORDER BY SUM(PIPS) DESC --ORDER BY COUNT(*) DESC;
SELECT * FROM FOREX.PROCESO WHERE ID_INDIVIDUO='1341687718670.3603' ORDER BY FECHA_PROCESO ASC;
SELECT --OPER.* TO_CHAR(OPER.FECHA_APERTURA, 'YYYY.MM') FECHA, SUM(OPER.PIPS) FROM OPERACION OPER INNER JOIN (SELECT MIN(ID_INDIVIDUO) ID_IND, FECHA_APERTURA FROM TMP_TABLE GROUP BY FECHA_APERTURA) TMP ON OPER.ID_INDIVIDUO=TMP.ID_IND AND OPER.FECHA_APERTURA=TMP.FECHA_APERTURA --WHERE OPER.FECHA_APERTURA < SYSDATE - 4.2*360 GROUP BY TO_CHAR(OPER.FECHA_APERTURA, 'YYYY.MM') --ORDER BY OPER.FECHA_APERTURA ASC; ORDER BY TO_CHAR(OPER.FECHA_APERTURA, 'YYYY.MM') ASC;
SELECT --OPER.* TO_CHAR(OPER.FECHA_APERTURA, 'YYYY') FECHA, SUM(OPER.PIPS) FROM OPERACION OPER INNER JOIN (SELECT MIN(ID_INDIVIDUO) ID_IND, FECHA_APERTURA FROM TMP_TABLE GROUP BY FECHA_APERTURA) TMP ON OPER.ID_INDIVIDUO=TMP.ID_IND AND OPER.FECHA_APERTURA=TMP.FECHA_APERTURA --WHERE OPER.FECHA_APERTURA < SYSDATE - 4.2*360 GROUP BY TO_CHAR(OPER.FECHA_APERTURA, 'YYYY') --ORDER BY OPER.FECHA_APERTURA ASC; ORDER BY TO_CHAR(OPER.FECHA_APERTURA, 'YYYY') ASC;
SELECT * FROM FOREX.OPERACION WHERE ID_INDIVIDUO IN ('1341573069043.12599') ORDER BY FECHA_APERTURA ASC;
SELECT IND.TAKE_PROFIT, IND.STOP_LOSS, DEST.* FROM DETALLES_ESTADISTICAS DEST INNER JOIN (SELECT PROC.ID_INDIVIDUO, MAX(PROC.FECHA_HISTORICO) FECHA_HISTORICO FROM PROCESO PROC GROUP BY PROC.ID_INDIVIDUO) PROC ON DEST.ID_INDIVIDUO=PROC.ID_INDIVIDUO INNER JOIN INDIVIDUO IND ON DEST.ID_INDIVIDUO=IND.ID WHERE DEST.POSITIVOS=0 --AND PROC.FECHA_HISTORICO>TO_DATE('2012','YYYY') AND DEST.TOTAL_CANT>1 ORDER BY DEST.NEGATIVOS DESC;
SELECT --OPER.* TO_CHAR(OPER.FECHA_APERTURA, 'YYYY'), SUM(OPER.PIPS) FROM OPERACION OPER INNER JOIN (SELECT MIN(ID_INDIVIDUO) ID_IND, FECHA_APERTURA FROM TMP_TABLE GROUP BY FECHA_APERTURA) TMP ON OPER.ID_INDIVIDUO=TMP.ID_IND AND OPER.FECHA_APERTURA=TMP.FECHA_APERTURA --WHERE OPER.FECHA_APERTURA < SYSDATE - 4.2*360 GROUP BY TO_CHAR(OPER.FECHA_APERTURA, 'YYYY') --ORDER BY OPER.FECHA_APERTURA ASC; ORDER BY TO_CHAR(OPER.FECHA_APERTURA, 'YYYY') ASC;
SELECT --OPER.* SUM(OPER.PIPS) FROM OPERACION OPER INNER JOIN (SELECT MIN(ID_INDIVIDUO) ID_IND, FECHA_APERTURA FROM TMP_TABLE GROUP BY FECHA_APERTURA) TMP ON OPER.ID_INDIVIDUO=TMP.ID_IND AND OPER.FECHA_APERTURA=TMP.FECHA_APERTURA WHERE OPER.FECHA_APERTURA < SYSDATE - 4.3*360 ORDER BY OPER.FECHA_APERTURA ASC;
SELECT OPER.* --SUM(OPER.PIPS) FROM OPERACION OPER INNER JOIN (SELECT MIN(ID_INDIVIDUO) ID_IND, FECHA_APERTURA FROM TMP_TABLE GROUP BY FECHA_APERTURA) TMP ON OPER.ID_INDIVIDUO=TMP.ID_IND AND OPER.FECHA_APERTURA=TMP.FECHA_APERTURA WHERE OPER.FECHA_APERTURA < SYSDATE - 4.5*360 ORDER BY OPER.FECHA_APERTURA ASC;
SELECT * FROM OPERACION OPER INNER JOIN (SELECT MIN(ID_INDIVIDUO) ID_IND, FECHA_APERTURA FROM TMP_TABLE GROUP BY FECHA_APERTURA) TMP ON OPER.ID_INDIVIDUO=TMP.ID_IND AND OPER.FECHA_APERTURA=TMP.FECHA_APERTURA ORDER BY OPER.FECHA_APERTURA ASC;
SELECT * FROM OPERACION OPER, (SELECT MIN(ID_INDIVIDUO) ID_IND, FECHA_APERTURA FROM TMP_TABLE GROUP BY FECHA_APERTURA) TMP WHERE OPER.ID_INDIVIDUO=TMP.ID_IND-- AND OPER.FECHA_APERTURA=TMP.FEHA_APERTURA ORDER BY OPER.FECHA_APERTURA ASC;
SELECT 'EstrategiaId='||IND.ID||',VigenciaLower='||TO_CHAR(TMP.FECHA_APERTURA-1/24/60, 'YYYY.MM.DD HH24:MI')||',VigenciaHigher='||TO_CHAR(TMP.FECHA_APERTURA+30, 'YYYY.MM.DD HH24:MI')||','|| 'Active=true,Pair=USDCAD,Operation=Sell,TakeProfit='||IND.TAKE_PROFIT||',StopLoss='||IND.STOP_LOSS||',Lote='||IND.LOTE||','|| II_OPEN_MA.TIPO||II_OPEN_MA.ID_INDICADOR||'LOWER='||II_OPEN_MA.INTERVALO_INFERIOR*100||','||II_OPEN_MA.TIPO||II_OPEN_MA.ID_INDICADOR||'HIGHER='||II_OPEN_MA.INTERVALO_SUPERIOR*100||','|| II_OPEN_MACD.TIPO||II_OPEN_MACD.ID_INDICADOR||'LOWER='||II_OPEN_MACD.INTERVALO_INFERIOR*100||','||II_OPEN_MACD.TIPO||II_OPEN_MACD.ID_INDICADOR||'HIGHER='||II_OPEN_MACD.INTERVALO_SUPERIOR*100||','|| II_OPEN_COMPARE.TIPO||'MACOMPARE'||'LOWER='||II_OPEN_COMPARE.INTERVALO_INFERIOR*100||','||II_OPEN_COMPARE.TIPO||'MACOMPARE'||'HIGHER='||II_OPEN_COMPARE.INTERVALO_SUPERIOR*100||','|| II_OPEN_SAR.TIPO||II_OPEN_SAR.ID_INDICADOR||'LOWER='||II_OPEN_SAR.INTERVALO_INFERIOR*100||','||II_OPEN_SAR.TIPO||II_OPEN_SAR.ID_INDICADOR||'HIGHER='||II_OPEN_SAR.INTERVALO_SUPERIOR*100||','|| II_OPEN_ADX.TIPO||II_OPEN_ADX.ID_INDICADOR||'LOWER='||II_OPEN_ADX.INTERVALO_INFERIOR*100||','||II_OPEN_ADX.TIPO||II_OPEN_ADX.ID_INDICADOR||'HIGHER='||II_OPEN_ADX.INTERVALO_SUPERIOR*100||','|| II_OPEN_RSI.TIPO||II_OPEN_RSI.ID_INDICADOR||'LOWER='||II_OPEN_RSI.INTERVALO_INFERIOR*100||','||II_OPEN_RSI.TIPO||II_OPEN_RSI.ID_INDICADOR||'HIGHER='||II_OPEN_RSI.INTERVALO_SUPERIOR*100||','|| II_OPEN_BOLLINGER.TIPO||II_OPEN_BOLLINGER.ID_INDICADOR||'LOWER='||II_OPEN_BOLLINGER.INTERVALO_INFERIOR*100||','||II_OPEN_BOLLINGER.TIPO||II_OPEN_BOLLINGER.ID_INDICADOR||'HIGHER='||II_OPEN_BOLLINGER.INTERVALO_SUPERIOR*100||','|| II_OPEN_MOMENTUM.TIPO||II_OPEN_MOMENTUM.ID_INDICADOR||'LOWER='||II_OPEN_MOMENTUM.INTERVALO_INFERIOR*100||','||II_OPEN_MOMENTUM.TIPO||II_OPEN_MOMENTUM.ID_INDICADOR||'HIGHER='||II_OPEN_MOMENTUM.INTERVALO_SUPERIOR*100||','|| II_OPEN_ICHITREND.TIPO||'ICHITREND'||'LOWER='||II_OPEN_ICHITREND.INTERVALO_INFERIOR*100||','||II_OPEN_ICHITREND.TIPO||'ICHITREND'||'HIGHER='||II_OPEN_ICHITREND.INTERVALO_SUPERIOR*100||','|| II_OPEN_ICHISIGNAL.TIPO||'ICHISIGNAL'||'LOWER='||II_OPEN_ICHISIGNAL.INTERVALO_INFERIOR*100||','||II_OPEN_ICHISIGNAL.TIPO||'ICHISIGNAL'||'HIGHER='||II_OPEN_ICHISIGNAL.INTERVALO_SUPERIOR*100||','|| II_CLOSE_MA.TIPO||II_CLOSE_MA.ID_INDICADOR||'LOWER='||II_CLOSE_MA.INTERVALO_INFERIOR*100||','||II_CLOSE_MA.TIPO||II_CLOSE_MA.ID_INDICADOR||'HIGHER='||II_CLOSE_MA.INTERVALO_SUPERIOR*100||','|| II_CLOSE_MACD.TIPO||II_CLOSE_MACD.ID_INDICADOR||'LOWER='||II_CLOSE_MACD.INTERVALO_INFERIOR*100||','||II_CLOSE_MACD.TIPO||II_CLOSE_MACD.ID_INDICADOR||'HIGHER='||II_CLOSE_MACD.INTERVALO_SUPERIOR*100||','|| II_CLOSE_COMPARE.TIPO||'MACOMPARE'||'LOWER='||II_CLOSE_COMPARE.INTERVALO_INFERIOR*100||','||II_CLOSE_COMPARE.TIPO||'MACOMPARE'||'HIGHER='||II_CLOSE_COMPARE.INTERVALO_SUPERIOR*100||','|| II_CLOSE_SAR.TIPO||II_CLOSE_SAR.ID_INDICADOR||'LOWER='||II_CLOSE_SAR.INTERVALO_INFERIOR*100||','||II_CLOSE_SAR.TIPO||II_CLOSE_SAR.ID_INDICADOR||'HIGHER='||II_CLOSE_SAR.INTERVALO_SUPERIOR*100||','|| II_CLOSE_ADX.TIPO||II_CLOSE_ADX.ID_INDICADOR||'LOWER='||II_CLOSE_ADX.INTERVALO_INFERIOR*100||','||II_CLOSE_ADX.TIPO||II_CLOSE_ADX.ID_INDICADOR||'HIGHER='||II_CLOSE_ADX.INTERVALO_SUPERIOR*100||','|| II_CLOSE_RSI.TIPO||II_CLOSE_RSI.ID_INDICADOR||'LOWER='||II_CLOSE_RSI.INTERVALO_INFERIOR*100||','||II_CLOSE_RSI.TIPO||II_CLOSE_RSI.ID_INDICADOR||'HIGHER='||II_CLOSE_RSI.INTERVALO_SUPERIOR*100||','|| II_CLOSE_BOLLINGER.TIPO||II_CLOSE_BOLLINGER.ID_INDICADOR||'LOWER='||II_CLOSE_BOLLINGER.INTERVALO_INFERIOR*100||','||II_CLOSE_BOLLINGER.TIPO||II_CLOSE_BOLLINGER.ID_INDICADOR||'HIGHER='||II_CLOSE_BOLLINGER.INTERVALO_SUPERIOR*100||','|| II_CLOSE_MOMENTUM.TIPO||II_CLOSE_MOMENTUM.ID_INDICADOR||'LOWER='||II_CLOSE_MOMENTUM.INTERVALO_INFERIOR*100||','||II_CLOSE_MOMENTUM.TIPO||II_CLOSE_MOMENTUM.ID_INDICADOR||'HIGHER='||II_CLOSE_MOMENTUM.INTERVALO_SUPERIOR*100||','|| II_CLOSE_ICHITREND.TIPO||'ICHITREND'||'LOWER='||II_CLOSE_ICHITREND.INTERVALO_INFERIOR*100||','||II_CLOSE_ICHITREND.TIPO||'ICHITREND'||'HIGHER='||II_CLOSE_ICHITREND.INTERVALO_SUPERIOR*100||','|| II_CLOSE_ICHISIGNAL.TIPO||'ICHISIGNAL'||'LOWER='||II_CLOSE_ICHISIGNAL.INTERVALO_INFERIOR*100||','||II_CLOSE_ICHISIGNAL.TIPO||'ICHISIGNAL'||'HIGHER='||II_CLOSE_ICHISIGNAL.INTERVALO_SUPERIOR*100 ||',' FILESTRING FROM INDICADOR_INDIVIDUO II_OPEN_MA, INDICADOR_INDIVIDUO II_CLOSE_MA, INDICADOR_INDIVIDUO II_OPEN_MACD, INDICADOR_INDIVIDUO II_CLOSE_MACD, INDICADOR_INDIVIDUO II_OPEN_COMPARE, INDICADOR_INDIVIDUO II_CLOSE_COMPARE, INDICADOR_INDIVIDUO II_OPEN_SAR, INDICADOR_INDIVIDUO II_CLOSE_SAR, INDICADOR_INDIVIDUO II_OPEN_ADX, INDICADOR_INDIVIDUO II_CLOSE_ADX, INDICADOR_INDIVIDUO II_OPEN_RSI, INDICADOR_INDIVIDUO II_CLOSE_RSI, INDICADOR_INDIVIDUO II_OPEN_BOLLINGER, INDICADOR_INDIVIDUO II_CLOSE_BOLLINGER, INDICADOR_INDIVIDUO II_OPEN_MOMENTUM, INDICADOR_INDIVIDUO II_CLOSE_MOMENTUM, INDICADOR_INDIVIDUO II_OPEN_ICHITREND, INDICADOR_INDIVIDUO II_CLOSE_ICHITREND, INDICADOR_INDIVIDUO II_OPEN_ICHISIGNAL, INDICADOR_INDIVIDUO II_CLOSE_ICHISIGNAL, INDIVIDUO IND, (SELECT MIN(ID_INDIVIDUO) ID_IND, FECHA_APERTURA FROM TMP_TABLE GROUP BY FECHA_APERTURA) TMP WHERE IND.ID=II_OPEN_MA.ID_INDIVIDUO AND IND.ID=II_CLOSE_MA.ID_INDIVIDUO AND IND.ID=II_OPEN_MACD.ID_INDIVIDUO AND IND.ID=II_CLOSE_MACD.ID_INDIVIDUO AND IND.ID=II_OPEN_COMPARE.ID_INDIVIDUO AND IND.ID=II_CLOSE_COMPARE.ID_INDIVIDUO AND IND.ID=II_OPEN_SAR.ID_INDIVIDUO AND IND.ID=II_CLOSE_SAR.ID_INDIVIDUO AND IND.ID=II_OPEN_ADX.ID_INDIVIDUO AND IND.ID=II_CLOSE_ADX.ID_INDIVIDUO AND IND.ID=II_OPEN_RSI.ID_INDIVIDUO AND IND.ID=II_CLOSE_RSI.ID_INDIVIDUO AND IND.ID=II_OPEN_BOLLINGER.ID_INDIVIDUO AND IND.ID=II_CLOSE_BOLLINGER.ID_INDIVIDUO AND IND.ID=II_OPEN_MOMENTUM.ID_INDIVIDUO AND IND.ID=II_CLOSE_MOMENTUM.ID_INDIVIDUO AND IND.ID=II_OPEN_ICHITREND.ID_INDIVIDUO AND IND.ID=II_CLOSE_ICHITREND.ID_INDIVIDUO AND IND.ID=II_OPEN_ICHISIGNAL.ID_INDIVIDUO AND IND.ID=II_CLOSE_ICHISIGNAL.ID_INDIVIDUO AND II_OPEN_MA.TIPO='OPEN' AND II_OPEN_MA.ID_INDICADOR='MA' AND II_OPEN_MACD.TIPO='OPEN' AND II_OPEN_MACD.ID_INDICADOR='MACD' AND II_OPEN_COMPARE.TIPO='OPEN' AND II_OPEN_COMPARE.ID_INDICADOR='COMPARE_MA' AND II_OPEN_SAR.TIPO='OPEN' AND II_OPEN_SAR.ID_INDICADOR='SAR' AND II_OPEN_ADX.TIPO='OPEN' AND II_OPEN_ADX.ID_INDICADOR='ADX' AND II_OPEN_RSI.TIPO='OPEN' AND II_OPEN_RSI.ID_INDICADOR='RSI' AND II_OPEN_BOLLINGER.TIPO='OPEN' AND II_OPEN_BOLLINGER.ID_INDICADOR='BOLLINGER' AND II_OPEN_MOMENTUM.TIPO='OPEN' AND II_OPEN_MOMENTUM.ID_INDICADOR='MOMENTUM' AND II_OPEN_ICHITREND.TIPO='OPEN' AND II_OPEN_ICHITREND.ID_INDICADOR='ICHIMOKU_TREND' AND II_OPEN_ICHISIGNAL.TIPO='OPEN' AND II_OPEN_ICHISIGNAL.ID_INDICADOR='ICHIMOKU_SIGNAL' AND II_CLOSE_MA.TIPO='CLOSE' AND II_CLOSE_MA.ID_INDICADOR='MA' AND II_CLOSE_MACD.TIPO='CLOSE' AND II_CLOSE_MACD.ID_INDICADOR='MACD' AND II_CLOSE_COMPARE.TIPO='CLOSE' AND II_CLOSE_COMPARE.ID_INDICADOR='COMPARE_MA' AND II_CLOSE_SAR.TIPO='CLOSE' AND II_CLOSE_SAR.ID_INDICADOR='SAR' AND II_CLOSE_ADX.TIPO='CLOSE' AND II_CLOSE_ADX.ID_INDICADOR='ADX' AND II_CLOSE_RSI.TIPO='CLOSE' AND II_CLOSE_RSI.ID_INDICADOR='RSI' AND II_CLOSE_BOLLINGER.TIPO='CLOSE' AND II_CLOSE_BOLLINGER.ID_INDICADOR='BOLLINGER' AND II_CLOSE_MOMENTUM.TIPO='CLOSE' AND II_CLOSE_MOMENTUM.ID_INDICADOR='MOMENTUM' AND II_CLOSE_ICHITREND.TIPO='CLOSE' AND II_CLOSE_ICHITREND.ID_INDICADOR='ICHIMOKU_TREND' AND II_CLOSE_ICHISIGNAL.TIPO='CLOSE' AND II_CLOSE_ICHISIGNAL.ID_INDICADOR='ICHIMOKU_SIGNAL' /*AND IND.ID IN (SELECT DEST.ID_INDIVIDUO FROM DETALLES_ESTADISTICAS DEST INNER JOIN (SELECT PROC.ID_INDIVIDUO, MAX(PROC.FECHA_HISTORICO) FECHA_HISTORICO FROM PROCESO PROC GROUP BY PROC.ID_INDIVIDUO) PROC ON DEST.ID_INDIVIDUO=PROC.ID_INDIVIDUO WHERE NEGATIVOS=0 AND PROC.FECHA_HISTORICO>TO_DATE('2012','YYYY') AND TOTAL_CANT>1)*/ --AND IND.ID IN ('') AND IND.ID = TMP.ID_IND ORDER BY TMP.FECHA_APERTURA ASC;
SELECT --OPER1.*, CONTADOR.CO --DISTINCT OPER1.FECHA_APERTURA, OPER1.PIPS, CONTADOR.CO CONTADOR.CO, CONTADOR.DIFF, SUM(OPER1.PIPS) SUMA FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2, OPERACION OPER1, (SELECT * FROM (SELECT (T2.SUMA_PIPS-T1.SUMA_PIPS) DIFF, COUNT(*) CO FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2 WHERE T2.FECHA_OPERACION > T1.FECHA_OPERACION --AND (T2.SUMA_PIPS-T1.SUMA_PIPS)>0 GROUP BY (T2.SUMA_PIPS-T1.SUMA_PIPS) --HAVING COUNT(*)=226 ORDER BY COUNT(*) DESC) WHERE ROWNUM T1.FECHA_OPERACION AND OPER1.FECHA_APERTURA=(SELECT MIN(OPER2.FECHA_APERTURA) FROM OPERACION OPER2 WHERE OPER2.FECHA_APERTURA>T2.FECHA_OPERACION) AND (T2.SUMA_PIPS - T1.SUMA_PIPS)=CONTADOR.DIFF GROUP BY CONTADOR.CO, CONTADOR.DIFF ORDER BY CONTADOR.CO DESC -- , OPER1.FECHA_APERTURA ASC;
SELECT --OPER1.*, CONTADOR.CO --DISTINCT OPER1.FECHA_APERTURA, OPER1.PIPS, CONTADOR.CO CONTADOR.CO, CONTADOR.DIFF, SUM(OPER1.PIPS) SUMA FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2, OPERACION OPER1, (SELECT * FROM (SELECT (T2.SUMA_PIPS-T1.SUMA_PIPS) DIFF, COUNT(*) CO FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2 WHERE T2.FECHA_OPERACION > T1.FECHA_OPERACION --AND (T2.SUMA_PIPS-T1.SUMA_PIPS)>0 GROUP BY (T2.SUMA_PIPS-T1.SUMA_PIPS) --HAVING COUNT(*)=21 ORDER BY COUNT(*) DESC) WHERE ROWNUM T1.FECHA_OPERACION AND OPER1.FECHA_APERTURA=(SELECT MIN(OPER2.FECHA_APERTURA) FROM OPERACION OPER2 WHERE OPER2.FECHA_APERTURA>T2.FECHA_OPERACION) AND (T2.SUMA_PIPS - T1.SUMA_PIPS)=CONTADOR.DIFF GROUP BY CONTADOR.CO, CONTADOR.DIFF ORDER BY CONTADOR.CO DESC -- , OPER1.FECHA_APERTURA ASC;
SELECT OPER1.*, CONTADOR.CO --DISTINCT OPER1.FECHA_APERTURA, OPER1.PIPS, CONTADOR.CO --CONTADOR.CO, CONTADOR.DIFF, SUM(OPER1.PIPS) SUMA FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2, OPERACION OPER1, (SELECT * FROM (SELECT (T2.SUMA_PIPS-T1.SUMA_PIPS) DIFF, COUNT(*) CO FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2 WHERE T2.FECHA_OPERACION > T1.FECHA_OPERACION --AND (T2.SUMA_PIPS-T1.SUMA_PIPS)>0 GROUP BY (T2.SUMA_PIPS-T1.SUMA_PIPS) --HAVING COUNT(*)=21 ORDER BY COUNT(*) DESC) WHERE ROWNUM T1.FECHA_OPERACION AND OPER1.FECHA_APERTURA=(SELECT MIN(OPER2.FECHA_APERTURA) FROM OPERACION OPER2 WHERE OPER2.FECHA_APERTURA>T2.FECHA_OPERACION) AND (T2.SUMA_PIPS - T1.SUMA_PIPS)=CONTADOR.DIFF -- GROUP BY CONTADOR.CO, CONTADOR.DIFF ORDER BY CONTADOR.CO DESC , OPER1.FECHA_APERTURA ASC;
SELECT --OPER1.*, CONTADOR.CO --DISTINCT OPER1.FECHA_APERTURA, OPER1.PIPS, CONTADOR.CO CONTADOR.CO, CONTADOR.DIFF, SUM(OPER1.PIPS) SUMA FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2, OPERACION OPER1, (SELECT * FROM (SELECT (T2.SUMA_PIPS-T1.SUMA_PIPS) DIFF, COUNT(*) CO FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2 WHERE T2.FECHA_OPERACION > T1.FECHA_OPERACION --AND (T2.SUMA_PIPS-T1.SUMA_PIPS)>0 GROUP BY (T2.SUMA_PIPS-T1.SUMA_PIPS) --HAVING COUNT(*)=21 ORDER BY COUNT(*) DESC) --WHERE ROWNUM T1.FECHA_OPERACION AND OPER1.FECHA_APERTURA=(SELECT MIN(OPER2.FECHA_APERTURA) FROM OPERACION OPER2 WHERE OPER2.FECHA_APERTURA>T2.FECHA_OPERACION) AND (T2.SUMA_PIPS - T1.SUMA_PIPS)=CONTADOR.DIFF GROUP BY CONTADOR.CO, CONTADOR.DIFF ORDER BY CONTADOR.CO DESC -- , OPER1.FECHA_APERTURA ASC;
SELECT (T2.SUMA_PIPS-T1.SUMA_PIPS) DIFF, COUNT(*) FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2 WHERE T2.FECHA_OPERACION > T1.FECHA_OPERACION --AND (T2.SUMA_PIPS-T1.SUMA_PIPS)>0 GROUP BY (T2.SUMA_PIPS-T1.SUMA_PIPS) ORDER BY COUNT(*) DESC;
SELECT (T2.SUMA_PIPS-T1.SUMA_PIPS) DIFF, T2.FECHA_OPERACION, T1.FECHA_OPERACION, OPER2.PIPS, OPER1.PIPS, ROUND(T2.FECHA_OPERACION-T1.FECHA_OPERACION, 4) DIFF_FECHA FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2, OPERACION OPER1, OPERACION OPER2 WHERE T2.FECHA_OPERACION > T1.FECHA_OPERACION AND OPER1.FECHA_APERTURA=T1.FECHA_OPERACION AND OPER2.FECHA_APERTURA=T2.FECHA_OPERACION AND (T2.SUMA_PIPS - T1.SUMA_PIPS)=685 ORDER BY T1.FECHA_OPERACION;
SELECT OPER1.*, CONTADOR.CO --DISTINCT OPER1.FECHA_APERTURA, OPER1.PIPS, CONTADOR.CO --CONTADOR.CO, CONTADOR.DIFF, SUM(OPER1.PIPS) SUMA FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2, OPERACION OPER1, (SELECT * FROM (SELECT (T2.SUMA_PIPS-T1.SUMA_PIPS) DIFF, COUNT(*) CO FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2 WHERE T2.FECHA_OPERACION > T1.FECHA_OPERACION AND (T2.SUMA_PIPS-T1.SUMA_PIPS)>0 GROUP BY (T2.SUMA_PIPS-T1.SUMA_PIPS) --HAVING COUNT(*)=21 ORDER BY COUNT(*) DESC) WHERE ROWNUM T1.FECHA_OPERACION AND OPER1.FECHA_APERTURA=(SELECT MIN(OPER2.FECHA_APERTURA) FROM OPERACION OPER2 WHERE OPER2.FECHA_APERTURA>T2.FECHA_OPERACION) AND (T2.SUMA_PIPS - T1.SUMA_PIPS)=CONTADOR.DIFF -- GROUP BY CONTADOR.CO, CONTADOR.DIFF ORDER BY CONTADOR.CO DESC, OPER1.FECHA_APERTURA ASC;
SELECT FECHA_OPERACION, SUMA_PIPS, NUMERO_OPERACIONES FROM TENDENCIA_PIPS ORDER BY FECHA_OPERACION DESC;
DELETE FROM PROCESO WHERE ID_INDIVIDUO IN ( SELECT DISTINCT ID_INDIVIDUO FROM INDICADOR_INDIVIDUO II1 WHERE EXISTS (SELECT 1 FROM INDICADOR_INDIVIDUO II2 WHERE II2.TIPO='CLOSE' AND II2.INTERVALO_INFERIOR IS NOT NULL AND II1.ID_INDIVIDUO=II2.ID_INDIVIDUO) );
SELECT * FROM OPERACION;
SELECT II.* FROM FOREX.INDICADOR_INDIVIDUO II WHERE II.ID_INDIVIDUO IN ( '1316654977653.38', '1316654977653.45', '1317700366548.1', '1317700366548.4', '1317701062313.20', '1317871198182.2', '1317871198182.4', '1317871810223.6', '1317922357795.3', '1317922357795.7', '1317987849812.2', '1317987849812.3', '1318987475820.2', '1318987475820.4', '1320319663464.28', '1320377903041.18', '1320377903041.24', '1320377903041.35', '1320451124620.58', '1320503764543.22', '1320517591363.65', '1320517591363.67', '1320517591363.79', '1320517591363.80', '1320517591363.83', '1320517765249.64', '1320517980955.50', '1320518071455.50', '1320518071455.55', '1320518071455.62', '1320518263905.50', '1320518263905.54', '1320518263905.56', '1320518263905.60', '1320520792839.98', '1320530865669.63', '1320533462272.10', '1320533462272.12', '1320533462272.15', '1320533462272.63', '1320533462272.67', '1320533462272.7', '1320624420183.10', '1320624420183.13', '1320624420183.33', '1320644741862.11', '1320645135013.15', '1320645966966.17', '1320682291153.21', '1320682291153.27', '1320718430139.146', '1320718430139.36', '1320718430139.4', '1320809592948.12', '1320809592948.18', '1320809592948.33', '1320896530434.73', '1320896530434.75', '1321157074509.34', '1321160572478.17', '1321160572478.19', '1321196864777.19', '1321196864777.51', '1321196864777.90', '1321377898141.10', '1321379549422.3', '1321379549422.9', '1321443829139.1', '1321443829139.2', '1321493579038.1', '1321529102023.15', '1321529102023.19', '1321529102023.20', '1321529102023.31', '1321529102023.44', '1321529102023.46', '1321529102023.48', '1321529102023.6', '1321529102023.61', '1321529102023.67', '1321529102023.73', '1321529102023.78', '1321529102023.8', '1321529102023.80', '1321529102023.81', '1321529102023.82', '1321529102023.97', '1321530712370.10', '1321530712370.100', '1321530712370.104', '1321530712370.106', '1321530712370.107', '1321530712370.121', '1321530712370.125', '1321530712370.132', '1321530712370.137', '1321530712370.149', '1321530712370.150', '1321530712370.153', '1321530712370.156', '1321530712370.169', '1321530712370.171', '1321530712370.183', '1321530712370.186', '1321530712370.22', '1321530712370.231', '1321530712370.232', '1321530712370.246', '1321530712370.247', '1321530712370.257', '1321530712370.265', '1321530712370.29', '1321530712370.290', '1321530712370.293', '1321530712370.299', '1321530712370.40', '1321530712370.56', '1321530712370.566', '1321530712370.567', '1321530712370.576', '1321530712370.58', '1321530712370.582', '1321530712370.606', '1321530712370.630', '1321530712370.641', '1321530712370.72', '1321530712370.83', '1321530712370.84', '1321530712370.91', '1321549831043.108', '1321549831043.126', '1321549831043.131', '1321549831043.132', '1321549831043.137', '1321549831043.141', '1321549831043.152', '1321549831043.157', '1321549831043.185', '1321549831043.191', '1321549831043.197', '1321549831043.204', '1321549831043.205', '1321549831043.209', '1321549831043.235', '1321549831043.240', '1321549831043.252', '1321549831043.33', '1321549831043.39', '1321549831043.4', '1321549831043.46' ) AND TIPO='CLOSE' AND INTERVALO_INFERIOR IS NOT NULL ORDER BY TIPO DESC, INTERVALO_INFERIOR, INTERVALO_SUPERIOR;
SELECT II.* FROM FOREX.INDICADOR_INDIVIDUO II WHERE II.ID_INDIVIDUO IN ( '1316654977653.4724' , '1316655366815.20286', '1316655366815.25244', '1316655366815.31319', '1316655366815.39084', '1316655366815.65668', '1316655366815.6569' , '1316656451997.19405', '1316656451997.21366', '1316656451997.29941', '1316656451997.48808', '1316656451997.7260' , '1316689452784.9098' , '1316689452784.95705', '1316689524244.18285') AND TIPO='CLOSE' AND INTERVALO_INFERIOR IS NOT NULL ORDER BY TIPO DESC, INTERVALO_INFERIOR, INTERVALO_SUPERIOR;
SELECT II.* FROM FOREX.INDICADOR_INDIVIDUO II WHERE II.ID_INDIVIDUO IN ('1316654977653.4321') ORDER BY TIPO DESC, INTERVALO_INFERIOR, INTERVALO_SUPERIOR;
SELECT * FROM INDICADOR_INDIVIDUO WHERE EXISTS (SELECT 1 FROM INDICADOR_INDIVIDUO WHERE TIPO='CLOSE' AND INTERVALO_INFERIOR IS NOT NULL);
SELECT * FROM INDICADOR_INDIVIDUO;
SELECT * FROM DATOHISTORICO WHERE FECHA = TO_DATE('2008/07/14 00:29','YYYY/MM/DD HH24:MI');
SELECT * FROM DATOHISTORICO WHERE FECHA = TO_DATE('2008/07/14 00:27','YYYY/MM/DD HH24:MI');
SELECT IND.ID ID_INDIVIDUO, IND.TAKE_PROFIT, IND.STOP_LOSS, DH1_OPEN.FECHA OPEN_FECHA, DH1_CLOSE.FECHA CLOSE_FECHA ,PROCESS_CLOSE_PIPS(CALCULAR_PIPS( CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA), CALCULAR_CLOSE_PRICE_TP(DH1_CLOSE.FECHA), OBTENER_SPREAD(DH1_OPEN.FECHA) ), CALCULAR_PIPS( CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA), CALCULAR_CLOSE_PRICE_SL(DH1_CLOSE.FECHA), OBTENER_SPREAD(DH1_OPEN.FECHA) ), IND.TAKE_PROFIT, IND.STOP_LOSS) CLOSE_BY_PIPS ,II_CLOSE_MA.INTERVALO_INFERIOR||';'||PROCESS_CLOSE_PRICE_DEPENDENT(II_CLOSE_MA.INTERVALO_INFERIOR, II_CLOSE_MA.INTERVALO_SUPERIOR, DH1_CLOSE.AVERAGE, DH1_CLOSE.FECHA) CLOSE_MA ,II_CLOSE_MACD.INTERVALO_INFERIOR||';'||PROCESS_CLOSE(II_CLOSE_MACD.INTERVALO_INFERIOR, II_CLOSE_MACD.INTERVALO_SUPERIOR, DH1_CLOSE.MACD_VALUE, DH1_CLOSE.MACD_SIGNAL) CLOSE_MACD ,II_CLOSE_COMPARE.INTERVALO_INFERIOR||';'||PROCESS_CLOSE(II_CLOSE_COMPARE.INTERVALO_INFERIOR, II_CLOSE_COMPARE.INTERVALO_SUPERIOR, DH1_CLOSE.AVERAGE_COMPARE-DH1_CLOSE.COMPARE_VALUE,0) CLOSE_COMPARE ,II_CLOSE_SAR.INTERVALO_INFERIOR||';'||PROCESS_CLOSE_PRICE_DEPENDENT(II_CLOSE_SAR.INTERVALO_INFERIOR, II_CLOSE_SAR.INTERVALO_SUPERIOR, DH1_CLOSE.SAR, DH1_CLOSE.FECHA) CLOSE_SAR ,II_CLOSE_ADX.INTERVALO_INFERIOR||';'||PROCESS_CLOSE(II_CLOSE_ADX.INTERVALO_INFERIOR, II_CLOSE_ADX.INTERVALO_SUPERIOR, DH1_CLOSE.ADX_VALUE*DH1_CLOSE.ADX_PLUS, DH1_CLOSE.ADX_VALUE*DH1_CLOSE.ADX_MINUS) CLOSE_ADX ,II_CLOSE_RSI.INTERVALO_INFERIOR||';'||PROCESS_CLOSE(II_CLOSE_RSI.INTERVALO_INFERIOR, II_CLOSE_RSI.INTERVALO_SUPERIOR, DH1_CLOSE.RSI, 0) CLOSE_RSI ,II_CLOSE_BOLLINGER.INTERVALO_INFERIOR||';'||PROCESS_CLOSE(II_CLOSE_BOLLINGER.INTERVALO_INFERIOR, II_CLOSE_BOLLINGER.INTERVALO_SUPERIOR, DH1_CLOSE.BOLLINGER_UPPER, DH1_CLOSE.BOLLINGER_LOWER) CLOSE_BOLLINGER ,II_CLOSE_MOMENTUM.INTERVALO_INFERIOR||';'||PROCESS_CLOSE(II_CLOSE_MOMENTUM.INTERVALO_INFERIOR, II_CLOSE_MOMENTUM.INTERVALO_SUPERIOR, DH1_CLOSE.MOMENTUM, 0) CLOSE_MOMENTUM ,II_CLOSE_ICHITREND.INTERVALO_INFERIOR||';'||PROCESS_CLOSE_PRICE_DEPENDENT(II_CLOSE_ICHITREND.INTERVALO_INFERIOR, II_CLOSE_ICHITREND.INTERVALO_SUPERIOR, DH1_CLOSE.ICHIMOKUSENKOUSPANA-DH1_CLOSE.ICHIMOKUSENKOUSPANB, DH1_CLOSE.FECHA) CLOSE_ICHITREND ,II_CLOSE_ICHISIGNAL.INTERVALO_INFERIOR||';'||PROCESS_CLOSE(II_CLOSE_ICHISIGNAL.INTERVALO_INFERIOR, II_CLOSE_ICHISIGNAL.INTERVALO_SUPERIOR, DH1_CLOSE.ICHIMOKUCHINKOUSPAN*DH1_CLOSE.ICHIMOKUTENKANSEN, DH1_CLOSE.ICHIMOKUCHINKOUSPAN*DH1_CLOSE.ICHIMOKUKIJUNSEN) CLOSE_ICHISIGNAL FROM DATOHISTORICO DH1_OPEN, DATOHISTORICO DH1_CLOSE, INDIVIDUO IND, INDICADOR_INDIVIDUO II_OPEN_MA, INDICADOR_INDIVIDUO II_CLOSE_MA, INDICADOR_INDIVIDUO II_OPEN_MACD, INDICADOR_INDIVIDUO II_CLOSE_MACD, INDICADOR_INDIVIDUO II_OPEN_COMPARE, INDICADOR_INDIVIDUO II_CLOSE_COMPARE, INDICADOR_INDIVIDUO II_OPEN_SAR, INDICADOR_INDIVIDUO II_CLOSE_SAR, INDICADOR_INDIVIDUO II_OPEN_ADX, INDICADOR_INDIVIDUO II_CLOSE_ADX, INDICADOR_INDIVIDUO II_OPEN_RSI, INDICADOR_INDIVIDUO II_CLOSE_RSI, INDICADOR_INDIVIDUO II_OPEN_BOLLINGER, INDICADOR_INDIVIDUO II_CLOSE_BOLLINGER, INDICADOR_INDIVIDUO II_OPEN_MOMENTUM, INDICADOR_INDIVIDUO II_CLOSE_MOMENTUM, INDICADOR_INDIVIDUO II_OPEN_ICHITREND, INDICADOR_INDIVIDUO II_CLOSE_ICHITREND, INDICADOR_INDIVIDUO II_OPEN_ICHISIGNAL, INDICADOR_INDIVIDUO II_CLOSE_ICHISIGNAL WHERE IND.ID=II_OPEN_MA.ID_INDIVIDUO AND IND.ID=II_CLOSE_MA.ID_INDIVIDUO AND IND.ID=II_OPEN_MACD.ID_INDIVIDUO AND IND.ID=II_CLOSE_MACD.ID_INDIVIDUO AND IND.ID=II_OPEN_COMPARE.ID_INDIVIDUO AND IND.ID=II_CLOSE_COMPARE.ID_INDIVIDUO AND IND.ID=II_OPEN_SAR.ID_INDIVIDUO AND IND.ID=II_CLOSE_SAR.ID_INDIVIDUO AND IND.ID=II_OPEN_ADX.ID_INDIVIDUO AND IND.ID=II_CLOSE_ADX.ID_INDIVIDUO AND IND.ID=II_OPEN_RSI.ID_INDIVIDUO AND IND.ID=II_CLOSE_RSI.ID_INDIVIDUO AND IND.ID=II_OPEN_BOLLINGER.ID_INDIVIDUO AND IND.ID=II_CLOSE_BOLLINGER.ID_INDIVIDUO AND IND.ID=II_OPEN_MOMENTUM.ID_INDIVIDUO AND IND.ID=II_CLOSE_MOMENTUM.ID_INDIVIDUO AND IND.ID=II_OPEN_ICHITREND.ID_INDIVIDUO AND IND.ID=II_CLOSE_ICHITREND.ID_INDIVIDUO AND IND.ID=II_OPEN_ICHISIGNAL.ID_INDIVIDUO AND IND.ID=II_CLOSE_ICHISIGNAL.ID_INDIVIDUO AND II_OPEN_MA.TIPO='OPEN' AND II_OPEN_MA.ID_INDICADOR='MA' AND II_OPEN_MACD.TIPO='OPEN' AND II_OPEN_MACD.ID_INDICADOR='MACD' AND II_OPEN_COMPARE.TIPO='OPEN' AND II_OPEN_COMPARE.ID_INDICADOR='COMPARE_MA' AND II_OPEN_SAR.TIPO='OPEN' AND II_OPEN_SAR.ID_INDICADOR='SAR' AND II_OPEN_ADX.TIPO='OPEN' AND II_OPEN_ADX.ID_INDICADOR='ADX' AND II_OPEN_RSI.TIPO='OPEN' AND II_OPEN_RSI.ID_INDICADOR='RSI' AND II_OPEN_BOLLINGER.TIPO='OPEN' AND II_OPEN_BOLLINGER.ID_INDICADOR='BOLLINGER' AND II_OPEN_MOMENTUM.TIPO='OPEN' AND II_OPEN_MOMENTUM.ID_INDICADOR='MOMENTUM' AND II_OPEN_ICHITREND.TIPO='OPEN' AND II_OPEN_ICHITREND.ID_INDICADOR='ICHIMOKU_TREND' AND II_OPEN_ICHISIGNAL.TIPO='OPEN' AND II_OPEN_ICHISIGNAL.ID_INDICADOR='ICHIMOKU_SIGNAL' AND II_CLOSE_MA.TIPO='CLOSE' AND II_CLOSE_MA.ID_INDICADOR='MA' AND II_CLOSE_MACD.TIPO='CLOSE' AND II_CLOSE_MACD.ID_INDICADOR='MACD' AND II_CLOSE_COMPARE.TIPO='CLOSE' AND II_CLOSE_COMPARE.ID_INDICADOR='COMPARE_MA' AND II_CLOSE_SAR.TIPO='CLOSE' AND II_CLOSE_SAR.ID_INDICADOR='SAR' AND II_CLOSE_ADX.TIPO='CLOSE' AND II_CLOSE_ADX.ID_INDICADOR='ADX' AND II_CLOSE_RSI.TIPO='CLOSE' AND II_CLOSE_RSI.ID_INDICADOR='RSI' AND II_CLOSE_BOLLINGER.TIPO='CLOSE' AND II_CLOSE_BOLLINGER.ID_INDICADOR='BOLLINGER' AND II_CLOSE_MOMENTUM.TIPO='CLOSE' AND II_CLOSE_MOMENTUM.ID_INDICADOR='MOMENTUM' AND II_CLOSE_ICHITREND.TIPO='CLOSE' AND II_CLOSE_ICHITREND.ID_INDICADOR='ICHIMOKU_TREND' AND II_CLOSE_ICHISIGNAL.TIPO='CLOSE' AND II_CLOSE_ICHISIGNAL.ID_INDICADOR='ICHIMOKU_SIGNAL' AND DH1_OPEN.AVERAGE IS NOT NULL AND DH1_OPEN.MACD_VALUE IS NOT NULL AND DH1_OPEN.MACD_SIGNAL IS NOT NULL AND DH1_OPEN.COMPARE_VALUE IS NOT NULL AND DH1_OPEN.AVERAGE_COMPARE IS NOT NULL AND DH1_OPEN.SAR IS NOT NULL AND DH1_OPEN.ADX_VALUE IS NOT NULL AND DH1_OPEN.ADX_PLUS IS NOT NULL AND DH1_OPEN.ADX_MINUS IS NOT NULL AND DH1_OPEN.RSI IS NOT NULL AND DH1_OPEN.BOLLINGER_UPPER IS NOT NULL AND DH1_OPEN.BOLLINGER_LOWER IS NOT NULL AND DH1_OPEN.MOMENTUM IS NOT NULL AND DH1_OPEN.ICHIMOKUTENKANSEN IS NOT NULL AND DH1_OPEN.ICHIMOKUKIJUNSEN IS NOT NULL AND DH1_OPEN.ICHIMOKUSENKOUSPANA IS NOT NULL AND DH1_OPEN.ICHIMOKUSENKOUSPANB IS NOT NULL AND DH1_OPEN.ICHIMOKUCHINKOUSPAN IS NOT NULL AND DH1_CLOSE.AVERAGE IS NOT NULL AND DH1_CLOSE.MACD_VALUE IS NOT NULL AND DH1_CLOSE.MACD_SIGNAL IS NOT NULL AND DH1_CLOSE.COMPARE_VALUE IS NOT NULL AND DH1_CLOSE.AVERAGE_COMPARE IS NOT NULL AND DH1_CLOSE.SAR IS NOT NULL AND DH1_CLOSE.ADX_VALUE IS NOT NULL AND DH1_CLOSE.ADX_PLUS IS NOT NULL AND DH1_CLOSE.ADX_MINUS IS NOT NULL AND DH1_CLOSE.RSI IS NOT NULL AND DH1_CLOSE.BOLLINGER_UPPER IS NOT NULL AND DH1_CLOSE.BOLLINGER_LOWER IS NOT NULL AND DH1_CLOSE.MOMENTUM IS NOT NULL AND DH1_CLOSE.ICHIMOKUTENKANSEN IS NOT NULL AND DH1_CLOSE.ICHIMOKUKIJUNSEN IS NOT NULL AND DH1_CLOSE.ICHIMOKUSENKOUSPANA IS NOT NULL AND DH1_CLOSE.ICHIMOKUSENKOUSPANB IS NOT NULL AND DH1_CLOSE.ICHIMOKUCHINKOUSPAN IS NOT NULL AND IND.ID='1329927210938.2964' AND DH1_OPEN.FECHA=TO_DATE('2008/07/14 00:27','YYYY/MM/DD HH24:MI') AND DH1_CLOSE.FECHA=TO_DATE('2008/07/14 00:30','YYYY/MM/DD HH24:MI') ;
SELECT IND.ID ID_INDIVIDUO, IND.TAKE_PROFIT, IND.STOP_LOSS, DH1_OPEN.FECHA OPEN_FECHA, DH1_CLOSE.FECHA CLOSE_FECHA ,PROCESS_CLOSE_PIPS(CALCULAR_PIPS( CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA), CALCULAR_CLOSE_PRICE_TP(DH1_CLOSE.FECHA), OBTENER_SPREAD(DH1_OPEN.FECHA) ), CALCULAR_PIPS( CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA), CALCULAR_CLOSE_PRICE_SL(DH1_CLOSE.FECHA), OBTENER_SPREAD(DH1_OPEN.FECHA) ), IND.TAKE_PROFIT, IND.STOP_LOSS) CLOSE_BY_PIPS ,II_CLOSE_MA.INTERVALO_INFERIOR||';'||PROCESS_CLOSE_PRICE_DEPENDENT(II_CLOSE_MA.INTERVALO_INFERIOR, II_CLOSE_MA.INTERVALO_SUPERIOR, DH1_CLOSE.AVERAGE, DH1_CLOSE.FECHA) CLOSE_MA ,II_CLOSE_MACD.INTERVALO_INFERIOR||';'||PROCESS_CLOSE(II_CLOSE_MACD.INTERVALO_INFERIOR, II_CLOSE_MACD.INTERVALO_SUPERIOR, DH1_CLOSE.MACD_VALUE, DH1_CLOSE.MACD_SIGNAL) CLOSE_MACD ,II_CLOSE_COMPARE.INTERVALO_INFERIOR||';'||PROCESS_CLOSE(II_CLOSE_COMPARE.INTERVALO_INFERIOR, II_CLOSE_COMPARE.INTERVALO_SUPERIOR, DH1_CLOSE.AVERAGE_COMPARE-DH1_CLOSE.COMPARE_VALUE,0) CLOSE_COMPARE ,II_CLOSE_SAR.INTERVALO_INFERIOR||';'||PROCESS_CLOSE_PRICE_DEPENDENT(II_CLOSE_SAR.INTERVALO_INFERIOR, II_CLOSE_SAR.INTERVALO_SUPERIOR, DH1_CLOSE.SAR, DH1_CLOSE.FECHA) CLOSE_SAR ,II_CLOSE_ADX.INTERVALO_INFERIOR||';'||PROCESS_CLOSE(II_CLOSE_ADX.INTERVALO_INFERIOR, II_CLOSE_ADX.INTERVALO_SUPERIOR, DH1_CLOSE.ADX_VALUE*DH1_CLOSE.ADX_PLUS, DH1_CLOSE.ADX_VALUE*DH1_CLOSE.ADX_MINUS) CLOSE_ADX ,II_CLOSE_RSI.INTERVALO_INFERIOR||';'||PROCESS_CLOSE(II_CLOSE_RSI.INTERVALO_INFERIOR, II_CLOSE_RSI.INTERVALO_SUPERIOR, DH1_CLOSE.RSI, 0) CLOSE_RSI ,II_CLOSE_BOLLINGER.INTERVALO_INFERIOR||';'||PROCESS_CLOSE(II_CLOSE_BOLLINGER.INTERVALO_INFERIOR, II_CLOSE_BOLLINGER.INTERVALO_SUPERIOR, DH1_CLOSE.BOLLINGER_UPPER, DH1_CLOSE.BOLLINGER_LOWER) CLOSE_BOLLINGER ,II_CLOSE_MOMENTUM.INTERVALO_INFERIOR||';'||PROCESS_CLOSE(II_CLOSE_MOMENTUM.INTERVALO_INFERIOR, II_CLOSE_MOMENTUM.INTERVALO_SUPERIOR, DH1_CLOSE.MOMENTUM, 0) CLOSE_MOMENTUM ,II_CLOSE_ICHITREND.INTERVALO_INFERIOR||';'||PROCESS_CLOSE_PRICE_DEPENDENT(II_CLOSE_ICHITREND.INTERVALO_INFERIOR, II_CLOSE_ICHITREND.INTERVALO_SUPERIOR, DH1_CLOSE.ICHIMOKUSENKOUSPANA-DH1_CLOSE.ICHIMOKUSENKOUSPANB, DH1_CLOSE.FECHA) CLOSE_ICHITREND ,II_CLOSE_ICHISIGNAL.INTERVALO_INFERIOR||';'||PROCESS_CLOSE(II_CLOSE_ICHISIGNAL.INTERVALO_INFERIOR, II_CLOSE_ICHISIGNAL.INTERVALO_SUPERIOR, DH1_CLOSE.ICHIMOKUCHINKOUSPAN*DH1_CLOSE.ICHIMOKUTENKANSEN, DH1_CLOSE.ICHIMOKUCHINKOUSPAN*DH1_CLOSE.ICHIMOKUKIJUNSEN) CLOSE_ICHISIGNAL FROM DATOHISTORICO DH1_OPEN, DATOHISTORICO DH1_CLOSE, INDIVIDUO IND, INDICADOR_INDIVIDUO II_OPEN_MA, INDICADOR_INDIVIDUO II_CLOSE_MA, INDICADOR_INDIVIDUO II_OPEN_MACD, INDICADOR_INDIVIDUO II_CLOSE_MACD, INDICADOR_INDIVIDUO II_OPEN_COMPARE, INDICADOR_INDIVIDUO II_CLOSE_COMPARE, INDICADOR_INDIVIDUO II_OPEN_SAR, INDICADOR_INDIVIDUO II_CLOSE_SAR, INDICADOR_INDIVIDUO II_OPEN_ADX, INDICADOR_INDIVIDUO II_CLOSE_ADX, INDICADOR_INDIVIDUO II_OPEN_RSI, INDICADOR_INDIVIDUO II_CLOSE_RSI, INDICADOR_INDIVIDUO II_OPEN_BOLLINGER, INDICADOR_INDIVIDUO II_CLOSE_BOLLINGER, INDICADOR_INDIVIDUO II_OPEN_MOMENTUM, INDICADOR_INDIVIDUO II_CLOSE_MOMENTUM, INDICADOR_INDIVIDUO II_OPEN_ICHITREND, INDICADOR_INDIVIDUO II_CLOSE_ICHITREND, INDICADOR_INDIVIDUO II_OPEN_ICHISIGNAL, INDICADOR_INDIVIDUO II_CLOSE_ICHISIGNAL WHERE IND.ID=II_OPEN_MA.ID_INDIVIDUO AND IND.ID=II_CLOSE_MA.ID_INDIVIDUO AND IND.ID=II_OPEN_MACD.ID_INDIVIDUO AND IND.ID=II_CLOSE_MACD.ID_INDIVIDUO AND IND.ID=II_OPEN_COMPARE.ID_INDIVIDUO AND IND.ID=II_CLOSE_COMPARE.ID_INDIVIDUO AND IND.ID=II_OPEN_SAR.ID_INDIVIDUO AND IND.ID=II_CLOSE_SAR.ID_INDIVIDUO AND IND.ID=II_OPEN_ADX.ID_INDIVIDUO AND IND.ID=II_CLOSE_ADX.ID_INDIVIDUO AND IND.ID=II_OPEN_RSI.ID_INDIVIDUO AND IND.ID=II_CLOSE_RSI.ID_INDIVIDUO AND IND.ID=II_OPEN_BOLLINGER.ID_INDIVIDUO AND IND.ID=II_CLOSE_BOLLINGER.ID_INDIVIDUO AND IND.ID=II_OPEN_MOMENTUM.ID_INDIVIDUO AND IND.ID=II_CLOSE_MOMENTUM.ID_INDIVIDUO AND IND.ID=II_OPEN_ICHITREND.ID_INDIVIDUO AND IND.ID=II_CLOSE_ICHITREND.ID_INDIVIDUO AND IND.ID=II_OPEN_ICHISIGNAL.ID_INDIVIDUO AND IND.ID=II_CLOSE_ICHISIGNAL.ID_INDIVIDUO AND II_OPEN_MA.TIPO='OPEN' AND II_OPEN_MA.ID_INDICADOR='MA' AND II_OPEN_MACD.TIPO='OPEN' AND II_OPEN_MACD.ID_INDICADOR='MACD' AND II_OPEN_COMPARE.TIPO='OPEN' AND II_OPEN_COMPARE.ID_INDICADOR='COMPARE_MA' AND II_OPEN_SAR.TIPO='OPEN' AND II_OPEN_SAR.ID_INDICADOR='SAR' AND II_OPEN_ADX.TIPO='OPEN' AND II_OPEN_ADX.ID_INDICADOR='ADX' AND II_OPEN_RSI.TIPO='OPEN' AND II_OPEN_RSI.ID_INDICADOR='RSI' AND II_OPEN_BOLLINGER.TIPO='OPEN' AND II_OPEN_BOLLINGER.ID_INDICADOR='BOLLINGER' AND II_OPEN_MOMENTUM.TIPO='OPEN' AND II_OPEN_MOMENTUM.ID_INDICADOR='MOMENTUM' AND II_OPEN_ICHITREND.TIPO='OPEN' AND II_OPEN_ICHITREND.ID_INDICADOR='ICHIMOKU_TREND' AND II_OPEN_ICHISIGNAL.TIPO='OPEN' AND II_OPEN_ICHISIGNAL.ID_INDICADOR='ICHIMOKU_SIGNAL' AND II_CLOSE_MA.TIPO='CLOSE' AND II_CLOSE_MA.ID_INDICADOR='MA' AND II_CLOSE_MACD.TIPO='CLOSE' AND II_CLOSE_MACD.ID_INDICADOR='MACD' AND II_CLOSE_COMPARE.TIPO='CLOSE' AND II_CLOSE_COMPARE.ID_INDICADOR='COMPARE_MA' AND II_CLOSE_SAR.TIPO='CLOSE' AND II_CLOSE_SAR.ID_INDICADOR='SAR' AND II_CLOSE_ADX.TIPO='CLOSE' AND II_CLOSE_ADX.ID_INDICADOR='ADX' AND II_CLOSE_RSI.TIPO='CLOSE' AND II_CLOSE_RSI.ID_INDICADOR='RSI' AND II_CLOSE_BOLLINGER.TIPO='CLOSE' AND II_CLOSE_BOLLINGER.ID_INDICADOR='BOLLINGER' AND II_CLOSE_MOMENTUM.TIPO='CLOSE' AND II_CLOSE_MOMENTUM.ID_INDICADOR='MOMENTUM' AND II_CLOSE_ICHITREND.TIPO='CLOSE' AND II_CLOSE_ICHITREND.ID_INDICADOR='ICHIMOKU_TREND' AND II_CLOSE_ICHISIGNAL.TIPO='CLOSE' AND II_CLOSE_ICHISIGNAL.ID_INDICADOR='ICHIMOKU_SIGNAL' AND DH1_OPEN.AVERAGE IS NOT NULL AND DH1_OPEN.MACD_VALUE IS NOT NULL AND DH1_OPEN.MACD_SIGNAL IS NOT NULL AND DH1_OPEN.COMPARE_VALUE IS NOT NULL AND DH1_OPEN.AVERAGE_COMPARE IS NOT NULL AND DH1_OPEN.SAR IS NOT NULL AND DH1_OPEN.ADX_VALUE IS NOT NULL AND DH1_OPEN.ADX_PLUS IS NOT NULL AND DH1_OPEN.ADX_MINUS IS NOT NULL AND DH1_OPEN.RSI IS NOT NULL AND DH1_OPEN.BOLLINGER_UPPER IS NOT NULL AND DH1_OPEN.BOLLINGER_LOWER IS NOT NULL AND DH1_OPEN.MOMENTUM IS NOT NULL AND DH1_OPEN.ICHIMOKUTENKANSEN IS NOT NULL AND DH1_OPEN.ICHIMOKUKIJUNSEN IS NOT NULL AND DH1_OPEN.ICHIMOKUSENKOUSPANA IS NOT NULL AND DH1_OPEN.ICHIMOKUSENKOUSPANB IS NOT NULL AND DH1_OPEN.ICHIMOKUCHINKOUSPAN IS NOT NULL AND DH1_CLOSE.AVERAGE IS NOT NULL AND DH1_CLOSE.MACD_VALUE IS NOT NULL AND DH1_CLOSE.MACD_SIGNAL IS NOT NULL AND DH1_CLOSE.COMPARE_VALUE IS NOT NULL AND DH1_CLOSE.AVERAGE_COMPARE IS NOT NULL AND DH1_CLOSE.SAR IS NOT NULL AND DH1_CLOSE.ADX_VALUE IS NOT NULL AND DH1_CLOSE.ADX_PLUS IS NOT NULL AND DH1_CLOSE.ADX_MINUS IS NOT NULL AND DH1_CLOSE.RSI IS NOT NULL AND DH1_CLOSE.BOLLINGER_UPPER IS NOT NULL AND DH1_CLOSE.BOLLINGER_LOWER IS NOT NULL AND DH1_CLOSE.MOMENTUM IS NOT NULL AND DH1_CLOSE.ICHIMOKUTENKANSEN IS NOT NULL AND DH1_CLOSE.ICHIMOKUKIJUNSEN IS NOT NULL AND DH1_CLOSE.ICHIMOKUSENKOUSPANA IS NOT NULL AND DH1_CLOSE.ICHIMOKUSENKOUSPANB IS NOT NULL AND DH1_CLOSE.ICHIMOKUCHINKOUSPAN IS NOT NULL AND IND.ID='1329927210938.2964' AND DH1_OPEN.FECHA=TO_DATE('2008/07/14 00:27','YYYY/MM/DD HH24:MI') AND DH1_CLOSE.FECHA=TO_DATE('2008/07/14 00:29','YYYY/MM/DD HH24:MI') ;
SELECT IND.ID ID_INDIVIDUO, IND.TAKE_PROFIT, IND.STOP_LOSS, DH1_OPEN.FECHA OPEN_FECHA, DH1_CLOSE.FECHA CLOSE_FECHA ,PROCESS_CLOSE_PIPS(CALCULAR_PIPS( CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA), CALCULAR_CLOSE_PRICE_TP(DH1_CLOSE.FECHA), OBTENER_SPREAD(DH1_OPEN.FECHA) ), CALCULAR_PIPS( CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA), CALCULAR_CLOSE_PRICE_SL(DH1_CLOSE.FECHA), OBTENER_SPREAD(DH1_OPEN.FECHA) ), IND.TAKE_PROFIT, IND.STOP_LOSS) CLOSE_BY_PIPS /*II_CLOSE_COMPARE.INTERVALO_INFERIOR IS NOT NULL OR II_CLOSE_SAR.INTERVALO_INFERIOR IS NOT NULL OR II_CLOSE_ADX.INTERVALO_INFERIOR IS NOT NULL OR II_CLOSE_RSI.INTERVALO_INFERIOR IS NOT NULL OR II_CLOSE_BOLLINGER.INTERVALO_INFERIOR IS NOT NULL OR II_CLOSE_MOMENTUM.INTERVALO_INFERIOR IS NOT NULL OR II_CLOSE_ICHITREND.INTERVALO_INFERIOR IS NOT NULL OR II_CLOSE_ICHISIGNAL.INTERVALO_INFERIOR IS NOT NULL) ANY_CLOSE_NOT_NULL*/ ,II_CLOSE_MA.INTERVALO_INFERIOR||';'||PROCESS_CLOSE_PRICE_DEPENDENT(II_CLOSE_MA.INTERVALO_INFERIOR, II_CLOSE_MA.INTERVALO_SUPERIOR, DH1_CLOSE.AVERAGE, DH1_CLOSE.FECHA) CLOSE_MA ,II_CLOSE_MACD.INTERVALO_INFERIOR||';'||PROCESS_CLOSE(II_CLOSE_MACD.INTERVALO_INFERIOR, II_CLOSE_MACD.INTERVALO_SUPERIOR, DH1_CLOSE.MACD_VALUE, DH1_CLOSE.MACD_SIGNAL) CLOSE_MACD ,PROCESS_CLOSE(II_CLOSE_COMPARE.INTERVALO_INFERIOR, II_CLOSE_COMPARE.INTERVALO_SUPERIOR, DH1_CLOSE.AVERAGE_COMPARE-DH1_CLOSE.COMPARE_VALUE,0) CLOSE_COMPARE ,PROCESS_CLOSE_PRICE_DEPENDENT(II_CLOSE_SAR.INTERVALO_INFERIOR, II_CLOSE_SAR.INTERVALO_SUPERIOR, DH1_CLOSE.SAR, DH1_CLOSE.FECHA) CLOSE_SAR ,PROCESS_CLOSE(II_CLOSE_ADX.INTERVALO_INFERIOR, II_CLOSE_ADX.INTERVALO_SUPERIOR, DH1_CLOSE.ADX_VALUE*DH1_CLOSE.ADX_PLUS, DH1_CLOSE.ADX_VALUE*DH1_CLOSE.ADX_MINUS) CLOSE_ADX ,PROCESS_CLOSE(II_CLOSE_RSI.INTERVALO_INFERIOR, II_CLOSE_RSI.INTERVALO_SUPERIOR, DH1_CLOSE.RSI, 0) CLOSE_RSI ,PROCESS_CLOSE(II_CLOSE_BOLLINGER.INTERVALO_INFERIOR, II_CLOSE_BOLLINGER.INTERVALO_SUPERIOR, DH1_CLOSE.BOLLINGER_UPPER, DH1_CLOSE.BOLLINGER_LOWER) CLOSE_BOLLINGER ,PROCESS_CLOSE(II_CLOSE_MOMENTUM.INTERVALO_INFERIOR, II_CLOSE_MOMENTUM.INTERVALO_SUPERIOR, DH1_CLOSE.MOMENTUM, 0) CLOSE_MOMENTUM ,PROCESS_CLOSE_PRICE_DEPENDENT(II_CLOSE_ICHITREND.INTERVALO_INFERIOR, II_CLOSE_ICHITREND.INTERVALO_SUPERIOR, DH1_CLOSE.ICHIMOKUSENKOUSPANA-DH1_CLOSE.ICHIMOKUSENKOUSPANB, DH1_CLOSE.FECHA) CLOSE_ICHITREND ,PROCESS_CLOSE(II_CLOSE_ICHISIGNAL.INTERVALO_INFERIOR, II_CLOSE_ICHISIGNAL.INTERVALO_SUPERIOR, DH1_CLOSE.ICHIMOKUCHINKOUSPAN*DH1_CLOSE.ICHIMOKUTENKANSEN, DH1_CLOSE.ICHIMOKUCHINKOUSPAN*DH1_CLOSE.ICHIMOKUKIJUNSEN) CLOSE_ICHISIGNAL FROM DATOHISTORICO DH1_OPEN, DATOHISTORICO DH1_CLOSE, INDIVIDUO IND, INDICADOR_INDIVIDUO II_OPEN_MA, INDICADOR_INDIVIDUO II_CLOSE_MA, INDICADOR_INDIVIDUO II_OPEN_MACD, INDICADOR_INDIVIDUO II_CLOSE_MACD, INDICADOR_INDIVIDUO II_OPEN_COMPARE, INDICADOR_INDIVIDUO II_CLOSE_COMPARE, INDICADOR_INDIVIDUO II_OPEN_SAR, INDICADOR_INDIVIDUO II_CLOSE_SAR, INDICADOR_INDIVIDUO II_OPEN_ADX, INDICADOR_INDIVIDUO II_CLOSE_ADX, INDICADOR_INDIVIDUO II_OPEN_RSI, INDICADOR_INDIVIDUO II_CLOSE_RSI, INDICADOR_INDIVIDUO II_OPEN_BOLLINGER, INDICADOR_INDIVIDUO II_CLOSE_BOLLINGER, INDICADOR_INDIVIDUO II_OPEN_MOMENTUM, INDICADOR_INDIVIDUO II_CLOSE_MOMENTUM, INDICADOR_INDIVIDUO II_OPEN_ICHITREND, INDICADOR_INDIVIDUO II_CLOSE_ICHITREND, INDICADOR_INDIVIDUO II_OPEN_ICHISIGNAL, INDICADOR_INDIVIDUO II_CLOSE_ICHISIGNAL WHERE IND.ID=II_OPEN_MA.ID_INDIVIDUO AND IND.ID=II_CLOSE_MA.ID_INDIVIDUO AND IND.ID=II_OPEN_MACD.ID_INDIVIDUO AND IND.ID=II_CLOSE_MACD.ID_INDIVIDUO AND IND.ID=II_OPEN_COMPARE.ID_INDIVIDUO AND IND.ID=II_CLOSE_COMPARE.ID_INDIVIDUO AND IND.ID=II_OPEN_SAR.ID_INDIVIDUO AND IND.ID=II_CLOSE_SAR.ID_INDIVIDUO AND IND.ID=II_OPEN_ADX.ID_INDIVIDUO AND IND.ID=II_CLOSE_ADX.ID_INDIVIDUO AND IND.ID=II_OPEN_RSI.ID_INDIVIDUO AND IND.ID=II_CLOSE_RSI.ID_INDIVIDUO AND IND.ID=II_OPEN_BOLLINGER.ID_INDIVIDUO AND IND.ID=II_CLOSE_BOLLINGER.ID_INDIVIDUO AND IND.ID=II_OPEN_MOMENTUM.ID_INDIVIDUO AND IND.ID=II_CLOSE_MOMENTUM.ID_INDIVIDUO AND IND.ID=II_OPEN_ICHITREND.ID_INDIVIDUO AND IND.ID=II_CLOSE_ICHITREND.ID_INDIVIDUO AND IND.ID=II_OPEN_ICHISIGNAL.ID_INDIVIDUO AND IND.ID=II_CLOSE_ICHISIGNAL.ID_INDIVIDUO AND II_OPEN_MA.TIPO='OPEN' AND II_OPEN_MA.ID_INDICADOR='MA' AND II_OPEN_MACD.TIPO='OPEN' AND II_OPEN_MACD.ID_INDICADOR='MACD' AND II_OPEN_COMPARE.TIPO='OPEN' AND II_OPEN_COMPARE.ID_INDICADOR='COMPARE_MA' AND II_OPEN_SAR.TIPO='OPEN' AND II_OPEN_SAR.ID_INDICADOR='SAR' AND II_OPEN_ADX.TIPO='OPEN' AND II_OPEN_ADX.ID_INDICADOR='ADX' AND II_OPEN_RSI.TIPO='OPEN' AND II_OPEN_RSI.ID_INDICADOR='RSI' AND II_OPEN_BOLLINGER.TIPO='OPEN' AND II_OPEN_BOLLINGER.ID_INDICADOR='BOLLINGER' AND II_OPEN_MOMENTUM.TIPO='OPEN' AND II_OPEN_MOMENTUM.ID_INDICADOR='MOMENTUM' AND II_OPEN_ICHITREND.TIPO='OPEN' AND II_OPEN_ICHITREND.ID_INDICADOR='ICHIMOKU_TREND' AND II_OPEN_ICHISIGNAL.TIPO='OPEN' AND II_OPEN_ICHISIGNAL.ID_INDICADOR='ICHIMOKU_SIGNAL' AND II_CLOSE_MA.TIPO='CLOSE' AND II_CLOSE_MA.ID_INDICADOR='MA' AND II_CLOSE_MACD.TIPO='CLOSE' AND II_CLOSE_MACD.ID_INDICADOR='MACD' AND II_CLOSE_COMPARE.TIPO='CLOSE' AND II_CLOSE_COMPARE.ID_INDICADOR='COMPARE_MA' AND II_CLOSE_SAR.TIPO='CLOSE' AND II_CLOSE_SAR.ID_INDICADOR='SAR' AND II_CLOSE_ADX.TIPO='CLOSE' AND II_CLOSE_ADX.ID_INDICADOR='ADX' AND II_CLOSE_RSI.TIPO='CLOSE' AND II_CLOSE_RSI.ID_INDICADOR='RSI' AND II_CLOSE_BOLLINGER.TIPO='CLOSE' AND II_CLOSE_BOLLINGER.ID_INDICADOR='BOLLINGER' AND II_CLOSE_MOMENTUM.TIPO='CLOSE' AND II_CLOSE_MOMENTUM.ID_INDICADOR='MOMENTUM' AND II_CLOSE_ICHITREND.TIPO='CLOSE' AND II_CLOSE_ICHITREND.ID_INDICADOR='ICHIMOKU_TREND' AND II_CLOSE_ICHISIGNAL.TIPO='CLOSE' AND II_CLOSE_ICHISIGNAL.ID_INDICADOR='ICHIMOKU_SIGNAL' AND DH1_OPEN.AVERAGE IS NOT NULL AND DH1_OPEN.MACD_VALUE IS NOT NULL AND DH1_OPEN.MACD_SIGNAL IS NOT NULL AND DH1_OPEN.COMPARE_VALUE IS NOT NULL AND DH1_OPEN.AVERAGE_COMPARE IS NOT NULL AND DH1_OPEN.SAR IS NOT NULL AND DH1_OPEN.ADX_VALUE IS NOT NULL AND DH1_OPEN.ADX_PLUS IS NOT NULL AND DH1_OPEN.ADX_MINUS IS NOT NULL AND DH1_OPEN.RSI IS NOT NULL AND DH1_OPEN.BOLLINGER_UPPER IS NOT NULL AND DH1_OPEN.BOLLINGER_LOWER IS NOT NULL AND DH1_OPEN.MOMENTUM IS NOT NULL AND DH1_OPEN.ICHIMOKUTENKANSEN IS NOT NULL AND DH1_OPEN.ICHIMOKUKIJUNSEN IS NOT NULL AND DH1_OPEN.ICHIMOKUSENKOUSPANA IS NOT NULL AND DH1_OPEN.ICHIMOKUSENKOUSPANB IS NOT NULL AND DH1_OPEN.ICHIMOKUCHINKOUSPAN IS NOT NULL AND DH1_CLOSE.AVERAGE IS NOT NULL AND DH1_CLOSE.MACD_VALUE IS NOT NULL AND DH1_CLOSE.MACD_SIGNAL IS NOT NULL AND DH1_CLOSE.COMPARE_VALUE IS NOT NULL AND DH1_CLOSE.AVERAGE_COMPARE IS NOT NULL AND DH1_CLOSE.SAR IS NOT NULL AND DH1_CLOSE.ADX_VALUE IS NOT NULL AND DH1_CLOSE.ADX_PLUS IS NOT NULL AND DH1_CLOSE.ADX_MINUS IS NOT NULL AND DH1_CLOSE.RSI IS NOT NULL AND DH1_CLOSE.BOLLINGER_UPPER IS NOT NULL AND DH1_CLOSE.BOLLINGER_LOWER IS NOT NULL AND DH1_CLOSE.MOMENTUM IS NOT NULL AND DH1_CLOSE.ICHIMOKUTENKANSEN IS NOT NULL AND DH1_CLOSE.ICHIMOKUKIJUNSEN IS NOT NULL AND DH1_CLOSE.ICHIMOKUSENKOUSPANA IS NOT NULL AND DH1_CLOSE.ICHIMOKUSENKOUSPANB IS NOT NULL AND DH1_CLOSE.ICHIMOKUCHINKOUSPAN IS NOT NULL AND IND.ID='1329927210938.2964' AND DH1_OPEN.FECHA=TO_DATE('2008/07/14 00:27','YYYY/MM/DD HH24:MI') AND DH1_CLOSE.FECHA=TO_DATE('2008/07/14 00:29','YYYY/MM/DD HH24:MI') ;
SELECT IND.ID, DH1_OPEN.FECHA OPEN_FECHA, MIN(DH1_CLOSE.FECHA) CLOSE_FECHA FROM DATOHISTORICO DH1_OPEN, DATOHISTORICO DH1_CLOSE, INDIVIDUO IND, INDICADOR_INDIVIDUO II_OPEN_MA, INDICADOR_INDIVIDUO II_CLOSE_MA, INDICADOR_INDIVIDUO II_OPEN_MACD, INDICADOR_INDIVIDUO II_CLOSE_MACD, INDICADOR_INDIVIDUO II_OPEN_COMPARE, INDICADOR_INDIVIDUO II_CLOSE_COMPARE, INDICADOR_INDIVIDUO II_OPEN_SAR, INDICADOR_INDIVIDUO II_CLOSE_SAR, INDICADOR_INDIVIDUO II_OPEN_ADX, INDICADOR_INDIVIDUO II_CLOSE_ADX, INDICADOR_INDIVIDUO II_OPEN_RSI, INDICADOR_INDIVIDUO II_CLOSE_RSI, INDICADOR_INDIVIDUO II_OPEN_BOLLINGER, INDICADOR_INDIVIDUO II_CLOSE_BOLLINGER, INDICADOR_INDIVIDUO II_OPEN_MOMENTUM, INDICADOR_INDIVIDUO II_CLOSE_MOMENTUM, INDICADOR_INDIVIDUO II_OPEN_ICHITREND, INDICADOR_INDIVIDUO II_CLOSE_ICHITREND, INDICADOR_INDIVIDUO II_OPEN_ICHISIGNAL, INDICADOR_INDIVIDUO II_CLOSE_ICHISIGNAL WHERE IND.ID=II_OPEN_MA.ID_INDIVIDUO AND IND.ID=II_CLOSE_MA.ID_INDIVIDUO AND IND.ID=II_OPEN_MACD.ID_INDIVIDUO AND IND.ID=II_CLOSE_MACD.ID_INDIVIDUO AND IND.ID=II_OPEN_COMPARE.ID_INDIVIDUO AND IND.ID=II_CLOSE_COMPARE.ID_INDIVIDUO AND IND.ID=II_OPEN_SAR.ID_INDIVIDUO AND IND.ID=II_CLOSE_SAR.ID_INDIVIDUO AND IND.ID=II_OPEN_ADX.ID_INDIVIDUO AND IND.ID=II_CLOSE_ADX.ID_INDIVIDUO AND IND.ID=II_OPEN_RSI.ID_INDIVIDUO AND IND.ID=II_CLOSE_RSI.ID_INDIVIDUO AND IND.ID=II_OPEN_BOLLINGER.ID_INDIVIDUO AND IND.ID=II_CLOSE_BOLLINGER.ID_INDIVIDUO AND IND.ID=II_OPEN_MOMENTUM.ID_INDIVIDUO AND IND.ID=II_CLOSE_MOMENTUM.ID_INDIVIDUO AND IND.ID=II_OPEN_ICHITREND.ID_INDIVIDUO AND IND.ID=II_CLOSE_ICHITREND.ID_INDIVIDUO AND IND.ID=II_OPEN_ICHISIGNAL.ID_INDIVIDUO AND IND.ID=II_CLOSE_ICHISIGNAL.ID_INDIVIDUO AND II_OPEN_MA.TIPO='OPEN' AND II_OPEN_MA.ID_INDICADOR='MA' AND II_OPEN_MACD.TIPO='OPEN' AND II_OPEN_MACD.ID_INDICADOR='MACD' AND II_OPEN_COMPARE.TIPO='OPEN' AND II_OPEN_COMPARE.ID_INDICADOR='COMPARE_MA' AND II_OPEN_SAR.TIPO='OPEN' AND II_OPEN_SAR.ID_INDICADOR='SAR' AND II_OPEN_ADX.TIPO='OPEN' AND II_OPEN_ADX.ID_INDICADOR='ADX' AND II_OPEN_RSI.TIPO='OPEN' AND II_OPEN_RSI.ID_INDICADOR='RSI' AND II_OPEN_BOLLINGER.TIPO='OPEN' AND II_OPEN_BOLLINGER.ID_INDICADOR='BOLLINGER' AND II_OPEN_MOMENTUM.TIPO='OPEN' AND II_OPEN_MOMENTUM.ID_INDICADOR='MOMENTUM' AND II_OPEN_ICHITREND.TIPO='OPEN' AND II_OPEN_ICHITREND.ID_INDICADOR='ICHIMOKU_TREND' AND II_OPEN_ICHISIGNAL.TIPO='OPEN' AND II_OPEN_ICHISIGNAL.ID_INDICADOR='ICHIMOKU_SIGNAL' AND II_CLOSE_MA.TIPO='CLOSE' AND II_CLOSE_MA.ID_INDICADOR='MA' AND II_CLOSE_MACD.TIPO='CLOSE' AND II_CLOSE_MACD.ID_INDICADOR='MACD' AND II_CLOSE_COMPARE.TIPO='CLOSE' AND II_CLOSE_COMPARE.ID_INDICADOR='COMPARE_MA' AND II_CLOSE_SAR.TIPO='CLOSE' AND II_CLOSE_SAR.ID_INDICADOR='SAR' AND II_CLOSE_ADX.TIPO='CLOSE' AND II_CLOSE_ADX.ID_INDICADOR='ADX' AND II_CLOSE_RSI.TIPO='CLOSE' AND II_CLOSE_RSI.ID_INDICADOR='RSI' AND II_CLOSE_BOLLINGER.TIPO='CLOSE' AND II_CLOSE_BOLLINGER.ID_INDICADOR='BOLLINGER' AND II_CLOSE_MOMENTUM.TIPO='CLOSE' AND II_CLOSE_MOMENTUM.ID_INDICADOR='MOMENTUM' AND II_CLOSE_ICHITREND.TIPO='CLOSE' AND II_CLOSE_ICHITREND.ID_INDICADOR='ICHIMOKU_TREND' AND II_CLOSE_ICHISIGNAL.TIPO='CLOSE' AND II_CLOSE_ICHISIGNAL.ID_INDICADOR='ICHIMOKU_SIGNAL' AND (PROCESS_OPEN_PRICE_DEPENDENT(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR, DH1_OPEN.AVERAGE,DH1_OPEN.FECHA)>0) AND (PROCESS_OPEN(II_OPEN_MACD.INTERVALO_INFERIOR, II_OPEN_MACD.INTERVALO_SUPERIOR, DH1_OPEN.MACD_VALUE, DH1_OPEN.MACD_SIGNAL)>0) AND (PROCESS_OPEN(II_OPEN_COMPARE.INTERVALO_INFERIOR, II_OPEN_COMPARE.INTERVALO_SUPERIOR, DH1_OPEN.AVERAGE_COMPARE-DH1_OPEN.COMPARE_VALUE,0)>0) AND (PROCESS_OPEN_PRICE_DEPENDENT(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR, DH1_OPEN.SAR,DH1_OPEN.FECHA)>0) AND (PROCESS_OPEN(II_OPEN_ADX.INTERVALO_INFERIOR, II_OPEN_ADX.INTERVALO_SUPERIOR, DH1_OPEN.ADX_VALUE*DH1_OPEN.ADX_PLUS, DH1_OPEN.ADX_VALUE*DH1_OPEN.ADX_MINUS)>0) AND (PROCESS_OPEN(II_OPEN_RSI.INTERVALO_INFERIOR, II_OPEN_RSI.INTERVALO_SUPERIOR, DH1_OPEN.RSI, 0)>0) AND (PROCESS_OPEN(II_OPEN_BOLLINGER.INTERVALO_INFERIOR, II_OPEN_BOLLINGER.INTERVALO_SUPERIOR, DH1_OPEN.BOLLINGER_UPPER, DH1_OPEN.BOLLINGER_LOWER)>0) AND (PROCESS_OPEN(II_OPEN_MOMENTUM.INTERVALO_INFERIOR, II_OPEN_MOMENTUM.INTERVALO_SUPERIOR, DH1_OPEN.MOMENTUM, 0)>0) AND (PROCESS_OPEN_PRICE_DEPENDENT(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB,DH1_OPEN.FECHA)>0) AND (PROCESS_OPEN(II_OPEN_ICHISIGNAL.INTERVALO_INFERIOR, II_OPEN_ICHISIGNAL.INTERVALO_SUPERIOR, DH1_OPEN.ICHIMOKUCHINKOUSPAN*DH1_OPEN.ICHIMOKUTENKANSEN, DH1_OPEN.ICHIMOKUCHINKOUSPAN*DH1_OPEN.ICHIMOKUKIJUNSEN)>0) AND ((DH1_CLOSE.FECHA = (SELECT MAX(FECHA) FROM DATOHISTORICO)) OR (PROCESS_CLOSE_PIPS(CALCULAR_PIPS( CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA), CALCULAR_CLOSE_PRICE_TP(DH1_CLOSE.FECHA), OBTENER_SPREAD(DH1_OPEN.FECHA) ), CALCULAR_PIPS( CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA), CALCULAR_CLOSE_PRICE_SL(DH1_CLOSE.FECHA), OBTENER_SPREAD(DH1_OPEN.FECHA) ), IND.TAKE_PROFIT, IND.STOP_LOSS)>0) OR( /* (II_CLOSE_MA.INTERVALO_INFERIOR IS NOT NULL OR II_CLOSE_MACD.INTERVALO_INFERIOR IS NOT NULL II_CLOSE_COMPARE.INTERVALO_INFERIOR IS NOT NULL OR II_CLOSE_SAR.INTERVALO_INFERIOR IS NOT NULL OR II_CLOSE_ADX.INTERVALO_INFERIOR IS NOT NULL OR II_CLOSE_RSI.INTERVALO_INFERIOR IS NOT NULL OR II_CLOSE_BOLLINGER.INTERVALO_INFERIOR IS NOT NULL OR II_CLOSE_MOMENTUM.INTERVALO_INFERIOR IS NOT NULL OR II_CLOSE_ICHITREND.INTERVALO_INFERIOR IS NOT NULL OR II_CLOSE_ICHISIGNAL.INTERVALO_INFERIOR IS NOT NULL) AND*/ (PROCESS_CLOSE_PRICE_DEPENDENT(II_CLOSE_MA.INTERVALO_INFERIOR, II_CLOSE_MA.INTERVALO_SUPERIOR, DH1_CLOSE.AVERAGE, DH1_CLOSE.FECHA)>0) AND (PROCESS_CLOSE(II_CLOSE_MACD.INTERVALO_INFERIOR, II_CLOSE_MACD.INTERVALO_SUPERIOR, DH1_CLOSE.MACD_VALUE, DH1_CLOSE.MACD_SIGNAL)>0) AND (PROCESS_CLOSE(II_CLOSE_COMPARE.INTERVALO_INFERIOR, II_CLOSE_COMPARE.INTERVALO_SUPERIOR, DH1_CLOSE.AVERAGE_COMPARE-DH1_CLOSE.COMPARE_VALUE,0)>0) AND (PROCESS_CLOSE_PRICE_DEPENDENT(II_CLOSE_SAR.INTERVALO_INFERIOR, II_CLOSE_SAR.INTERVALO_SUPERIOR, DH1_CLOSE.SAR, DH1_CLOSE.FECHA)>0) AND (PROCESS_CLOSE(II_CLOSE_ADX.INTERVALO_INFERIOR, II_CLOSE_ADX.INTERVALO_SUPERIOR, DH1_CLOSE.ADX_VALUE*DH1_CLOSE.ADX_PLUS, DH1_CLOSE.ADX_VALUE*DH1_CLOSE.ADX_MINUS)>0) AND (PROCESS_CLOSE(II_CLOSE_RSI.INTERVALO_INFERIOR, II_CLOSE_RSI.INTERVALO_SUPERIOR, DH1_CLOSE.RSI, 0)>0) AND (PROCESS_CLOSE(II_CLOSE_BOLLINGER.INTERVALO_INFERIOR, II_CLOSE_BOLLINGER.INTERVALO_SUPERIOR, DH1_CLOSE.BOLLINGER_UPPER, DH1_CLOSE.BOLLINGER_LOWER)>0) AND (PROCESS_CLOSE(II_CLOSE_MOMENTUM.INTERVALO_INFERIOR, II_CLOSE_MOMENTUM.INTERVALO_SUPERIOR, DH1_CLOSE.MOMENTUM, 0)>0) AND (PROCESS_CLOSE_PRICE_DEPENDENT(II_CLOSE_ICHITREND.INTERVALO_INFERIOR, II_CLOSE_ICHITREND.INTERVALO_SUPERIOR, DH1_CLOSE.ICHIMOKUSENKOUSPANA-DH1_CLOSE.ICHIMOKUSENKOUSPANB, DH1_CLOSE.FECHA)>0) AND (PROCESS_CLOSE(II_CLOSE_ICHISIGNAL.INTERVALO_INFERIOR, II_CLOSE_ICHISIGNAL.INTERVALO_SUPERIOR, DH1_CLOSE.ICHIMOKUCHINKOUSPAN*DH1_CLOSE.ICHIMOKUTENKANSEN, DH1_CLOSE.ICHIMOKUCHINKOUSPAN*DH1_CLOSE.ICHIMOKUKIJUNSEN)>0) )) AND DH1_CLOSE.FECHA > DH1_OPEN.FECHA AND (DH1_OPEN.FECHA < (SELECT MAX(FECHA) FROM DATOHISTORICO)) AND DH1_CLOSE.FECHA < (DH1_OPEN.FECHA+30) AND DH1_OPEN.AVERAGE IS NOT NULL AND DH1_OPEN.MACD_VALUE IS NOT NULL AND DH1_OPEN.MACD_SIGNAL IS NOT NULL AND DH1_OPEN.COMPARE_VALUE IS NOT NULL AND DH1_OPEN.AVERAGE_COMPARE IS NOT NULL AND DH1_OPEN.SAR IS NOT NULL AND DH1_OPEN.ADX_VALUE IS NOT NULL AND DH1_OPEN.ADX_PLUS IS NOT NULL AND DH1_OPEN.ADX_MINUS IS NOT NULL AND DH1_OPEN.RSI IS NOT NULL AND DH1_OPEN.BOLLINGER_UPPER IS NOT NULL AND DH1_OPEN.BOLLINGER_LOWER IS NOT NULL AND DH1_OPEN.MOMENTUM IS NOT NULL AND DH1_OPEN.ICHIMOKUTENKANSEN IS NOT NULL AND DH1_OPEN.ICHIMOKUKIJUNSEN IS NOT NULL AND DH1_OPEN.ICHIMOKUSENKOUSPANA IS NOT NULL AND DH1_OPEN.ICHIMOKUSENKOUSPANB IS NOT NULL AND DH1_OPEN.ICHIMOKUCHINKOUSPAN IS NOT NULL AND DH1_CLOSE.AVERAGE IS NOT NULL AND DH1_CLOSE.MACD_VALUE IS NOT NULL AND DH1_CLOSE.MACD_SIGNAL IS NOT NULL AND DH1_CLOSE.COMPARE_VALUE IS NOT NULL AND DH1_CLOSE.AVERAGE_COMPARE IS NOT NULL AND DH1_CLOSE.SAR IS NOT NULL AND DH1_CLOSE.ADX_VALUE IS NOT NULL AND DH1_CLOSE.ADX_PLUS IS NOT NULL AND DH1_CLOSE.ADX_MINUS IS NOT NULL AND DH1_CLOSE.RSI IS NOT NULL AND DH1_CLOSE.BOLLINGER_UPPER IS NOT NULL AND DH1_CLOSE.BOLLINGER_LOWER IS NOT NULL AND DH1_CLOSE.MOMENTUM IS NOT NULL AND DH1_CLOSE.ICHIMOKUTENKANSEN IS NOT NULL AND DH1_CLOSE.ICHIMOKUKIJUNSEN IS NOT NULL AND DH1_CLOSE.ICHIMOKUSENKOUSPANA IS NOT NULL AND DH1_CLOSE.ICHIMOKUSENKOUSPANB IS NOT NULL AND DH1_CLOSE.ICHIMOKUCHINKOUSPAN IS NOT NULL AND IND.ID='1329927210938.2964' AND DH1_OPEN.FECHA=TO_DATE('2008/07/14 00:27','YYYY/MM/DD HH24:MI') AND DH1_CLOSE.FECHA=TO_DATE('2008/07/14 00:29','YYYY/MM/DD HH24:MI') GROUP BY IND.ID, DH1_OPEN.FECHA;
SELECT IND.ID ID_INDIVIDUO, IND.TAKE_PROFIT, IND.STOP_LOSS, DH1_OPEN.FECHA OPEN_FECHA, DH1_CLOSE.FECHA CLOSE_FECHA ,OBTENER_SPREAD(DH1_OPEN.FECHA) SPREAD ,CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA) OPEN_PRICE ,CALCULAR_CLOSE_PRICE(INTERVALO(II_CLOSE_MA.INTERVALO_INFERIOR, II_CLOSE_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_CLOSE_SAR.INTERVALO_INFERIOR, II_CLOSE_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_CLOSE_ICHITREND.INTERVALO_INFERIOR, II_CLOSE_ICHITREND.INTERVALO_SUPERIOR) ,DH1_CLOSE.AVERAGE, DH1_CLOSE.SAR, DH1_CLOSE.ICHIMOKUSENKOUSPANA-DH1_CLOSE.ICHIMOKUSENKOUSPANB, DH1_CLOSE.FECHA) CLOSE_PRICE ,CALCULAR_CLOSE_PRICE_TP(DH1_CLOSE.FECHA) CLOSE_PRICE_TP ,CALCULAR_CLOSE_PRICE_SL(DH1_CLOSE.FECHA) CLOSE_PRICE_SL ,CALCULAR_PIPS( CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA), CALCULAR_CLOSE_PRICE(INTERVALO(II_CLOSE_MA.INTERVALO_INFERIOR, II_CLOSE_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_CLOSE_SAR.INTERVALO_INFERIOR, II_CLOSE_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_CLOSE_ICHITREND.INTERVALO_INFERIOR, II_CLOSE_ICHITREND.INTERVALO_SUPERIOR) ,DH1_CLOSE.AVERAGE, DH1_CLOSE.SAR, DH1_CLOSE.ICHIMOKUSENKOUSPANA-DH1_CLOSE.ICHIMOKUSENKOUSPANB, DH1_CLOSE.FECHA), OBTENER_SPREAD(DH1_OPEN.FECHA)) PIPS ,CALCULAR_PIPS(CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA), CALCULAR_CLOSE_PRICE_TP(DH1_CLOSE.FECHA), OBTENER_SPREAD(DH1_OPEN.FECHA)) PIPS_TP ,CALCULAR_PIPS(CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA), CALCULAR_CLOSE_PRICE_SL(DH1_CLOSE.FECHA), OBTENER_SPREAD(DH1_OPEN.FECHA)) PIPS_SL ,PROCESS_OPEN_PRICE_DEPENDENT(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR, DH1_OPEN.AVERAGE, DH1_OPEN.FECHA) OPEN_MA ,PROCESS_OPEN(II_OPEN_MACD.INTERVALO_INFERIOR, II_OPEN_MACD.INTERVALO_SUPERIOR, DH1_OPEN.MACD_VALUE, DH1_OPEN.MACD_SIGNAL) OPEN_MACD ,PROCESS_OPEN(II_OPEN_COMPARE.INTERVALO_INFERIOR, II_OPEN_COMPARE.INTERVALO_SUPERIOR, DH1_OPEN.AVERAGE_COMPARE-DH1_OPEN.COMPARE_VALUE,0) OPEN_COMPARE ,PROCESS_OPEN_PRICE_DEPENDENT(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR, DH1_OPEN.SAR, DH1_OPEN.FECHA) OPEN_SAR ,PROCESS_OPEN(II_OPEN_ADX.INTERVALO_INFERIOR, II_OPEN_ADX.INTERVALO_SUPERIOR, DH1_OPEN.ADX_VALUE*DH1_OPEN.ADX_PLUS, DH1_OPEN.ADX_VALUE*DH1_OPEN.ADX_MINUS) OPEN_ADX ,PROCESS_OPEN(II_OPEN_RSI.INTERVALO_INFERIOR, II_OPEN_RSI.INTERVALO_SUPERIOR, DH1_OPEN.RSI, 0) OPEN_RSI ,PROCESS_OPEN(II_OPEN_BOLLINGER.INTERVALO_INFERIOR, II_OPEN_BOLLINGER.INTERVALO_SUPERIOR, DH1_OPEN.BOLLINGER_UPPER, DH1_OPEN.BOLLINGER_LOWER) OPEN_BOLLINGER ,PROCESS_OPEN(II_OPEN_MOMENTUM.INTERVALO_INFERIOR, II_OPEN_MOMENTUM.INTERVALO_SUPERIOR, DH1_OPEN.MOMENTUM, 0) OPEN_MOMENTUM ,PROCESS_OPEN_PRICE_DEPENDENT(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA) OPEN_ICHITREND ,PROCESS_OPEN(II_OPEN_ICHISIGNAL.INTERVALO_INFERIOR, II_OPEN_ICHISIGNAL.INTERVALO_SUPERIOR, DH1_OPEN.ICHIMOKUCHINKOUSPAN*DH1_OPEN.ICHIMOKUTENKANSEN, DH1_OPEN.ICHIMOKUCHINKOUSPAN*DH1_OPEN.ICHIMOKUKIJUNSEN) OPEN_ICHISIGNAL ,PROCESS_CLOSE_PIPS(CALCULAR_PIPS( CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA), CALCULAR_CLOSE_PRICE_TP(DH1_CLOSE.FECHA), OBTENER_SPREAD(DH1_OPEN.FECHA) ), CALCULAR_PIPS( CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA), CALCULAR_CLOSE_PRICE_SL(DH1_CLOSE.FECHA), OBTENER_SPREAD(DH1_OPEN.FECHA) ), IND.TAKE_PROFIT, IND.STOP_LOSS) CLOSE_BY_PIPS ,(NVL(II_CLOSE_MA.INTERVALO_INFERIOR,0)) BB /*II_CLOSE_COMPARE.INTERVALO_INFERIOR IS NOT NULL OR II_CLOSE_SAR.INTERVALO_INFERIOR IS NOT NULL OR II_CLOSE_ADX.INTERVALO_INFERIOR IS NOT NULL OR II_CLOSE_RSI.INTERVALO_INFERIOR IS NOT NULL OR II_CLOSE_BOLLINGER.INTERVALO_INFERIOR IS NOT NULL OR II_CLOSE_MOMENTUM.INTERVALO_INFERIOR IS NOT NULL OR II_CLOSE_ICHITREND.INTERVALO_INFERIOR IS NOT NULL OR II_CLOSE_ICHISIGNAL.INTERVALO_INFERIOR IS NOT NULL) ANY_CLOSE_NOT_NULL*/ ,PROCESS_CLOSE_PRICE_DEPENDENT(II_CLOSE_MA.INTERVALO_INFERIOR, II_CLOSE_MA.INTERVALO_SUPERIOR, DH1_CLOSE.AVERAGE, DH1_CLOSE.FECHA) CLOSE_MA ,PROCESS_CLOSE(II_CLOSE_MACD.INTERVALO_INFERIOR, II_CLOSE_MACD.INTERVALO_SUPERIOR, DH1_CLOSE.MACD_VALUE, DH1_CLOSE.MACD_SIGNAL) CLOSE_MACD ,PROCESS_CLOSE(II_CLOSE_COMPARE.INTERVALO_INFERIOR, II_CLOSE_COMPARE.INTERVALO_SUPERIOR, DH1_CLOSE.AVERAGE_COMPARE-DH1_CLOSE.COMPARE_VALUE,0) CLOSE_COMPARE ,PROCESS_CLOSE_PRICE_DEPENDENT(II_CLOSE_SAR.INTERVALO_INFERIOR, II_CLOSE_SAR.INTERVALO_SUPERIOR, DH1_CLOSE.SAR, DH1_CLOSE.FECHA) CLOSE_SAR ,PROCESS_CLOSE(II_CLOSE_ADX.INTERVALO_INFERIOR, II_CLOSE_ADX.INTERVALO_SUPERIOR, DH1_CLOSE.ADX_VALUE*DH1_CLOSE.ADX_PLUS, DH1_CLOSE.ADX_VALUE*DH1_CLOSE.ADX_MINUS) CLOSE_ADX ,PROCESS_CLOSE(II_CLOSE_RSI.INTERVALO_INFERIOR, II_CLOSE_RSI.INTERVALO_SUPERIOR, DH1_CLOSE.RSI, 0) CLOSE_RSI ,PROCESS_CLOSE(II_CLOSE_BOLLINGER.INTERVALO_INFERIOR, II_CLOSE_BOLLINGER.INTERVALO_SUPERIOR, DH1_CLOSE.BOLLINGER_UPPER, DH1_CLOSE.BOLLINGER_LOWER) CLOSE_BOLLINGER ,PROCESS_CLOSE(II_CLOSE_MOMENTUM.INTERVALO_INFERIOR, II_CLOSE_MOMENTUM.INTERVALO_SUPERIOR, DH1_CLOSE.MOMENTUM, 0) CLOSE_MOMENTUM ,PROCESS_CLOSE_PRICE_DEPENDENT(II_CLOSE_ICHITREND.INTERVALO_INFERIOR, II_CLOSE_ICHITREND.INTERVALO_SUPERIOR, DH1_CLOSE.ICHIMOKUSENKOUSPANA-DH1_CLOSE.ICHIMOKUSENKOUSPANB, DH1_CLOSE.FECHA) CLOSE_ICHITREND ,PROCESS_CLOSE(II_CLOSE_ICHISIGNAL.INTERVALO_INFERIOR, II_CLOSE_ICHISIGNAL.INTERVALO_SUPERIOR, DH1_CLOSE.ICHIMOKUCHINKOUSPAN*DH1_CLOSE.ICHIMOKUTENKANSEN, DH1_CLOSE.ICHIMOKUCHINKOUSPAN*DH1_CLOSE.ICHIMOKUKIJUNSEN) CLOSE_ICHISIGNAL FROM DATOHISTORICO DH1_OPEN, DATOHISTORICO DH1_CLOSE, INDIVIDUO IND, INDICADOR_INDIVIDUO II_OPEN_MA, INDICADOR_INDIVIDUO II_CLOSE_MA, INDICADOR_INDIVIDUO II_OPEN_MACD, INDICADOR_INDIVIDUO II_CLOSE_MACD, INDICADOR_INDIVIDUO II_OPEN_COMPARE, INDICADOR_INDIVIDUO II_CLOSE_COMPARE, INDICADOR_INDIVIDUO II_OPEN_SAR, INDICADOR_INDIVIDUO II_CLOSE_SAR, INDICADOR_INDIVIDUO II_OPEN_ADX, INDICADOR_INDIVIDUO II_CLOSE_ADX, INDICADOR_INDIVIDUO II_OPEN_RSI, INDICADOR_INDIVIDUO II_CLOSE_RSI, INDICADOR_INDIVIDUO II_OPEN_BOLLINGER, INDICADOR_INDIVIDUO II_CLOSE_BOLLINGER, INDICADOR_INDIVIDUO II_OPEN_MOMENTUM, INDICADOR_INDIVIDUO II_CLOSE_MOMENTUM, INDICADOR_INDIVIDUO II_OPEN_ICHITREND, INDICADOR_INDIVIDUO II_CLOSE_ICHITREND, INDICADOR_INDIVIDUO II_OPEN_ICHISIGNAL, INDICADOR_INDIVIDUO II_CLOSE_ICHISIGNAL WHERE IND.ID=II_OPEN_MA.ID_INDIVIDUO AND IND.ID=II_CLOSE_MA.ID_INDIVIDUO AND IND.ID=II_OPEN_MACD.ID_INDIVIDUO AND IND.ID=II_CLOSE_MACD.ID_INDIVIDUO AND IND.ID=II_OPEN_COMPARE.ID_INDIVIDUO AND IND.ID=II_CLOSE_COMPARE.ID_INDIVIDUO AND IND.ID=II_OPEN_SAR.ID_INDIVIDUO AND IND.ID=II_CLOSE_SAR.ID_INDIVIDUO AND IND.ID=II_OPEN_ADX.ID_INDIVIDUO AND IND.ID=II_CLOSE_ADX.ID_INDIVIDUO AND IND.ID=II_OPEN_RSI.ID_INDIVIDUO AND IND.ID=II_CLOSE_RSI.ID_INDIVIDUO AND IND.ID=II_OPEN_BOLLINGER.ID_INDIVIDUO AND IND.ID=II_CLOSE_BOLLINGER.ID_INDIVIDUO AND IND.ID=II_OPEN_MOMENTUM.ID_INDIVIDUO AND IND.ID=II_CLOSE_MOMENTUM.ID_INDIVIDUO AND IND.ID=II_OPEN_ICHITREND.ID_INDIVIDUO AND IND.ID=II_CLOSE_ICHITREND.ID_INDIVIDUO AND IND.ID=II_OPEN_ICHISIGNAL.ID_INDIVIDUO AND IND.ID=II_CLOSE_ICHISIGNAL.ID_INDIVIDUO AND II_OPEN_MA.TIPO='OPEN' AND II_OPEN_MA.ID_INDICADOR='MA' AND II_OPEN_MACD.TIPO='OPEN' AND II_OPEN_MACD.ID_INDICADOR='MACD' AND II_OPEN_COMPARE.TIPO='OPEN' AND II_OPEN_COMPARE.ID_INDICADOR='COMPARE_MA' AND II_OPEN_SAR.TIPO='OPEN' AND II_OPEN_SAR.ID_INDICADOR='SAR' AND II_OPEN_ADX.TIPO='OPEN' AND II_OPEN_ADX.ID_INDICADOR='ADX' AND II_OPEN_RSI.TIPO='OPEN' AND II_OPEN_RSI.ID_INDICADOR='RSI' AND II_OPEN_BOLLINGER.TIPO='OPEN' AND II_OPEN_BOLLINGER.ID_INDICADOR='BOLLINGER' AND II_OPEN_MOMENTUM.TIPO='OPEN' AND II_OPEN_MOMENTUM.ID_INDICADOR='MOMENTUM' AND II_OPEN_ICHITREND.TIPO='OPEN' AND II_OPEN_ICHITREND.ID_INDICADOR='ICHIMOKU_TREND' AND II_OPEN_ICHISIGNAL.TIPO='OPEN' AND II_OPEN_ICHISIGNAL.ID_INDICADOR='ICHIMOKU_SIGNAL' AND II_CLOSE_MA.TIPO='CLOSE' AND II_CLOSE_MA.ID_INDICADOR='MA' AND II_CLOSE_MACD.TIPO='CLOSE' AND II_CLOSE_MACD.ID_INDICADOR='MACD' AND II_CLOSE_COMPARE.TIPO='CLOSE' AND II_CLOSE_COMPARE.ID_INDICADOR='COMPARE_MA' AND II_CLOSE_SAR.TIPO='CLOSE' AND II_CLOSE_SAR.ID_INDICADOR='SAR' AND II_CLOSE_ADX.TIPO='CLOSE' AND II_CLOSE_ADX.ID_INDICADOR='ADX' AND II_CLOSE_RSI.TIPO='CLOSE' AND II_CLOSE_RSI.ID_INDICADOR='RSI' AND II_CLOSE_BOLLINGER.TIPO='CLOSE' AND II_CLOSE_BOLLINGER.ID_INDICADOR='BOLLINGER' AND II_CLOSE_MOMENTUM.TIPO='CLOSE' AND II_CLOSE_MOMENTUM.ID_INDICADOR='MOMENTUM' AND II_CLOSE_ICHITREND.TIPO='CLOSE' AND II_CLOSE_ICHITREND.ID_INDICADOR='ICHIMOKU_TREND' AND II_CLOSE_ICHISIGNAL.TIPO='CLOSE' AND II_CLOSE_ICHISIGNAL.ID_INDICADOR='ICHIMOKU_SIGNAL' AND DH1_OPEN.AVERAGE IS NOT NULL AND DH1_OPEN.MACD_VALUE IS NOT NULL AND DH1_OPEN.MACD_SIGNAL IS NOT NULL AND DH1_OPEN.COMPARE_VALUE IS NOT NULL AND DH1_OPEN.AVERAGE_COMPARE IS NOT NULL AND DH1_OPEN.SAR IS NOT NULL AND DH1_OPEN.ADX_VALUE IS NOT NULL AND DH1_OPEN.ADX_PLUS IS NOT NULL AND DH1_OPEN.ADX_MINUS IS NOT NULL AND DH1_OPEN.RSI IS NOT NULL AND DH1_OPEN.BOLLINGER_UPPER IS NOT NULL AND DH1_OPEN.BOLLINGER_LOWER IS NOT NULL AND DH1_OPEN.MOMENTUM IS NOT NULL AND DH1_OPEN.ICHIMOKUTENKANSEN IS NOT NULL AND DH1_OPEN.ICHIMOKUKIJUNSEN IS NOT NULL AND DH1_OPEN.ICHIMOKUSENKOUSPANA IS NOT NULL AND DH1_OPEN.ICHIMOKUSENKOUSPANB IS NOT NULL AND DH1_OPEN.ICHIMOKUCHINKOUSPAN IS NOT NULL AND DH1_CLOSE.AVERAGE IS NOT NULL AND DH1_CLOSE.MACD_VALUE IS NOT NULL AND DH1_CLOSE.MACD_SIGNAL IS NOT NULL AND DH1_CLOSE.COMPARE_VALUE IS NOT NULL AND DH1_CLOSE.AVERAGE_COMPARE IS NOT NULL AND DH1_CLOSE.SAR IS NOT NULL AND DH1_CLOSE.ADX_VALUE IS NOT NULL AND DH1_CLOSE.ADX_PLUS IS NOT NULL AND DH1_CLOSE.ADX_MINUS IS NOT NULL AND DH1_CLOSE.RSI IS NOT NULL AND DH1_CLOSE.BOLLINGER_UPPER IS NOT NULL AND DH1_CLOSE.BOLLINGER_LOWER IS NOT NULL AND DH1_CLOSE.MOMENTUM IS NOT NULL AND DH1_CLOSE.ICHIMOKUTENKANSEN IS NOT NULL AND DH1_CLOSE.ICHIMOKUKIJUNSEN IS NOT NULL AND DH1_CLOSE.ICHIMOKUSENKOUSPANA IS NOT NULL AND DH1_CLOSE.ICHIMOKUSENKOUSPANB IS NOT NULL AND DH1_CLOSE.ICHIMOKUCHINKOUSPAN IS NOT NULL AND IND.ID='1329927210938.2964' AND DH1_OPEN.FECHA=TO_DATE('2008/07/14 00:27','YYYY/MM/DD HH24:MI') AND DH1_CLOSE.FECHA=TO_DATE('2008/07/14 00:29','YYYY/MM/DD HH24:MI') ;
SELECT IND.ID ID_INDIVIDUO, IND.TAKE_PROFIT, IND.STOP_LOSS, DH1_OPEN.FECHA OPEN_FECHA, DH1_CLOSE.FECHA CLOSE_FECHA ,OBTENER_SPREAD(DH1_OPEN.FECHA) SPREAD ,CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA) OPEN_PRICE ,CALCULAR_CLOSE_PRICE(INTERVALO(II_CLOSE_MA.INTERVALO_INFERIOR, II_CLOSE_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_CLOSE_SAR.INTERVALO_INFERIOR, II_CLOSE_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_CLOSE_ICHITREND.INTERVALO_INFERIOR, II_CLOSE_ICHITREND.INTERVALO_SUPERIOR) ,DH1_CLOSE.AVERAGE, DH1_CLOSE.SAR, DH1_CLOSE.ICHIMOKUSENKOUSPANA-DH1_CLOSE.ICHIMOKUSENKOUSPANB, DH1_CLOSE.FECHA) CLOSE_PRICE ,CALCULAR_CLOSE_PRICE_TP(DH1_CLOSE.FECHA) CLOSE_PRICE_TP ,CALCULAR_CLOSE_PRICE_SL(DH1_CLOSE.FECHA) CLOSE_PRICE_SL ,CALCULAR_PIPS( CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA), CALCULAR_CLOSE_PRICE(INTERVALO(II_CLOSE_MA.INTERVALO_INFERIOR, II_CLOSE_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_CLOSE_SAR.INTERVALO_INFERIOR, II_CLOSE_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_CLOSE_ICHITREND.INTERVALO_INFERIOR, II_CLOSE_ICHITREND.INTERVALO_SUPERIOR) ,DH1_CLOSE.AVERAGE, DH1_CLOSE.SAR, DH1_CLOSE.ICHIMOKUSENKOUSPANA-DH1_CLOSE.ICHIMOKUSENKOUSPANB, DH1_CLOSE.FECHA), OBTENER_SPREAD(DH1_OPEN.FECHA)) PIPS ,CALCULAR_PIPS(CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA), CALCULAR_CLOSE_PRICE_TP(DH1_CLOSE.FECHA), OBTENER_SPREAD(DH1_OPEN.FECHA)) PIPS_TP ,CALCULAR_PIPS(CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA), CALCULAR_CLOSE_PRICE_SL(DH1_CLOSE.FECHA), OBTENER_SPREAD(DH1_OPEN.FECHA)) PIPS_SL ,PROCESS_OPEN_PRICE_DEPENDENT(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR, DH1_OPEN.AVERAGE, DH1_OPEN.FECHA) OPEN_MA ,PROCESS_OPEN(II_OPEN_MACD.INTERVALO_INFERIOR, II_OPEN_MACD.INTERVALO_SUPERIOR, DH1_OPEN.MACD_VALUE, DH1_OPEN.MACD_SIGNAL) OPEN_MACD ,PROCESS_OPEN(II_OPEN_COMPARE.INTERVALO_INFERIOR, II_OPEN_COMPARE.INTERVALO_SUPERIOR, DH1_OPEN.AVERAGE_COMPARE-DH1_OPEN.COMPARE_VALUE,0) OPEN_COMPARE ,PROCESS_OPEN_PRICE_DEPENDENT(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR, DH1_OPEN.SAR, DH1_OPEN.FECHA) OPEN_SAR ,PROCESS_OPEN(II_OPEN_ADX.INTERVALO_INFERIOR, II_OPEN_ADX.INTERVALO_SUPERIOR, DH1_OPEN.ADX_VALUE*DH1_OPEN.ADX_PLUS, DH1_OPEN.ADX_VALUE*DH1_OPEN.ADX_MINUS) OPEN_ADX ,PROCESS_OPEN(II_OPEN_RSI.INTERVALO_INFERIOR, II_OPEN_RSI.INTERVALO_SUPERIOR, DH1_OPEN.RSI, 0) OPEN_RSI ,PROCESS_OPEN(II_OPEN_BOLLINGER.INTERVALO_INFERIOR, II_OPEN_BOLLINGER.INTERVALO_SUPERIOR, DH1_OPEN.BOLLINGER_UPPER, DH1_OPEN.BOLLINGER_LOWER) OPEN_BOLLINGER ,PROCESS_OPEN(II_OPEN_MOMENTUM.INTERVALO_INFERIOR, II_OPEN_MOMENTUM.INTERVALO_SUPERIOR, DH1_OPEN.MOMENTUM, 0) OPEN_MOMENTUM ,PROCESS_OPEN_PRICE_DEPENDENT(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA) OPEN_ICHITREND ,PROCESS_OPEN(II_OPEN_ICHISIGNAL.INTERVALO_INFERIOR, II_OPEN_ICHISIGNAL.INTERVALO_SUPERIOR, DH1_OPEN.ICHIMOKUCHINKOUSPAN*DH1_OPEN.ICHIMOKUTENKANSEN, DH1_OPEN.ICHIMOKUCHINKOUSPAN*DH1_OPEN.ICHIMOKUKIJUNSEN) OPEN_ICHISIGNAL ,PROCESS_CLOSE_PIPS(CALCULAR_PIPS( CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA), CALCULAR_CLOSE_PRICE_TP(DH1_CLOSE.FECHA), OBTENER_SPREAD(DH1_OPEN.FECHA) ), CALCULAR_PIPS( CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA), CALCULAR_CLOSE_PRICE_SL(DH1_CLOSE.FECHA), OBTENER_SPREAD(DH1_OPEN.FECHA) ), IND.TAKE_PROFIT, IND.STOP_LOSS) CLOSE_BY_PIPS ,(II_CLOSE_MA.INTERVALO_INFERIOR) B --,(II_CLOSE_MA.INTERVALO_INFERIOR IS NOT NULL OR II_CLOSE_MACD.INTERVALO_INFERIOR IS NOT NULL /*II_CLOSE_COMPARE.INTERVALO_INFERIOR IS NOT NULL OR II_CLOSE_SAR.INTERVALO_INFERIOR IS NOT NULL OR II_CLOSE_ADX.INTERVALO_INFERIOR IS NOT NULL OR II_CLOSE_RSI.INTERVALO_INFERIOR IS NOT NULL OR II_CLOSE_BOLLINGER.INTERVALO_INFERIOR IS NOT NULL OR II_CLOSE_MOMENTUM.INTERVALO_INFERIOR IS NOT NULL OR II_CLOSE_ICHITREND.INTERVALO_INFERIOR IS NOT NULL OR II_CLOSE_ICHISIGNAL.INTERVALO_INFERIOR IS NOT NULL) ANY_CLOSE_NOT_NULL*/ ,PROCESS_CLOSE_PRICE_DEPENDENT(II_CLOSE_MA.INTERVALO_INFERIOR, II_CLOSE_MA.INTERVALO_SUPERIOR, DH1_CLOSE.AVERAGE, DH1_CLOSE.FECHA) CLOSE_MA ,PROCESS_CLOSE(II_CLOSE_MACD.INTERVALO_INFERIOR, II_CLOSE_MACD.INTERVALO_SUPERIOR, DH1_CLOSE.MACD_VALUE, DH1_CLOSE.MACD_SIGNAL) CLOSE_MACD ,PROCESS_CLOSE(II_CLOSE_COMPARE.INTERVALO_INFERIOR, II_CLOSE_COMPARE.INTERVALO_SUPERIOR, DH1_CLOSE.AVERAGE_COMPARE-DH1_CLOSE.COMPARE_VALUE,0) CLOSE_COMPARE ,PROCESS_CLOSE_PRICE_DEPENDENT(II_CLOSE_SAR.INTERVALO_INFERIOR, II_CLOSE_SAR.INTERVALO_SUPERIOR, DH1_CLOSE.SAR, DH1_CLOSE.FECHA) CLOSE_SAR ,PROCESS_CLOSE(II_CLOSE_ADX.INTERVALO_INFERIOR, II_CLOSE_ADX.INTERVALO_SUPERIOR, DH1_CLOSE.ADX_VALUE*DH1_CLOSE.ADX_PLUS, DH1_CLOSE.ADX_VALUE*DH1_CLOSE.ADX_MINUS) CLOSE_ADX ,PROCESS_CLOSE(II_CLOSE_RSI.INTERVALO_INFERIOR, II_CLOSE_RSI.INTERVALO_SUPERIOR, DH1_CLOSE.RSI, 0) CLOSE_RSI ,PROCESS_CLOSE(II_CLOSE_BOLLINGER.INTERVALO_INFERIOR, II_CLOSE_BOLLINGER.INTERVALO_SUPERIOR, DH1_CLOSE.BOLLINGER_UPPER, DH1_CLOSE.BOLLINGER_LOWER) CLOSE_BOLLINGER ,PROCESS_CLOSE(II_CLOSE_MOMENTUM.INTERVALO_INFERIOR, II_CLOSE_MOMENTUM.INTERVALO_SUPERIOR, DH1_CLOSE.MOMENTUM, 0) CLOSE_MOMENTUM ,PROCESS_CLOSE_PRICE_DEPENDENT(II_CLOSE_ICHITREND.INTERVALO_INFERIOR, II_CLOSE_ICHITREND.INTERVALO_SUPERIOR, DH1_CLOSE.ICHIMOKUSENKOUSPANA-DH1_CLOSE.ICHIMOKUSENKOUSPANB, DH1_CLOSE.FECHA) CLOSE_ICHITREND ,PROCESS_CLOSE(II_CLOSE_ICHISIGNAL.INTERVALO_INFERIOR, II_CLOSE_ICHISIGNAL.INTERVALO_SUPERIOR, DH1_CLOSE.ICHIMOKUCHINKOUSPAN*DH1_CLOSE.ICHIMOKUTENKANSEN, DH1_CLOSE.ICHIMOKUCHINKOUSPAN*DH1_CLOSE.ICHIMOKUKIJUNSEN) CLOSE_ICHISIGNAL FROM DATOHISTORICO DH1_OPEN, DATOHISTORICO DH1_CLOSE, INDIVIDUO IND, INDICADOR_INDIVIDUO II_OPEN_MA, INDICADOR_INDIVIDUO II_CLOSE_MA, INDICADOR_INDIVIDUO II_OPEN_MACD, INDICADOR_INDIVIDUO II_CLOSE_MACD, INDICADOR_INDIVIDUO II_OPEN_COMPARE, INDICADOR_INDIVIDUO II_CLOSE_COMPARE, INDICADOR_INDIVIDUO II_OPEN_SAR, INDICADOR_INDIVIDUO II_CLOSE_SAR, INDICADOR_INDIVIDUO II_OPEN_ADX, INDICADOR_INDIVIDUO II_CLOSE_ADX, INDICADOR_INDIVIDUO II_OPEN_RSI, INDICADOR_INDIVIDUO II_CLOSE_RSI, INDICADOR_INDIVIDUO II_OPEN_BOLLINGER, INDICADOR_INDIVIDUO II_CLOSE_BOLLINGER, INDICADOR_INDIVIDUO II_OPEN_MOMENTUM, INDICADOR_INDIVIDUO II_CLOSE_MOMENTUM, INDICADOR_INDIVIDUO II_OPEN_ICHITREND, INDICADOR_INDIVIDUO II_CLOSE_ICHITREND, INDICADOR_INDIVIDUO II_OPEN_ICHISIGNAL, INDICADOR_INDIVIDUO II_CLOSE_ICHISIGNAL WHERE IND.ID=II_OPEN_MA.ID_INDIVIDUO AND IND.ID=II_CLOSE_MA.ID_INDIVIDUO AND IND.ID=II_OPEN_MACD.ID_INDIVIDUO AND IND.ID=II_CLOSE_MACD.ID_INDIVIDUO AND IND.ID=II_OPEN_COMPARE.ID_INDIVIDUO AND IND.ID=II_CLOSE_COMPARE.ID_INDIVIDUO AND IND.ID=II_OPEN_SAR.ID_INDIVIDUO AND IND.ID=II_CLOSE_SAR.ID_INDIVIDUO AND IND.ID=II_OPEN_ADX.ID_INDIVIDUO AND IND.ID=II_CLOSE_ADX.ID_INDIVIDUO AND IND.ID=II_OPEN_RSI.ID_INDIVIDUO AND IND.ID=II_CLOSE_RSI.ID_INDIVIDUO AND IND.ID=II_OPEN_BOLLINGER.ID_INDIVIDUO AND IND.ID=II_CLOSE_BOLLINGER.ID_INDIVIDUO AND IND.ID=II_OPEN_MOMENTUM.ID_INDIVIDUO AND IND.ID=II_CLOSE_MOMENTUM.ID_INDIVIDUO AND IND.ID=II_OPEN_ICHITREND.ID_INDIVIDUO AND IND.ID=II_CLOSE_ICHITREND.ID_INDIVIDUO AND IND.ID=II_OPEN_ICHISIGNAL.ID_INDIVIDUO AND IND.ID=II_CLOSE_ICHISIGNAL.ID_INDIVIDUO AND II_OPEN_MA.TIPO='OPEN' AND II_OPEN_MA.ID_INDICADOR='MA' AND II_OPEN_MACD.TIPO='OPEN' AND II_OPEN_MACD.ID_INDICADOR='MACD' AND II_OPEN_COMPARE.TIPO='OPEN' AND II_OPEN_COMPARE.ID_INDICADOR='COMPARE_MA' AND II_OPEN_SAR.TIPO='OPEN' AND II_OPEN_SAR.ID_INDICADOR='SAR' AND II_OPEN_ADX.TIPO='OPEN' AND II_OPEN_ADX.ID_INDICADOR='ADX' AND II_OPEN_RSI.TIPO='OPEN' AND II_OPEN_RSI.ID_INDICADOR='RSI' AND II_OPEN_BOLLINGER.TIPO='OPEN' AND II_OPEN_BOLLINGER.ID_INDICADOR='BOLLINGER' AND II_OPEN_MOMENTUM.TIPO='OPEN' AND II_OPEN_MOMENTUM.ID_INDICADOR='MOMENTUM' AND II_OPEN_ICHITREND.TIPO='OPEN' AND II_OPEN_ICHITREND.ID_INDICADOR='ICHIMOKU_TREND' AND II_OPEN_ICHISIGNAL.TIPO='OPEN' AND II_OPEN_ICHISIGNAL.ID_INDICADOR='ICHIMOKU_SIGNAL' AND II_CLOSE_MA.TIPO='CLOSE' AND II_CLOSE_MA.ID_INDICADOR='MA' AND II_CLOSE_MACD.TIPO='CLOSE' AND II_CLOSE_MACD.ID_INDICADOR='MACD' AND II_CLOSE_COMPARE.TIPO='CLOSE' AND II_CLOSE_COMPARE.ID_INDICADOR='COMPARE_MA' AND II_CLOSE_SAR.TIPO='CLOSE' AND II_CLOSE_SAR.ID_INDICADOR='SAR' AND II_CLOSE_ADX.TIPO='CLOSE' AND II_CLOSE_ADX.ID_INDICADOR='ADX' AND II_CLOSE_RSI.TIPO='CLOSE' AND II_CLOSE_RSI.ID_INDICADOR='RSI' AND II_CLOSE_BOLLINGER.TIPO='CLOSE' AND II_CLOSE_BOLLINGER.ID_INDICADOR='BOLLINGER' AND II_CLOSE_MOMENTUM.TIPO='CLOSE' AND II_CLOSE_MOMENTUM.ID_INDICADOR='MOMENTUM' AND II_CLOSE_ICHITREND.TIPO='CLOSE' AND II_CLOSE_ICHITREND.ID_INDICADOR='ICHIMOKU_TREND' AND II_CLOSE_ICHISIGNAL.TIPO='CLOSE' AND II_CLOSE_ICHISIGNAL.ID_INDICADOR='ICHIMOKU_SIGNAL' AND DH1_OPEN.AVERAGE IS NOT NULL AND DH1_OPEN.MACD_VALUE IS NOT NULL AND DH1_OPEN.MACD_SIGNAL IS NOT NULL AND DH1_OPEN.COMPARE_VALUE IS NOT NULL AND DH1_OPEN.AVERAGE_COMPARE IS NOT NULL AND DH1_OPEN.SAR IS NOT NULL AND DH1_OPEN.ADX_VALUE IS NOT NULL AND DH1_OPEN.ADX_PLUS IS NOT NULL AND DH1_OPEN.ADX_MINUS IS NOT NULL AND DH1_OPEN.RSI IS NOT NULL AND DH1_OPEN.BOLLINGER_UPPER IS NOT NULL AND DH1_OPEN.BOLLINGER_LOWER IS NOT NULL AND DH1_OPEN.MOMENTUM IS NOT NULL AND DH1_OPEN.ICHIMOKUTENKANSEN IS NOT NULL AND DH1_OPEN.ICHIMOKUKIJUNSEN IS NOT NULL AND DH1_OPEN.ICHIMOKUSENKOUSPANA IS NOT NULL AND DH1_OPEN.ICHIMOKUSENKOUSPANB IS NOT NULL AND DH1_OPEN.ICHIMOKUCHINKOUSPAN IS NOT NULL AND DH1_CLOSE.AVERAGE IS NOT NULL AND DH1_CLOSE.MACD_VALUE IS NOT NULL AND DH1_CLOSE.MACD_SIGNAL IS NOT NULL AND DH1_CLOSE.COMPARE_VALUE IS NOT NULL AND DH1_CLOSE.AVERAGE_COMPARE IS NOT NULL AND DH1_CLOSE.SAR IS NOT NULL AND DH1_CLOSE.ADX_VALUE IS NOT NULL AND DH1_CLOSE.ADX_PLUS IS NOT NULL AND DH1_CLOSE.ADX_MINUS IS NOT NULL AND DH1_CLOSE.RSI IS NOT NULL AND DH1_CLOSE.BOLLINGER_UPPER IS NOT NULL AND DH1_CLOSE.BOLLINGER_LOWER IS NOT NULL AND DH1_CLOSE.MOMENTUM IS NOT NULL AND DH1_CLOSE.ICHIMOKUTENKANSEN IS NOT NULL AND DH1_CLOSE.ICHIMOKUKIJUNSEN IS NOT NULL AND DH1_CLOSE.ICHIMOKUSENKOUSPANA IS NOT NULL AND DH1_CLOSE.ICHIMOKUSENKOUSPANB IS NOT NULL AND DH1_CLOSE.ICHIMOKUCHINKOUSPAN IS NOT NULL AND IND.ID='1329927210938.2964' AND DH1_OPEN.FECHA=TO_DATE('2008/07/14 00:27','YYYY/MM/DD HH24:MI') AND DH1_CLOSE.FECHA=TO_DATE('2008/07/14 00:29','YYYY/MM/DD HH24:MI') ;
SELECT IND.ID ID_INDIVIDUO, IND.TAKE_PROFIT, IND.STOP_LOSS, DH1_OPEN.FECHA OPEN_FECHA, DH1_CLOSE.FECHA CLOSE_FECHA ,OBTENER_SPREAD(DH1_OPEN.FECHA) SPREAD ,CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA) OPEN_PRICE ,CALCULAR_CLOSE_PRICE(INTERVALO(II_CLOSE_MA.INTERVALO_INFERIOR, II_CLOSE_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_CLOSE_SAR.INTERVALO_INFERIOR, II_CLOSE_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_CLOSE_ICHITREND.INTERVALO_INFERIOR, II_CLOSE_ICHITREND.INTERVALO_SUPERIOR) ,DH1_CLOSE.AVERAGE, DH1_CLOSE.SAR, DH1_CLOSE.ICHIMOKUSENKOUSPANA-DH1_CLOSE.ICHIMOKUSENKOUSPANB, DH1_CLOSE.FECHA) CLOSE_PRICE ,CALCULAR_CLOSE_PRICE_TP(DH1_CLOSE.FECHA) CLOSE_PRICE_TP ,CALCULAR_CLOSE_PRICE_SL(DH1_CLOSE.FECHA) CLOSE_PRICE_SL ,CALCULAR_PIPS( CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA), CALCULAR_CLOSE_PRICE(INTERVALO(II_CLOSE_MA.INTERVALO_INFERIOR, II_CLOSE_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_CLOSE_SAR.INTERVALO_INFERIOR, II_CLOSE_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_CLOSE_ICHITREND.INTERVALO_INFERIOR, II_CLOSE_ICHITREND.INTERVALO_SUPERIOR) ,DH1_CLOSE.AVERAGE, DH1_CLOSE.SAR, DH1_CLOSE.ICHIMOKUSENKOUSPANA-DH1_CLOSE.ICHIMOKUSENKOUSPANB, DH1_CLOSE.FECHA), OBTENER_SPREAD(DH1_OPEN.FECHA)) PIPS ,CALCULAR_PIPS(CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA), CALCULAR_CLOSE_PRICE_TP(DH1_CLOSE.FECHA), OBTENER_SPREAD(DH1_OPEN.FECHA)) PIPS_TP ,CALCULAR_PIPS(CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA), CALCULAR_CLOSE_PRICE_SL(DH1_CLOSE.FECHA), OBTENER_SPREAD(DH1_OPEN.FECHA)) PIPS_SL ,PROCESS_OPEN_PRICE_DEPENDENT(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR, DH1_OPEN.AVERAGE, DH1_OPEN.FECHA) OPEN_MA ,PROCESS_OPEN(II_OPEN_MACD.INTERVALO_INFERIOR, II_OPEN_MACD.INTERVALO_SUPERIOR, DH1_OPEN.MACD_VALUE, DH1_OPEN.MACD_SIGNAL) OPEN_MACD ,PROCESS_OPEN(II_OPEN_COMPARE.INTERVALO_INFERIOR, II_OPEN_COMPARE.INTERVALO_SUPERIOR, DH1_OPEN.AVERAGE_COMPARE-DH1_OPEN.COMPARE_VALUE,0) OPEN_COMPARE ,PROCESS_OPEN_PRICE_DEPENDENT(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR, DH1_OPEN.SAR, DH1_OPEN.FECHA) OPEN_SAR ,PROCESS_OPEN(II_OPEN_ADX.INTERVALO_INFERIOR, II_OPEN_ADX.INTERVALO_SUPERIOR, DH1_OPEN.ADX_VALUE*DH1_OPEN.ADX_PLUS, DH1_OPEN.ADX_VALUE*DH1_OPEN.ADX_MINUS) OPEN_ADX ,PROCESS_OPEN(II_OPEN_RSI.INTERVALO_INFERIOR, II_OPEN_RSI.INTERVALO_SUPERIOR, DH1_OPEN.RSI, 0) OPEN_RSI ,PROCESS_OPEN(II_OPEN_BOLLINGER.INTERVALO_INFERIOR, II_OPEN_BOLLINGER.INTERVALO_SUPERIOR, DH1_OPEN.BOLLINGER_UPPER, DH1_OPEN.BOLLINGER_LOWER) OPEN_BOLLINGER ,PROCESS_OPEN(II_OPEN_MOMENTUM.INTERVALO_INFERIOR, II_OPEN_MOMENTUM.INTERVALO_SUPERIOR, DH1_OPEN.MOMENTUM, 0) OPEN_MOMENTUM ,PROCESS_OPEN_PRICE_DEPENDENT(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA) OPEN_ICHITREND ,PROCESS_OPEN(II_OPEN_ICHISIGNAL.INTERVALO_INFERIOR, II_OPEN_ICHISIGNAL.INTERVALO_SUPERIOR, DH1_OPEN.ICHIMOKUCHINKOUSPAN*DH1_OPEN.ICHIMOKUTENKANSEN, DH1_OPEN.ICHIMOKUCHINKOUSPAN*DH1_OPEN.ICHIMOKUKIJUNSEN) OPEN_ICHISIGNAL ,PROCESS_CLOSE_PIPS(CALCULAR_PIPS( CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA), CALCULAR_CLOSE_PRICE_TP(DH1_CLOSE.FECHA), OBTENER_SPREAD(DH1_OPEN.FECHA) ), CALCULAR_PIPS( CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA), CALCULAR_CLOSE_PRICE_SL(DH1_CLOSE.FECHA), OBTENER_SPREAD(DH1_OPEN.FECHA) ), IND.TAKE_PROFIT, IND.STOP_LOSS) CLOSE_BY_PIPS -- ,II_CLOSE_MA.INTERVALO_INFERIOR IS NOT NULL ,PROCESS_CLOSE_PRICE_DEPENDENT(II_CLOSE_MA.INTERVALO_INFERIOR, II_CLOSE_MA.INTERVALO_SUPERIOR, DH1_CLOSE.AVERAGE, DH1_CLOSE.FECHA) CLOSE_MA ,PROCESS_CLOSE(II_CLOSE_MACD.INTERVALO_INFERIOR, II_CLOSE_MACD.INTERVALO_SUPERIOR, DH1_CLOSE.MACD_VALUE, DH1_CLOSE.MACD_SIGNAL) CLOSE_MACD ,PROCESS_CLOSE(II_CLOSE_COMPARE.INTERVALO_INFERIOR, II_CLOSE_COMPARE.INTERVALO_SUPERIOR, DH1_CLOSE.AVERAGE_COMPARE-DH1_CLOSE.COMPARE_VALUE,0) CLOSE_COMPARE ,PROCESS_CLOSE_PRICE_DEPENDENT(II_CLOSE_SAR.INTERVALO_INFERIOR, II_CLOSE_SAR.INTERVALO_SUPERIOR, DH1_CLOSE.SAR, DH1_CLOSE.FECHA) CLOSE_SAR ,PROCESS_CLOSE(II_CLOSE_ADX.INTERVALO_INFERIOR, II_CLOSE_ADX.INTERVALO_SUPERIOR, DH1_CLOSE.ADX_VALUE*DH1_CLOSE.ADX_PLUS, DH1_CLOSE.ADX_VALUE*DH1_CLOSE.ADX_MINUS) CLOSE_ADX ,PROCESS_CLOSE(II_CLOSE_RSI.INTERVALO_INFERIOR, II_CLOSE_RSI.INTERVALO_SUPERIOR, DH1_CLOSE.RSI, 0) CLOSE_RSI ,PROCESS_CLOSE(II_CLOSE_BOLLINGER.INTERVALO_INFERIOR, II_CLOSE_BOLLINGER.INTERVALO_SUPERIOR, DH1_CLOSE.BOLLINGER_UPPER, DH1_CLOSE.BOLLINGER_LOWER) CLOSE_BOLLINGER ,PROCESS_CLOSE(II_CLOSE_MOMENTUM.INTERVALO_INFERIOR, II_CLOSE_MOMENTUM.INTERVALO_SUPERIOR, DH1_CLOSE.MOMENTUM, 0) CLOSE_MOMENTUM ,PROCESS_CLOSE_PRICE_DEPENDENT(II_CLOSE_ICHITREND.INTERVALO_INFERIOR, II_CLOSE_ICHITREND.INTERVALO_SUPERIOR, DH1_CLOSE.ICHIMOKUSENKOUSPANA-DH1_CLOSE.ICHIMOKUSENKOUSPANB, DH1_CLOSE.FECHA) CLOSE_ICHITREND ,PROCESS_CLOSE(II_CLOSE_ICHISIGNAL.INTERVALO_INFERIOR, II_CLOSE_ICHISIGNAL.INTERVALO_SUPERIOR, DH1_CLOSE.ICHIMOKUCHINKOUSPAN*DH1_CLOSE.ICHIMOKUTENKANSEN, DH1_CLOSE.ICHIMOKUCHINKOUSPAN*DH1_CLOSE.ICHIMOKUKIJUNSEN) CLOSE_ICHISIGNAL FROM DATOHISTORICO DH1_OPEN, DATOHISTORICO DH1_CLOSE, INDIVIDUO IND, INDICADOR_INDIVIDUO II_OPEN_MA, INDICADOR_INDIVIDUO II_CLOSE_MA, INDICADOR_INDIVIDUO II_OPEN_MACD, INDICADOR_INDIVIDUO II_CLOSE_MACD, INDICADOR_INDIVIDUO II_OPEN_COMPARE, INDICADOR_INDIVIDUO II_CLOSE_COMPARE, INDICADOR_INDIVIDUO II_OPEN_SAR, INDICADOR_INDIVIDUO II_CLOSE_SAR, INDICADOR_INDIVIDUO II_OPEN_ADX, INDICADOR_INDIVIDUO II_CLOSE_ADX, INDICADOR_INDIVIDUO II_OPEN_RSI, INDICADOR_INDIVIDUO II_CLOSE_RSI, INDICADOR_INDIVIDUO II_OPEN_BOLLINGER, INDICADOR_INDIVIDUO II_CLOSE_BOLLINGER, INDICADOR_INDIVIDUO II_OPEN_MOMENTUM, INDICADOR_INDIVIDUO II_CLOSE_MOMENTUM, INDICADOR_INDIVIDUO II_OPEN_ICHITREND, INDICADOR_INDIVIDUO II_CLOSE_ICHITREND, INDICADOR_INDIVIDUO II_OPEN_ICHISIGNAL, INDICADOR_INDIVIDUO II_CLOSE_ICHISIGNAL WHERE IND.ID=II_OPEN_MA.ID_INDIVIDUO AND IND.ID=II_CLOSE_MA.ID_INDIVIDUO AND IND.ID=II_OPEN_MACD.ID_INDIVIDUO AND IND.ID=II_CLOSE_MACD.ID_INDIVIDUO AND IND.ID=II_OPEN_COMPARE.ID_INDIVIDUO AND IND.ID=II_CLOSE_COMPARE.ID_INDIVIDUO AND IND.ID=II_OPEN_SAR.ID_INDIVIDUO AND IND.ID=II_CLOSE_SAR.ID_INDIVIDUO AND IND.ID=II_OPEN_ADX.ID_INDIVIDUO AND IND.ID=II_CLOSE_ADX.ID_INDIVIDUO AND IND.ID=II_OPEN_RSI.ID_INDIVIDUO AND IND.ID=II_CLOSE_RSI.ID_INDIVIDUO AND IND.ID=II_OPEN_BOLLINGER.ID_INDIVIDUO AND IND.ID=II_CLOSE_BOLLINGER.ID_INDIVIDUO AND IND.ID=II_OPEN_MOMENTUM.ID_INDIVIDUO AND IND.ID=II_CLOSE_MOMENTUM.ID_INDIVIDUO AND IND.ID=II_OPEN_ICHITREND.ID_INDIVIDUO AND IND.ID=II_CLOSE_ICHITREND.ID_INDIVIDUO AND IND.ID=II_OPEN_ICHISIGNAL.ID_INDIVIDUO AND IND.ID=II_CLOSE_ICHISIGNAL.ID_INDIVIDUO AND II_OPEN_MA.TIPO='OPEN' AND II_OPEN_MA.ID_INDICADOR='MA' AND II_OPEN_MACD.TIPO='OPEN' AND II_OPEN_MACD.ID_INDICADOR='MACD' AND II_OPEN_COMPARE.TIPO='OPEN' AND II_OPEN_COMPARE.ID_INDICADOR='COMPARE_MA' AND II_OPEN_SAR.TIPO='OPEN' AND II_OPEN_SAR.ID_INDICADOR='SAR' AND II_OPEN_ADX.TIPO='OPEN' AND II_OPEN_ADX.ID_INDICADOR='ADX' AND II_OPEN_RSI.TIPO='OPEN' AND II_OPEN_RSI.ID_INDICADOR='RSI' AND II_OPEN_BOLLINGER.TIPO='OPEN' AND II_OPEN_BOLLINGER.ID_INDICADOR='BOLLINGER' AND II_OPEN_MOMENTUM.TIPO='OPEN' AND II_OPEN_MOMENTUM.ID_INDICADOR='MOMENTUM' AND II_OPEN_ICHITREND.TIPO='OPEN' AND II_OPEN_ICHITREND.ID_INDICADOR='ICHIMOKU_TREND' AND II_OPEN_ICHISIGNAL.TIPO='OPEN' AND II_OPEN_ICHISIGNAL.ID_INDICADOR='ICHIMOKU_SIGNAL' AND II_CLOSE_MA.TIPO='CLOSE' AND II_CLOSE_MA.ID_INDICADOR='MA' AND II_CLOSE_MACD.TIPO='CLOSE' AND II_CLOSE_MACD.ID_INDICADOR='MACD' AND II_CLOSE_COMPARE.TIPO='CLOSE' AND II_CLOSE_COMPARE.ID_INDICADOR='COMPARE_MA' AND II_CLOSE_SAR.TIPO='CLOSE' AND II_CLOSE_SAR.ID_INDICADOR='SAR' AND II_CLOSE_ADX.TIPO='CLOSE' AND II_CLOSE_ADX.ID_INDICADOR='ADX' AND II_CLOSE_RSI.TIPO='CLOSE' AND II_CLOSE_RSI.ID_INDICADOR='RSI' AND II_CLOSE_BOLLINGER.TIPO='CLOSE' AND II_CLOSE_BOLLINGER.ID_INDICADOR='BOLLINGER' AND II_CLOSE_MOMENTUM.TIPO='CLOSE' AND II_CLOSE_MOMENTUM.ID_INDICADOR='MOMENTUM' AND II_CLOSE_ICHITREND.TIPO='CLOSE' AND II_CLOSE_ICHITREND.ID_INDICADOR='ICHIMOKU_TREND' AND II_CLOSE_ICHISIGNAL.TIPO='CLOSE' AND II_CLOSE_ICHISIGNAL.ID_INDICADOR='ICHIMOKU_SIGNAL' AND DH1_OPEN.AVERAGE IS NOT NULL AND DH1_OPEN.MACD_VALUE IS NOT NULL AND DH1_OPEN.MACD_SIGNAL IS NOT NULL AND DH1_OPEN.COMPARE_VALUE IS NOT NULL AND DH1_OPEN.AVERAGE_COMPARE IS NOT NULL AND DH1_OPEN.SAR IS NOT NULL AND DH1_OPEN.ADX_VALUE IS NOT NULL AND DH1_OPEN.ADX_PLUS IS NOT NULL AND DH1_OPEN.ADX_MINUS IS NOT NULL AND DH1_OPEN.RSI IS NOT NULL AND DH1_OPEN.BOLLINGER_UPPER IS NOT NULL AND DH1_OPEN.BOLLINGER_LOWER IS NOT NULL AND DH1_OPEN.MOMENTUM IS NOT NULL AND DH1_OPEN.ICHIMOKUTENKANSEN IS NOT NULL AND DH1_OPEN.ICHIMOKUKIJUNSEN IS NOT NULL AND DH1_OPEN.ICHIMOKUSENKOUSPANA IS NOT NULL AND DH1_OPEN.ICHIMOKUSENKOUSPANB IS NOT NULL AND DH1_OPEN.ICHIMOKUCHINKOUSPAN IS NOT NULL AND DH1_CLOSE.AVERAGE IS NOT NULL AND DH1_CLOSE.MACD_VALUE IS NOT NULL AND DH1_CLOSE.MACD_SIGNAL IS NOT NULL AND DH1_CLOSE.COMPARE_VALUE IS NOT NULL AND DH1_CLOSE.AVERAGE_COMPARE IS NOT NULL AND DH1_CLOSE.SAR IS NOT NULL AND DH1_CLOSE.ADX_VALUE IS NOT NULL AND DH1_CLOSE.ADX_PLUS IS NOT NULL AND DH1_CLOSE.ADX_MINUS IS NOT NULL AND DH1_CLOSE.RSI IS NOT NULL AND DH1_CLOSE.BOLLINGER_UPPER IS NOT NULL AND DH1_CLOSE.BOLLINGER_LOWER IS NOT NULL AND DH1_CLOSE.MOMENTUM IS NOT NULL AND DH1_CLOSE.ICHIMOKUTENKANSEN IS NOT NULL AND DH1_CLOSE.ICHIMOKUKIJUNSEN IS NOT NULL AND DH1_CLOSE.ICHIMOKUSENKOUSPANA IS NOT NULL AND DH1_CLOSE.ICHIMOKUSENKOUSPANB IS NOT NULL AND DH1_CLOSE.ICHIMOKUCHINKOUSPAN IS NOT NULL AND IND.ID='1329927210938.2964' AND DH1_OPEN.FECHA=TO_DATE('2008/07/14 00:27','YYYY/MM/DD HH24:MI') AND DH1_CLOSE.FECHA=TO_DATE('2008/07/14 00:29','YYYY/MM/DD HH24:MI') ;
SELECT IND.ID ID_INDIVIDUO, IND.TAKE_PROFIT, IND.STOP_LOSS, DH1_OPEN.FECHA OPEN_FECHA, DH1_CLOSE.FECHA CLOSE_FECHA ,II_CLOSE_MACD.INTERVALO_INFERIOR, II_CLOSE_MACD.INTERVALO_SUPERIOR ,PROCESS_CLOSE(II_CLOSE_MACD.INTERVALO_INFERIOR, II_CLOSE_MACD.INTERVALO_SUPERIOR, DH1_CLOSE.MACD_VALUE, DH1_CLOSE.MACD_SIGNAL) CLOSE_MACD ,PROCESS_CLOSE(II_CLOSE_COMPARE.INTERVALO_INFERIOR, II_CLOSE_COMPARE.INTERVALO_SUPERIOR, DH1_CLOSE.AVERAGE_COMPARE-DH1_CLOSE.COMPARE_VALUE,0) CLOSE_COMPARE ,PROCESS_CLOSE_PRICE_DEPENDENT(II_CLOSE_SAR.INTERVALO_INFERIOR, II_CLOSE_SAR.INTERVALO_SUPERIOR, DH1_CLOSE.SAR, DH1_CLOSE.FECHA) CLOSE_SAR ,PROCESS_CLOSE(II_CLOSE_ADX.INTERVALO_INFERIOR, II_CLOSE_ADX.INTERVALO_SUPERIOR, DH1_CLOSE.ADX_VALUE*DH1_CLOSE.ADX_PLUS, DH1_CLOSE.ADX_VALUE*DH1_CLOSE.ADX_MINUS) CLOSE_ADX ,PROCESS_CLOSE(II_CLOSE_RSI.INTERVALO_INFERIOR, II_CLOSE_RSI.INTERVALO_SUPERIOR, DH1_CLOSE.RSI, 0) CLOSE_RSI ,PROCESS_CLOSE(II_CLOSE_BOLLINGER.INTERVALO_INFERIOR, II_CLOSE_BOLLINGER.INTERVALO_SUPERIOR, DH1_CLOSE.BOLLINGER_UPPER, DH1_CLOSE.BOLLINGER_LOWER) CLOSE_BOLLINGER ,PROCESS_CLOSE(II_CLOSE_MOMENTUM.INTERVALO_INFERIOR, II_CLOSE_MOMENTUM.INTERVALO_SUPERIOR, DH1_CLOSE.MOMENTUM, 0) CLOSE_MOMENTUM ,PROCESS_CLOSE_PRICE_DEPENDENT(II_CLOSE_ICHITREND.INTERVALO_INFERIOR, II_CLOSE_ICHITREND.INTERVALO_SUPERIOR, DH1_CLOSE.ICHIMOKUSENKOUSPANA-DH1_CLOSE.ICHIMOKUSENKOUSPANB, DH1_CLOSE.FECHA) CLOSE_ICHITREND ,PROCESS_CLOSE(II_CLOSE_ICHISIGNAL.INTERVALO_INFERIOR, II_CLOSE_ICHISIGNAL.INTERVALO_SUPERIOR, DH1_CLOSE.ICHIMOKUCHINKOUSPAN*DH1_CLOSE.ICHIMOKUTENKANSEN, DH1_CLOSE.ICHIMOKUCHINKOUSPAN*DH1_CLOSE.ICHIMOKUKIJUNSEN) CLOSE_ICHISIGNAL FROM DATOHISTORICO DH1_OPEN, DATOHISTORICO DH1_CLOSE, INDIVIDUO IND, INDICADOR_INDIVIDUO II_OPEN_MA, INDICADOR_INDIVIDUO II_CLOSE_MA, INDICADOR_INDIVIDUO II_OPEN_MACD, INDICADOR_INDIVIDUO II_CLOSE_MACD, INDICADOR_INDIVIDUO II_OPEN_COMPARE, INDICADOR_INDIVIDUO II_CLOSE_COMPARE, INDICADOR_INDIVIDUO II_OPEN_SAR, INDICADOR_INDIVIDUO II_CLOSE_SAR, INDICADOR_INDIVIDUO II_OPEN_ADX, INDICADOR_INDIVIDUO II_CLOSE_ADX, INDICADOR_INDIVIDUO II_OPEN_RSI, INDICADOR_INDIVIDUO II_CLOSE_RSI, INDICADOR_INDIVIDUO II_OPEN_BOLLINGER, INDICADOR_INDIVIDUO II_CLOSE_BOLLINGER, INDICADOR_INDIVIDUO II_OPEN_MOMENTUM, INDICADOR_INDIVIDUO II_CLOSE_MOMENTUM, INDICADOR_INDIVIDUO II_OPEN_ICHITREND, INDICADOR_INDIVIDUO II_CLOSE_ICHITREND, INDICADOR_INDIVIDUO II_OPEN_ICHISIGNAL, INDICADOR_INDIVIDUO II_CLOSE_ICHISIGNAL WHERE IND.ID=II_OPEN_MA.ID_INDIVIDUO AND IND.ID=II_CLOSE_MA.ID_INDIVIDUO AND IND.ID=II_OPEN_MACD.ID_INDIVIDUO AND IND.ID=II_CLOSE_MACD.ID_INDIVIDUO AND IND.ID=II_OPEN_COMPARE.ID_INDIVIDUO AND IND.ID=II_CLOSE_COMPARE.ID_INDIVIDUO AND IND.ID=II_OPEN_SAR.ID_INDIVIDUO AND IND.ID=II_CLOSE_SAR.ID_INDIVIDUO AND IND.ID=II_OPEN_ADX.ID_INDIVIDUO AND IND.ID=II_CLOSE_ADX.ID_INDIVIDUO AND IND.ID=II_OPEN_RSI.ID_INDIVIDUO AND IND.ID=II_CLOSE_RSI.ID_INDIVIDUO AND IND.ID=II_OPEN_BOLLINGER.ID_INDIVIDUO AND IND.ID=II_CLOSE_BOLLINGER.ID_INDIVIDUO AND IND.ID=II_OPEN_MOMENTUM.ID_INDIVIDUO AND IND.ID=II_CLOSE_MOMENTUM.ID_INDIVIDUO AND IND.ID=II_OPEN_ICHITREND.ID_INDIVIDUO AND IND.ID=II_CLOSE_ICHITREND.ID_INDIVIDUO AND IND.ID=II_OPEN_ICHISIGNAL.ID_INDIVIDUO AND IND.ID=II_CLOSE_ICHISIGNAL.ID_INDIVIDUO AND II_OPEN_MA.TIPO='OPEN' AND II_OPEN_MA.ID_INDICADOR='MA' AND II_OPEN_MACD.TIPO='OPEN' AND II_OPEN_MACD.ID_INDICADOR='MACD' AND II_OPEN_COMPARE.TIPO='OPEN' AND II_OPEN_COMPARE.ID_INDICADOR='COMPARE_MA' AND II_OPEN_SAR.TIPO='OPEN' AND II_OPEN_SAR.ID_INDICADOR='SAR' AND II_OPEN_ADX.TIPO='OPEN' AND II_OPEN_ADX.ID_INDICADOR='ADX' AND II_OPEN_RSI.TIPO='OPEN' AND II_OPEN_RSI.ID_INDICADOR='RSI' AND II_OPEN_BOLLINGER.TIPO='OPEN' AND II_OPEN_BOLLINGER.ID_INDICADOR='BOLLINGER' AND II_OPEN_MOMENTUM.TIPO='OPEN' AND II_OPEN_MOMENTUM.ID_INDICADOR='MOMENTUM' AND II_OPEN_ICHITREND.TIPO='OPEN' AND II_OPEN_ICHITREND.ID_INDICADOR='ICHIMOKU_TREND' AND II_OPEN_ICHISIGNAL.TIPO='OPEN' AND II_OPEN_ICHISIGNAL.ID_INDICADOR='ICHIMOKU_SIGNAL' AND II_CLOSE_MA.TIPO='CLOSE' AND II_CLOSE_MA.ID_INDICADOR='MA' AND II_CLOSE_MACD.TIPO='CLOSE' AND II_CLOSE_MACD.ID_INDICADOR='MACD' AND II_CLOSE_COMPARE.TIPO='CLOSE' AND II_CLOSE_COMPARE.ID_INDICADOR='COMPARE_MA' AND II_CLOSE_SAR.TIPO='CLOSE' AND II_CLOSE_SAR.ID_INDICADOR='SAR' AND II_CLOSE_ADX.TIPO='CLOSE' AND II_CLOSE_ADX.ID_INDICADOR='ADX' AND II_CLOSE_RSI.TIPO='CLOSE' AND II_CLOSE_RSI.ID_INDICADOR='RSI' AND II_CLOSE_BOLLINGER.TIPO='CLOSE' AND II_CLOSE_BOLLINGER.ID_INDICADOR='BOLLINGER' AND II_CLOSE_MOMENTUM.TIPO='CLOSE' AND II_CLOSE_MOMENTUM.ID_INDICADOR='MOMENTUM' AND II_CLOSE_ICHITREND.TIPO='CLOSE' AND II_CLOSE_ICHITREND.ID_INDICADOR='ICHIMOKU_TREND' AND II_CLOSE_ICHISIGNAL.TIPO='CLOSE' AND II_CLOSE_ICHISIGNAL.ID_INDICADOR='ICHIMOKU_SIGNAL' AND DH1_OPEN.AVERAGE IS NOT NULL AND DH1_OPEN.MACD_VALUE IS NOT NULL AND DH1_OPEN.MACD_SIGNAL IS NOT NULL AND DH1_OPEN.COMPARE_VALUE IS NOT NULL AND DH1_OPEN.AVERAGE_COMPARE IS NOT NULL AND DH1_OPEN.SAR IS NOT NULL AND DH1_OPEN.ADX_VALUE IS NOT NULL AND DH1_OPEN.ADX_PLUS IS NOT NULL AND DH1_OPEN.ADX_MINUS IS NOT NULL AND DH1_OPEN.RSI IS NOT NULL AND DH1_OPEN.BOLLINGER_UPPER IS NOT NULL AND DH1_OPEN.BOLLINGER_LOWER IS NOT NULL AND DH1_OPEN.MOMENTUM IS NOT NULL AND DH1_OPEN.ICHIMOKUTENKANSEN IS NOT NULL AND DH1_OPEN.ICHIMOKUKIJUNSEN IS NOT NULL AND DH1_OPEN.ICHIMOKUSENKOUSPANA IS NOT NULL AND DH1_OPEN.ICHIMOKUSENKOUSPANB IS NOT NULL AND DH1_OPEN.ICHIMOKUCHINKOUSPAN IS NOT NULL AND DH1_CLOSE.AVERAGE IS NOT NULL AND DH1_CLOSE.MACD_VALUE IS NOT NULL AND DH1_CLOSE.MACD_SIGNAL IS NOT NULL AND DH1_CLOSE.COMPARE_VALUE IS NOT NULL AND DH1_CLOSE.AVERAGE_COMPARE IS NOT NULL AND DH1_CLOSE.SAR IS NOT NULL AND DH1_CLOSE.ADX_VALUE IS NOT NULL AND DH1_CLOSE.ADX_PLUS IS NOT NULL AND DH1_CLOSE.ADX_MINUS IS NOT NULL AND DH1_CLOSE.RSI IS NOT NULL AND DH1_CLOSE.BOLLINGER_UPPER IS NOT NULL AND DH1_CLOSE.BOLLINGER_LOWER IS NOT NULL AND DH1_CLOSE.MOMENTUM IS NOT NULL AND DH1_CLOSE.ICHIMOKUTENKANSEN IS NOT NULL AND DH1_CLOSE.ICHIMOKUKIJUNSEN IS NOT NULL AND DH1_CLOSE.ICHIMOKUSENKOUSPANA IS NOT NULL AND DH1_CLOSE.ICHIMOKUSENKOUSPANB IS NOT NULL AND DH1_CLOSE.ICHIMOKUCHINKOUSPAN IS NOT NULL AND IND.ID='1329927210938.2964' AND DH1_OPEN.FECHA=TO_DATE('2008/07/14 00:27','YYYY/MM/DD HH24:MI') AND DH1_CLOSE.FECHA=TO_DATE('2008/07/14 00:29','YYYY/MM/DD HH24:MI') ;
SELECT IND.ID ID_INDIVIDUO, IND.TAKE_PROFIT, IND.STOP_LOSS, DH1_OPEN.FECHA OPEN_FECHA, DH1_CLOSE.FECHA CLOSE_FECHA ,PROCESS_CLOSE(II_CLOSE_MACD.INTERVALO_INFERIOR, II_CLOSE_MACD.INTERVALO_SUPERIOR, DH1_CLOSE.MACD_VALUE, DH1_CLOSE.MACD_SIGNAL) CLOSE_MACD ,PROCESS_CLOSE(II_CLOSE_COMPARE.INTERVALO_INFERIOR, II_CLOSE_COMPARE.INTERVALO_SUPERIOR, DH1_CLOSE.AVERAGE_COMPARE-DH1_CLOSE.COMPARE_VALUE,0) CLOSE_COMPARE ,PROCESS_CLOSE_PRICE_DEPENDENT(II_CLOSE_SAR.INTERVALO_INFERIOR, II_CLOSE_SAR.INTERVALO_SUPERIOR, DH1_CLOSE.SAR, DH1_CLOSE.FECHA) CLOSE_SAR ,PROCESS_CLOSE(II_CLOSE_ADX.INTERVALO_INFERIOR, II_CLOSE_ADX.INTERVALO_SUPERIOR, DH1_CLOSE.ADX_VALUE*DH1_CLOSE.ADX_PLUS, DH1_CLOSE.ADX_VALUE*DH1_CLOSE.ADX_MINUS) CLOSE_ADX ,PROCESS_CLOSE(II_CLOSE_RSI.INTERVALO_INFERIOR, II_CLOSE_RSI.INTERVALO_SUPERIOR, DH1_CLOSE.RSI, 0) CLOSE_RSI ,PROCESS_CLOSE(II_CLOSE_BOLLINGER.INTERVALO_INFERIOR, II_CLOSE_BOLLINGER.INTERVALO_SUPERIOR, DH1_CLOSE.BOLLINGER_UPPER, DH1_CLOSE.BOLLINGER_LOWER) CLOSE_BOLLINGER ,PROCESS_CLOSE(II_CLOSE_MOMENTUM.INTERVALO_INFERIOR, II_CLOSE_MOMENTUM.INTERVALO_SUPERIOR, DH1_CLOSE.MOMENTUM, 0) CLOSE_MOMENTUM ,PROCESS_CLOSE_PRICE_DEPENDENT(II_CLOSE_ICHITREND.INTERVALO_INFERIOR, II_CLOSE_ICHITREND.INTERVALO_SUPERIOR, DH1_CLOSE.ICHIMOKUSENKOUSPANA-DH1_CLOSE.ICHIMOKUSENKOUSPANB, DH1_CLOSE.FECHA) CLOSE_ICHITREND ,PROCESS_CLOSE(II_CLOSE_ICHISIGNAL.INTERVALO_INFERIOR, II_CLOSE_ICHISIGNAL.INTERVALO_SUPERIOR, DH1_CLOSE.ICHIMOKUCHINKOUSPAN*DH1_CLOSE.ICHIMOKUTENKANSEN, DH1_CLOSE.ICHIMOKUCHINKOUSPAN*DH1_CLOSE.ICHIMOKUKIJUNSEN) CLOSE_ICHISIGNAL FROM DATOHISTORICO DH1_OPEN, DATOHISTORICO DH1_CLOSE, INDIVIDUO IND, INDICADOR_INDIVIDUO II_OPEN_MA, INDICADOR_INDIVIDUO II_CLOSE_MA, INDICADOR_INDIVIDUO II_OPEN_MACD, INDICADOR_INDIVIDUO II_CLOSE_MACD, INDICADOR_INDIVIDUO II_OPEN_COMPARE, INDICADOR_INDIVIDUO II_CLOSE_COMPARE, INDICADOR_INDIVIDUO II_OPEN_SAR, INDICADOR_INDIVIDUO II_CLOSE_SAR, INDICADOR_INDIVIDUO II_OPEN_ADX, INDICADOR_INDIVIDUO II_CLOSE_ADX, INDICADOR_INDIVIDUO II_OPEN_RSI, INDICADOR_INDIVIDUO II_CLOSE_RSI, INDICADOR_INDIVIDUO II_OPEN_BOLLINGER, INDICADOR_INDIVIDUO II_CLOSE_BOLLINGER, INDICADOR_INDIVIDUO II_OPEN_MOMENTUM, INDICADOR_INDIVIDUO II_CLOSE_MOMENTUM, INDICADOR_INDIVIDUO II_OPEN_ICHITREND, INDICADOR_INDIVIDUO II_CLOSE_ICHITREND, INDICADOR_INDIVIDUO II_OPEN_ICHISIGNAL, INDICADOR_INDIVIDUO II_CLOSE_ICHISIGNAL WHERE IND.ID=II_OPEN_MA.ID_INDIVIDUO AND IND.ID=II_CLOSE_MA.ID_INDIVIDUO AND IND.ID=II_OPEN_MACD.ID_INDIVIDUO AND IND.ID=II_CLOSE_MACD.ID_INDIVIDUO AND IND.ID=II_OPEN_COMPARE.ID_INDIVIDUO AND IND.ID=II_CLOSE_COMPARE.ID_INDIVIDUO AND IND.ID=II_OPEN_SAR.ID_INDIVIDUO AND IND.ID=II_CLOSE_SAR.ID_INDIVIDUO AND IND.ID=II_OPEN_ADX.ID_INDIVIDUO AND IND.ID=II_CLOSE_ADX.ID_INDIVIDUO AND IND.ID=II_OPEN_RSI.ID_INDIVIDUO AND IND.ID=II_CLOSE_RSI.ID_INDIVIDUO AND IND.ID=II_OPEN_BOLLINGER.ID_INDIVIDUO AND IND.ID=II_CLOSE_BOLLINGER.ID_INDIVIDUO AND IND.ID=II_OPEN_MOMENTUM.ID_INDIVIDUO AND IND.ID=II_CLOSE_MOMENTUM.ID_INDIVIDUO AND IND.ID=II_OPEN_ICHITREND.ID_INDIVIDUO AND IND.ID=II_CLOSE_ICHITREND.ID_INDIVIDUO AND IND.ID=II_OPEN_ICHISIGNAL.ID_INDIVIDUO AND IND.ID=II_CLOSE_ICHISIGNAL.ID_INDIVIDUO AND II_OPEN_MA.TIPO='OPEN' AND II_OPEN_MA.ID_INDICADOR='MA' AND II_OPEN_MACD.TIPO='OPEN' AND II_OPEN_MACD.ID_INDICADOR='MACD' AND II_OPEN_COMPARE.TIPO='OPEN' AND II_OPEN_COMPARE.ID_INDICADOR='COMPARE_MA' AND II_OPEN_SAR.TIPO='OPEN' AND II_OPEN_SAR.ID_INDICADOR='SAR' AND II_OPEN_ADX.TIPO='OPEN' AND II_OPEN_ADX.ID_INDICADOR='ADX' AND II_OPEN_RSI.TIPO='OPEN' AND II_OPEN_RSI.ID_INDICADOR='RSI' AND II_OPEN_BOLLINGER.TIPO='OPEN' AND II_OPEN_BOLLINGER.ID_INDICADOR='BOLLINGER' AND II_OPEN_MOMENTUM.TIPO='OPEN' AND II_OPEN_MOMENTUM.ID_INDICADOR='MOMENTUM' AND II_OPEN_ICHITREND.TIPO='OPEN' AND II_OPEN_ICHITREND.ID_INDICADOR='ICHIMOKU_TREND' AND II_OPEN_ICHISIGNAL.TIPO='OPEN' AND II_OPEN_ICHISIGNAL.ID_INDICADOR='ICHIMOKU_SIGNAL' AND II_CLOSE_MA.TIPO='CLOSE' AND II_CLOSE_MA.ID_INDICADOR='MA' AND II_CLOSE_MACD.TIPO='CLOSE' AND II_CLOSE_MACD.ID_INDICADOR='MACD' AND II_CLOSE_COMPARE.TIPO='CLOSE' AND II_CLOSE_COMPARE.ID_INDICADOR='COMPARE_MA' AND II_CLOSE_SAR.TIPO='CLOSE' AND II_CLOSE_SAR.ID_INDICADOR='SAR' AND II_CLOSE_ADX.TIPO='CLOSE' AND II_CLOSE_ADX.ID_INDICADOR='ADX' AND II_CLOSE_RSI.TIPO='CLOSE' AND II_CLOSE_RSI.ID_INDICADOR='RSI' AND II_CLOSE_BOLLINGER.TIPO='CLOSE' AND II_CLOSE_BOLLINGER.ID_INDICADOR='BOLLINGER' AND II_CLOSE_MOMENTUM.TIPO='CLOSE' AND II_CLOSE_MOMENTUM.ID_INDICADOR='MOMENTUM' AND II_CLOSE_ICHITREND.TIPO='CLOSE' AND II_CLOSE_ICHITREND.ID_INDICADOR='ICHIMOKU_TREND' AND II_CLOSE_ICHISIGNAL.TIPO='CLOSE' AND II_CLOSE_ICHISIGNAL.ID_INDICADOR='ICHIMOKU_SIGNAL' AND DH1_OPEN.AVERAGE IS NOT NULL AND DH1_OPEN.MACD_VALUE IS NOT NULL AND DH1_OPEN.MACD_SIGNAL IS NOT NULL AND DH1_OPEN.COMPARE_VALUE IS NOT NULL AND DH1_OPEN.AVERAGE_COMPARE IS NOT NULL AND DH1_OPEN.SAR IS NOT NULL AND DH1_OPEN.ADX_VALUE IS NOT NULL AND DH1_OPEN.ADX_PLUS IS NOT NULL AND DH1_OPEN.ADX_MINUS IS NOT NULL AND DH1_OPEN.RSI IS NOT NULL AND DH1_OPEN.BOLLINGER_UPPER IS NOT NULL AND DH1_OPEN.BOLLINGER_LOWER IS NOT NULL AND DH1_OPEN.MOMENTUM IS NOT NULL AND DH1_OPEN.ICHIMOKUTENKANSEN IS NOT NULL AND DH1_OPEN.ICHIMOKUKIJUNSEN IS NOT NULL AND DH1_OPEN.ICHIMOKUSENKOUSPANA IS NOT NULL AND DH1_OPEN.ICHIMOKUSENKOUSPANB IS NOT NULL AND DH1_OPEN.ICHIMOKUCHINKOUSPAN IS NOT NULL AND DH1_CLOSE.AVERAGE IS NOT NULL AND DH1_CLOSE.MACD_VALUE IS NOT NULL AND DH1_CLOSE.MACD_SIGNAL IS NOT NULL AND DH1_CLOSE.COMPARE_VALUE IS NOT NULL AND DH1_CLOSE.AVERAGE_COMPARE IS NOT NULL AND DH1_CLOSE.SAR IS NOT NULL AND DH1_CLOSE.ADX_VALUE IS NOT NULL AND DH1_CLOSE.ADX_PLUS IS NOT NULL AND DH1_CLOSE.ADX_MINUS IS NOT NULL AND DH1_CLOSE.RSI IS NOT NULL AND DH1_CLOSE.BOLLINGER_UPPER IS NOT NULL AND DH1_CLOSE.BOLLINGER_LOWER IS NOT NULL AND DH1_CLOSE.MOMENTUM IS NOT NULL AND DH1_CLOSE.ICHIMOKUTENKANSEN IS NOT NULL AND DH1_CLOSE.ICHIMOKUKIJUNSEN IS NOT NULL AND DH1_CLOSE.ICHIMOKUSENKOUSPANA IS NOT NULL AND DH1_CLOSE.ICHIMOKUSENKOUSPANB IS NOT NULL AND DH1_CLOSE.ICHIMOKUCHINKOUSPAN IS NOT NULL AND IND.ID='1329927210938.2964' AND DH1_OPEN.FECHA=TO_DATE('2008/07/14 00:27','YYYY/MM/DD HH24:MI') AND DH1_CLOSE.FECHA=TO_DATE('2008/07/14 00:29','YYYY/MM/DD HH24:MI') ;
CREATE OR REPLACE FORCE VIEW DATOHIST_INDICADORINDIVIDUO AS SELECT IND.ID ID_INDIVIDUO, IND.TAKE_PROFIT, IND.STOP_LOSS, DH1_OPEN.FECHA OPEN_FECHA, DH1_CLOSE.FECHA CLOSE_FECHA ,OBTENER_SPREAD(DH1_OPEN.FECHA) SPREAD ,CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA) OPEN_PRICE ,CALCULAR_CLOSE_PRICE(INTERVALO(II_CLOSE_MA.INTERVALO_INFERIOR, II_CLOSE_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_CLOSE_SAR.INTERVALO_INFERIOR, II_CLOSE_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_CLOSE_ICHITREND.INTERVALO_INFERIOR, II_CLOSE_ICHITREND.INTERVALO_SUPERIOR) ,DH1_CLOSE.AVERAGE, DH1_CLOSE.SAR, DH1_CLOSE.ICHIMOKUSENKOUSPANA-DH1_CLOSE.ICHIMOKUSENKOUSPANB, DH1_CLOSE.FECHA) CLOSE_PRICE ,CALCULAR_CLOSE_PRICE_TP(DH1_CLOSE.FECHA) CLOSE_PRICE_TP ,CALCULAR_CLOSE_PRICE_SL(DH1_CLOSE.FECHA) CLOSE_PRICE_SL ,CALCULAR_PIPS( CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA), CALCULAR_CLOSE_PRICE(INTERVALO(II_CLOSE_MA.INTERVALO_INFERIOR, II_CLOSE_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_CLOSE_SAR.INTERVALO_INFERIOR, II_CLOSE_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_CLOSE_ICHITREND.INTERVALO_INFERIOR, II_CLOSE_ICHITREND.INTERVALO_SUPERIOR) ,DH1_CLOSE.AVERAGE, DH1_CLOSE.SAR, DH1_CLOSE.ICHIMOKUSENKOUSPANA-DH1_CLOSE.ICHIMOKUSENKOUSPANB, DH1_CLOSE.FECHA), OBTENER_SPREAD(DH1_OPEN.FECHA)) PIPS ,CALCULAR_PIPS(CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA), CALCULAR_CLOSE_PRICE_TP(DH1_CLOSE.FECHA), OBTENER_SPREAD(DH1_OPEN.FECHA)) PIPS_TP ,CALCULAR_PIPS(CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA), CALCULAR_CLOSE_PRICE_SL(DH1_CLOSE.FECHA), OBTENER_SPREAD(DH1_OPEN.FECHA)) PIPS_SL ,PROCESS_OPEN_PRICE_DEPENDENT(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR, DH1_OPEN.AVERAGE, DH1_OPEN.FECHA) OPEN_MA ,PROCESS_OPEN(II_OPEN_MACD.INTERVALO_INFERIOR, II_OPEN_MACD.INTERVALO_SUPERIOR, DH1_OPEN.MACD_VALUE, DH1_OPEN.MACD_SIGNAL) OPEN_MACD ,PROCESS_OPEN(II_OPEN_COMPARE.INTERVALO_INFERIOR, II_OPEN_COMPARE.INTERVALO_SUPERIOR, DH1_OPEN.AVERAGE_COMPARE-DH1_OPEN.COMPARE_VALUE,0) OPEN_COMPARE ,PROCESS_OPEN_PRICE_DEPENDENT(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR, DH1_OPEN.SAR, DH1_OPEN.FECHA) OPEN_SAR ,PROCESS_OPEN(II_OPEN_ADX.INTERVALO_INFERIOR, II_OPEN_ADX.INTERVALO_SUPERIOR, DH1_OPEN.ADX_VALUE*DH1_OPEN.ADX_PLUS, DH1_OPEN.ADX_VALUE*DH1_OPEN.ADX_MINUS) OPEN_ADX ,PROCESS_OPEN(II_OPEN_RSI.INTERVALO_INFERIOR, II_OPEN_RSI.INTERVALO_SUPERIOR, DH1_OPEN.RSI, 0) OPEN_RSI ,PROCESS_OPEN(II_OPEN_BOLLINGER.INTERVALO_INFERIOR, II_OPEN_BOLLINGER.INTERVALO_SUPERIOR, DH1_OPEN.BOLLINGER_UPPER, DH1_OPEN.BOLLINGER_LOWER) OPEN_BOLLINGER ,PROCESS_OPEN(II_OPEN_MOMENTUM.INTERVALO_INFERIOR, II_OPEN_MOMENTUM.INTERVALO_SUPERIOR, DH1_OPEN.MOMENTUM, 0) OPEN_MOMENTUM ,PROCESS_OPEN_PRICE_DEPENDENT(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA) OPEN_ICHITREND ,PROCESS_OPEN(II_OPEN_ICHISIGNAL.INTERVALO_INFERIOR, II_OPEN_ICHISIGNAL.INTERVALO_SUPERIOR, DH1_OPEN.ICHIMOKUCHINKOUSPAN*DH1_OPEN.ICHIMOKUTENKANSEN, DH1_OPEN.ICHIMOKUCHINKOUSPAN*DH1_OPEN.ICHIMOKUKIJUNSEN) OPEN_ICHISIGNAL ,PROCESS_CLOSE_PIPS(CALCULAR_PIPS( CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA), CALCULAR_CLOSE_PRICE_TP(DH1_CLOSE.FECHA), OBTENER_SPREAD(DH1_OPEN.FECHA) ), CALCULAR_PIPS( CALCULAR_OPEN_PRICE(INTERVALO(II_OPEN_MA.INTERVALO_INFERIOR, II_OPEN_MA.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_SAR.INTERVALO_INFERIOR, II_OPEN_SAR.INTERVALO_SUPERIOR) ,INTERVALO(II_OPEN_ICHITREND.INTERVALO_INFERIOR, II_OPEN_ICHITREND.INTERVALO_SUPERIOR) ,DH1_OPEN.AVERAGE, DH1_OPEN.SAR, DH1_OPEN.ICHIMOKUSENKOUSPANA-DH1_OPEN.ICHIMOKUSENKOUSPANB, DH1_OPEN.FECHA), CALCULAR_CLOSE_PRICE_SL(DH1_CLOSE.FECHA), OBTENER_SPREAD(DH1_OPEN.FECHA) ), IND.TAKE_PROFIT, IND.STOP_LOSS) CLOSE_BY_PIPS ,PROCESS_CLOSE_PRICE_DEPENDENT(II_CLOSE_MA.INTERVALO_INFERIOR, II_CLOSE_MA.INTERVALO_SUPERIOR, DH1_CLOSE.AVERAGE, DH1_CLOSE.FECHA) CLOSE_MA ,PROCESS_CLOSE(II_CLOSE_MACD.INTERVALO_INFERIOR, II_CLOSE_MACD.INTERVALO_SUPERIOR, DH1_CLOSE.MACD_VALUE, DH1_CLOSE.MACD_SIGNAL) CLOSE_MACD ,PROCESS_CLOSE(II_CLOSE_COMPARE.INTERVALO_INFERIOR, II_CLOSE_COMPARE.INTERVALO_SUPERIOR, DH1_CLOSE.AVERAGE_COMPARE-DH1_CLOSE.COMPARE_VALUE,0) CLOSE_COMPARE ,PROCESS_CLOSE_PRICE_DEPENDENT(II_CLOSE_SAR.INTERVALO_INFERIOR, II_CLOSE_SAR.INTERVALO_SUPERIOR, DH1_CLOSE.SAR, DH1_CLOSE.FECHA) CLOSE_SAR ,PROCESS_CLOSE(II_CLOSE_ADX.INTERVALO_INFERIOR, II_CLOSE_ADX.INTERVALO_SUPERIOR, DH1_CLOSE.ADX_VALUE*DH1_CLOSE.ADX_PLUS, DH1_CLOSE.ADX_VALUE*DH1_CLOSE.ADX_MINUS) CLOSE_ADX ,PROCESS_CLOSE(II_CLOSE_RSI.INTERVALO_INFERIOR, II_CLOSE_RSI.INTERVALO_SUPERIOR, DH1_CLOSE.RSI, 0) CLOSE_RSI ,PROCESS_CLOSE(II_CLOSE_BOLLINGER.INTERVALO_INFERIOR, II_CLOSE_BOLLINGER.INTERVALO_SUPERIOR, DH1_CLOSE.BOLLINGER_UPPER, DH1_CLOSE.BOLLINGER_LOWER) CLOSE_BOLLINGER ,PROCESS_CLOSE(II_CLOSE_MOMENTUM.INTERVALO_INFERIOR, II_CLOSE_MOMENTUM.INTERVALO_SUPERIOR, DH1_CLOSE.MOMENTUM, 0) CLOSE_MOMENTUM ,PROCESS_CLOSE_PRICE_DEPENDENT(II_CLOSE_ICHITREND.INTERVALO_INFERIOR, II_CLOSE_ICHITREND.INTERVALO_SUPERIOR, DH1_CLOSE.ICHIMOKUSENKOUSPANA-DH1_CLOSE.ICHIMOKUSENKOUSPANB, DH1_CLOSE.FECHA) CLOSE_ICHITREND ,PROCESS_CLOSE(II_CLOSE_ICHISIGNAL.INTERVALO_INFERIOR, II_CLOSE_ICHISIGNAL.INTERVALO_SUPERIOR, DH1_CLOSE.ICHIMOKUCHINKOUSPAN*DH1_CLOSE.ICHIMOKUTENKANSEN, DH1_CLOSE.ICHIMOKUCHINKOUSPAN*DH1_CLOSE.ICHIMOKUKIJUNSEN) CLOSE_ICHISIGNAL FROM DATOHISTORICO DH1_OPEN, DATOHISTORICO DH1_CLOSE, INDIVIDUO IND, INDICADOR_INDIVIDUO II_OPEN_MA, INDICADOR_INDIVIDUO II_CLOSE_MA, INDICADOR_INDIVIDUO II_OPEN_MACD, INDICADOR_INDIVIDUO II_CLOSE_MACD, INDICADOR_INDIVIDUO II_OPEN_COMPARE, INDICADOR_INDIVIDUO II_CLOSE_COMPARE, INDICADOR_INDIVIDUO II_OPEN_SAR, INDICADOR_INDIVIDUO II_CLOSE_SAR, INDICADOR_INDIVIDUO II_OPEN_ADX, INDICADOR_INDIVIDUO II_CLOSE_ADX, INDICADOR_INDIVIDUO II_OPEN_RSI, INDICADOR_INDIVIDUO II_CLOSE_RSI, INDICADOR_INDIVIDUO II_OPEN_BOLLINGER, INDICADOR_INDIVIDUO II_CLOSE_BOLLINGER, INDICADOR_INDIVIDUO II_OPEN_MOMENTUM, INDICADOR_INDIVIDUO II_CLOSE_MOMENTUM, INDICADOR_INDIVIDUO II_OPEN_ICHITREND, INDICADOR_INDIVIDUO II_CLOSE_ICHITREND, INDICADOR_INDIVIDUO II_OPEN_ICHISIGNAL, INDICADOR_INDIVIDUO II_CLOSE_ICHISIGNAL WHERE IND.ID=II_OPEN_MA.ID_INDIVIDUO AND IND.ID=II_CLOSE_MA.ID_INDIVIDUO AND IND.ID=II_OPEN_MACD.ID_INDIVIDUO AND IND.ID=II_CLOSE_MACD.ID_INDIVIDUO AND IND.ID=II_OPEN_COMPARE.ID_INDIVIDUO AND IND.ID=II_CLOSE_COMPARE.ID_INDIVIDUO AND IND.ID=II_OPEN_SAR.ID_INDIVIDUO AND IND.ID=II_CLOSE_SAR.ID_INDIVIDUO AND IND.ID=II_OPEN_ADX.ID_INDIVIDUO AND IND.ID=II_CLOSE_ADX.ID_INDIVIDUO AND IND.ID=II_OPEN_RSI.ID_INDIVIDUO AND IND.ID=II_CLOSE_RSI.ID_INDIVIDUO AND IND.ID=II_OPEN_BOLLINGER.ID_INDIVIDUO AND IND.ID=II_CLOSE_BOLLINGER.ID_INDIVIDUO AND IND.ID=II_OPEN_MOMENTUM.ID_INDIVIDUO AND IND.ID=II_CLOSE_MOMENTUM.ID_INDIVIDUO AND IND.ID=II_OPEN_ICHITREND.ID_INDIVIDUO AND IND.ID=II_CLOSE_ICHITREND.ID_INDIVIDUO AND IND.ID=II_OPEN_ICHISIGNAL.ID_INDIVIDUO AND IND.ID=II_CLOSE_ICHISIGNAL.ID_INDIVIDUO AND II_OPEN_MA.TIPO='OPEN' AND II_OPEN_MA.ID_INDICADOR='MA' AND II_OPEN_MACD.TIPO='OPEN' AND II_OPEN_MACD.ID_INDICADOR='MACD' AND II_OPEN_COMPARE.TIPO='OPEN' AND II_OPEN_COMPARE.ID_INDICADOR='COMPARE_MA' AND II_OPEN_SAR.TIPO='OPEN' AND II_OPEN_SAR.ID_INDICADOR='SAR' AND II_OPEN_ADX.TIPO='OPEN' AND II_OPEN_ADX.ID_INDICADOR='ADX' AND II_OPEN_RSI.TIPO='OPEN' AND II_OPEN_RSI.ID_INDICADOR='RSI' AND II_OPEN_BOLLINGER.TIPO='OPEN' AND II_OPEN_BOLLINGER.ID_INDICADOR='BOLLINGER' AND II_OPEN_MOMENTUM.TIPO='OPEN' AND II_OPEN_MOMENTUM.ID_INDICADOR='MOMENTUM' AND II_OPEN_ICHITREND.TIPO='OPEN' AND II_OPEN_ICHITREND.ID_INDICADOR='ICHIMOKU_TREND' AND II_OPEN_ICHISIGNAL.TIPO='OPEN' AND II_OPEN_ICHISIGNAL.ID_INDICADOR='ICHIMOKU_SIGNAL' AND II_CLOSE_MA.TIPO='CLOSE' AND II_CLOSE_MA.ID_INDICADOR='MA' AND II_CLOSE_MACD.TIPO='CLOSE' AND II_CLOSE_MACD.ID_INDICADOR='MACD' AND II_CLOSE_COMPARE.TIPO='CLOSE' AND II_CLOSE_COMPARE.ID_INDICADOR='COMPARE_MA' AND II_CLOSE_SAR.TIPO='CLOSE' AND II_CLOSE_SAR.ID_INDICADOR='SAR' AND II_CLOSE_ADX.TIPO='CLOSE' AND II_CLOSE_ADX.ID_INDICADOR='ADX' AND II_CLOSE_RSI.TIPO='CLOSE' AND II_CLOSE_RSI.ID_INDICADOR='RSI' AND II_CLOSE_BOLLINGER.TIPO='CLOSE' AND II_CLOSE_BOLLINGER.ID_INDICADOR='BOLLINGER' AND II_CLOSE_MOMENTUM.TIPO='CLOSE' AND II_CLOSE_MOMENTUM.ID_INDICADOR='MOMENTUM' AND II_CLOSE_ICHITREND.TIPO='CLOSE' AND II_CLOSE_ICHITREND.ID_INDICADOR='ICHIMOKU_TREND' AND II_CLOSE_ICHISIGNAL.TIPO='CLOSE' AND II_CLOSE_ICHISIGNAL.ID_INDICADOR='ICHIMOKU_SIGNAL' AND DH1_OPEN.AVERAGE IS NOT NULL AND DH1_OPEN.MACD_VALUE IS NOT NULL AND DH1_OPEN.MACD_SIGNAL IS NOT NULL AND DH1_OPEN.COMPARE_VALUE IS NOT NULL AND DH1_OPEN.AVERAGE_COMPARE IS NOT NULL AND DH1_OPEN.SAR IS NOT NULL AND DH1_OPEN.ADX_VALUE IS NOT NULL AND DH1_OPEN.ADX_PLUS IS NOT NULL AND DH1_OPEN.ADX_MINUS IS NOT NULL AND DH1_OPEN.RSI IS NOT NULL AND DH1_OPEN.BOLLINGER_UPPER IS NOT NULL AND DH1_OPEN.BOLLINGER_LOWER IS NOT NULL AND DH1_OPEN.MOMENTUM IS NOT NULL AND DH1_OPEN.ICHIMOKUTENKANSEN IS NOT NULL AND DH1_OPEN.ICHIMOKUKIJUNSEN IS NOT NULL AND DH1_OPEN.ICHIMOKUSENKOUSPANA IS NOT NULL AND DH1_OPEN.ICHIMOKUSENKOUSPANB IS NOT NULL AND DH1_OPEN.ICHIMOKUCHINKOUSPAN IS NOT NULL AND DH1_CLOSE.AVERAGE IS NOT NULL AND DH1_CLOSE.MACD_VALUE IS NOT NULL AND DH1_CLOSE.MACD_SIGNAL IS NOT NULL AND DH1_CLOSE.COMPARE_VALUE IS NOT NULL AND DH1_CLOSE.AVERAGE_COMPARE IS NOT NULL AND DH1_CLOSE.SAR IS NOT NULL AND DH1_CLOSE.ADX_VALUE IS NOT NULL AND DH1_CLOSE.ADX_PLUS IS NOT NULL AND DH1_CLOSE.ADX_MINUS IS NOT NULL AND DH1_CLOSE.RSI IS NOT NULL AND DH1_CLOSE.BOLLINGER_UPPER IS NOT NULL AND DH1_CLOSE.BOLLINGER_LOWER IS NOT NULL AND DH1_CLOSE.MOMENTUM IS NOT NULL AND DH1_CLOSE.ICHIMOKUTENKANSEN IS NOT NULL AND DH1_CLOSE.ICHIMOKUKIJUNSEN IS NOT NULL AND DH1_CLOSE.ICHIMOKUSENKOUSPANA IS NOT NULL AND DH1_CLOSE.ICHIMOKUSENKOUSPANB IS NOT NULL AND DH1_CLOSE.ICHIMOKUCHINKOUSPAN IS NOT NULL;
ALTER SESSION SET NLS_NUMERIC_CHARACTERS = '.,'; --SELECT SYSDATE, SYSDATE-1/24/60 FROM DUAL; SELECT 'EstrategiaId='||IND.ID||',VigenciaLower='|| TO_CHAR(V.FECHA_APERTURA-1/24/60,'YYYY.MM.DD HH24:MI') ||',VigenciaHigher='|| TO_CHAR(V.FECHA_CIERRE+1,'YYYY.MM.DD HH24:MI') ||','|| 'Active=true,Pair=USDCAD,Operation=Sell,TakeProfit='||IND.TAKE_PROFIT||',StopLoss='||IND.STOP_LOSS||',Lote='||IND.LOTE||','|| II_OPEN_MA.TIPO||II_OPEN_MA.ID_INDICADOR||'LOWER='||II_OPEN_MA.INTERVALO_INFERIOR*100||','||II_OPEN_MA.TIPO||II_OPEN_MA.ID_INDICADOR||'HIGHER='||II_OPEN_MA.INTERVALO_SUPERIOR*100||','|| II_OPEN_MACD.TIPO||II_OPEN_MACD.ID_INDICADOR||'LOWER='||II_OPEN_MACD.INTERVALO_INFERIOR*100||','||II_OPEN_MACD.TIPO||II_OPEN_MACD.ID_INDICADOR||'HIGHER='||II_OPEN_MACD.INTERVALO_SUPERIOR*100||','|| II_OPEN_COMPARE.TIPO||'MACOMPARE'||'LOWER='||II_OPEN_COMPARE.INTERVALO_INFERIOR*100||','||II_OPEN_COMPARE.TIPO||'MACOMPARE'||'HIGHER='||II_OPEN_COMPARE.INTERVALO_SUPERIOR*100||','|| II_OPEN_SAR.TIPO||II_OPEN_SAR.ID_INDICADOR||'LOWER='||II_OPEN_SAR.INTERVALO_INFERIOR*100||','||II_OPEN_SAR.TIPO||II_OPEN_SAR.ID_INDICADOR||'HIGHER='||II_OPEN_SAR.INTERVALO_SUPERIOR*100||','|| II_OPEN_ADX.TIPO||II_OPEN_ADX.ID_INDICADOR||'LOWER='||II_OPEN_ADX.INTERVALO_INFERIOR*100||','||II_OPEN_ADX.TIPO||II_OPEN_ADX.ID_INDICADOR||'HIGHER='||II_OPEN_ADX.INTERVALO_SUPERIOR*100||','|| II_OPEN_RSI.TIPO||II_OPEN_RSI.ID_INDICADOR||'LOWER='||II_OPEN_RSI.INTERVALO_INFERIOR*100||','||II_OPEN_RSI.TIPO||II_OPEN_RSI.ID_INDICADOR||'HIGHER='||II_OPEN_RSI.INTERVALO_SUPERIOR*100||','|| II_OPEN_BOLLINGER.TIPO||II_OPEN_BOLLINGER.ID_INDICADOR||'LOWER='||II_OPEN_BOLLINGER.INTERVALO_INFERIOR*100||','||II_OPEN_BOLLINGER.TIPO||II_OPEN_BOLLINGER.ID_INDICADOR||'HIGHER='||II_OPEN_BOLLINGER.INTERVALO_SUPERIOR*100||','|| II_OPEN_MOMENTUM.TIPO||II_OPEN_MOMENTUM.ID_INDICADOR||'LOWER='||II_OPEN_MOMENTUM.INTERVALO_INFERIOR*100||','||II_OPEN_MOMENTUM.TIPO||II_OPEN_MOMENTUM.ID_INDICADOR||'HIGHER='||II_OPEN_MOMENTUM.INTERVALO_SUPERIOR*100||','|| II_OPEN_ICHITREND.TIPO||'ICHITREND'||'LOWER='||II_OPEN_ICHITREND.INTERVALO_INFERIOR*100||','||II_OPEN_ICHITREND.TIPO||'ICHITREND'||'HIGHER='||II_OPEN_ICHITREND.INTERVALO_SUPERIOR*100||','|| II_OPEN_ICHISIGNAL.TIPO||'ICHISIGNAL'||'LOWER='||II_OPEN_ICHISIGNAL.INTERVALO_INFERIOR*100||','||II_OPEN_ICHISIGNAL.TIPO||'ICHISIGNAL'||'HIGHER='||II_OPEN_ICHISIGNAL.INTERVALO_SUPERIOR*100||','|| II_CLOSE_MA.TIPO||II_CLOSE_MA.ID_INDICADOR||'LOWER='||II_CLOSE_MA.INTERVALO_INFERIOR*100||','||II_CLOSE_MA.TIPO||II_CLOSE_MA.ID_INDICADOR||'HIGHER='||II_CLOSE_MA.INTERVALO_SUPERIOR*100||','|| II_CLOSE_MACD.TIPO||II_CLOSE_MACD.ID_INDICADOR||'LOWER='||II_CLOSE_MACD.INTERVALO_INFERIOR*100||','||II_CLOSE_MACD.TIPO||II_CLOSE_MACD.ID_INDICADOR||'HIGHER='||II_CLOSE_MACD.INTERVALO_SUPERIOR*100||','|| II_CLOSE_COMPARE.TIPO||'MACOMPARE'||'LOWER='||II_CLOSE_COMPARE.INTERVALO_INFERIOR*100||','||II_CLOSE_COMPARE.TIPO||'MACOMPARE'||'HIGHER='||II_CLOSE_COMPARE.INTERVALO_SUPERIOR*100||','|| II_CLOSE_SAR.TIPO||II_CLOSE_SAR.ID_INDICADOR||'LOWER='||II_CLOSE_SAR.INTERVALO_INFERIOR*100||','||II_CLOSE_SAR.TIPO||II_CLOSE_SAR.ID_INDICADOR||'HIGHER='||II_CLOSE_SAR.INTERVALO_SUPERIOR*100||','|| II_CLOSE_ADX.TIPO||II_CLOSE_ADX.ID_INDICADOR||'LOWER='||II_CLOSE_ADX.INTERVALO_INFERIOR*100||','||II_CLOSE_ADX.TIPO||II_CLOSE_ADX.ID_INDICADOR||'HIGHER='||II_CLOSE_ADX.INTERVALO_SUPERIOR*100||','|| II_CLOSE_RSI.TIPO||II_CLOSE_RSI.ID_INDICADOR||'LOWER='||II_CLOSE_RSI.INTERVALO_INFERIOR*100||','||II_CLOSE_RSI.TIPO||II_CLOSE_RSI.ID_INDICADOR||'HIGHER='||II_CLOSE_RSI.INTERVALO_SUPERIOR*100||','|| II_CLOSE_BOLLINGER.TIPO||II_CLOSE_BOLLINGER.ID_INDICADOR||'LOWER='||II_CLOSE_BOLLINGER.INTERVALO_INFERIOR*100||','||II_CLOSE_BOLLINGER.TIPO||II_CLOSE_BOLLINGER.ID_INDICADOR||'HIGHER='||II_CLOSE_BOLLINGER.INTERVALO_SUPERIOR*100||','|| II_CLOSE_MOMENTUM.TIPO||II_CLOSE_MOMENTUM.ID_INDICADOR||'LOWER='||II_CLOSE_MOMENTUM.INTERVALO_INFERIOR*100||','||II_CLOSE_MOMENTUM.TIPO||II_CLOSE_MOMENTUM.ID_INDICADOR||'HIGHER='||II_CLOSE_MOMENTUM.INTERVALO_SUPERIOR*100||','|| II_CLOSE_ICHITREND.TIPO||'ICHITREND'||'LOWER='||II_CLOSE_ICHITREND.INTERVALO_INFERIOR*100||','||II_CLOSE_ICHITREND.TIPO||'ICHITREND'||'HIGHER='||II_CLOSE_ICHITREND.INTERVALO_SUPERIOR*100||','|| II_CLOSE_ICHISIGNAL.TIPO||'ICHISIGNAL'||'LOWER='||II_CLOSE_ICHISIGNAL.INTERVALO_INFERIOR*100||','||II_CLOSE_ICHISIGNAL.TIPO||'ICHISIGNAL'||'HIGHER='||II_CLOSE_ICHISIGNAL.INTERVALO_SUPERIOR*100 ||',' FILESTRING FROM INDICADOR_INDIVIDUO II_OPEN_MA, INDICADOR_INDIVIDUO II_CLOSE_MA, INDICADOR_INDIVIDUO II_OPEN_MACD, INDICADOR_INDIVIDUO II_CLOSE_MACD, INDICADOR_INDIVIDUO II_OPEN_COMPARE, INDICADOR_INDIVIDUO II_CLOSE_COMPARE, INDICADOR_INDIVIDUO II_OPEN_SAR, INDICADOR_INDIVIDUO II_CLOSE_SAR, INDICADOR_INDIVIDUO II_OPEN_ADX, INDICADOR_INDIVIDUO II_CLOSE_ADX, INDICADOR_INDIVIDUO II_OPEN_RSI, INDICADOR_INDIVIDUO II_CLOSE_RSI, INDICADOR_INDIVIDUO II_OPEN_BOLLINGER, INDICADOR_INDIVIDUO II_CLOSE_BOLLINGER, INDICADOR_INDIVIDUO II_OPEN_MOMENTUM, INDICADOR_INDIVIDUO II_CLOSE_MOMENTUM, INDICADOR_INDIVIDUO II_OPEN_ICHITREND, INDICADOR_INDIVIDUO II_CLOSE_ICHITREND, INDICADOR_INDIVIDUO II_OPEN_ICHISIGNAL, INDICADOR_INDIVIDUO II_CLOSE_ICHISIGNAL, INDIVIDUO IND, TMP_VIEW V WHERE IND.ID=II_OPEN_MA.ID_INDIVIDUO AND IND.ID=II_CLOSE_MA.ID_INDIVIDUO AND IND.ID=II_OPEN_MACD.ID_INDIVIDUO AND IND.ID=II_CLOSE_MACD.ID_INDIVIDUO AND IND.ID=II_OPEN_COMPARE.ID_INDIVIDUO AND IND.ID=II_CLOSE_COMPARE.ID_INDIVIDUO AND IND.ID=II_OPEN_SAR.ID_INDIVIDUO AND IND.ID=II_CLOSE_SAR.ID_INDIVIDUO AND IND.ID=II_OPEN_ADX.ID_INDIVIDUO AND IND.ID=II_CLOSE_ADX.ID_INDIVIDUO AND IND.ID=II_OPEN_RSI.ID_INDIVIDUO AND IND.ID=II_CLOSE_RSI.ID_INDIVIDUO AND IND.ID=II_OPEN_BOLLINGER.ID_INDIVIDUO AND IND.ID=II_CLOSE_BOLLINGER.ID_INDIVIDUO AND IND.ID=II_OPEN_MOMENTUM.ID_INDIVIDUO AND IND.ID=II_CLOSE_MOMENTUM.ID_INDIVIDUO AND IND.ID=II_OPEN_ICHITREND.ID_INDIVIDUO AND IND.ID=II_CLOSE_ICHITREND.ID_INDIVIDUO AND IND.ID=II_OPEN_ICHISIGNAL.ID_INDIVIDUO AND IND.ID=II_CLOSE_ICHISIGNAL.ID_INDIVIDUO AND II_OPEN_MA.TIPO='OPEN' AND II_OPEN_MA.ID_INDICADOR='MA' AND II_OPEN_MACD.TIPO='OPEN' AND II_OPEN_MACD.ID_INDICADOR='MACD' AND II_OPEN_COMPARE.TIPO='OPEN' AND II_OPEN_COMPARE.ID_INDICADOR='COMPARE_MA' AND II_OPEN_SAR.TIPO='OPEN' AND II_OPEN_SAR.ID_INDICADOR='SAR' AND II_OPEN_ADX.TIPO='OPEN' AND II_OPEN_ADX.ID_INDICADOR='ADX' AND II_OPEN_RSI.TIPO='OPEN' AND II_OPEN_RSI.ID_INDICADOR='RSI' AND II_OPEN_BOLLINGER.TIPO='OPEN' AND II_OPEN_BOLLINGER.ID_INDICADOR='BOLLINGER' AND II_OPEN_MOMENTUM.TIPO='OPEN' AND II_OPEN_MOMENTUM.ID_INDICADOR='MOMENTUM' AND II_OPEN_ICHITREND.TIPO='OPEN' AND II_OPEN_ICHITREND.ID_INDICADOR='ICHIMOKU_TREND' AND II_OPEN_ICHISIGNAL.TIPO='OPEN' AND II_OPEN_ICHISIGNAL.ID_INDICADOR='ICHIMOKU_SIGNAL' AND II_CLOSE_MA.TIPO='CLOSE' AND II_CLOSE_MA.ID_INDICADOR='MA' AND II_CLOSE_MACD.TIPO='CLOSE' AND II_CLOSE_MACD.ID_INDICADOR='MACD' AND II_CLOSE_COMPARE.TIPO='CLOSE' AND II_CLOSE_COMPARE.ID_INDICADOR='COMPARE_MA' AND II_CLOSE_SAR.TIPO='CLOSE' AND II_CLOSE_SAR.ID_INDICADOR='SAR' AND II_CLOSE_ADX.TIPO='CLOSE' AND II_CLOSE_ADX.ID_INDICADOR='ADX' AND II_CLOSE_RSI.TIPO='CLOSE' AND II_CLOSE_RSI.ID_INDICADOR='RSI' AND II_CLOSE_BOLLINGER.TIPO='CLOSE' AND II_CLOSE_BOLLINGER.ID_INDICADOR='BOLLINGER' AND II_CLOSE_MOMENTUM.TIPO='CLOSE' AND II_CLOSE_MOMENTUM.ID_INDICADOR='MOMENTUM' AND II_CLOSE_ICHITREND.TIPO='CLOSE' AND II_CLOSE_ICHITREND.ID_INDICADOR='ICHIMOKU_TREND' AND II_CLOSE_ICHISIGNAL.TIPO='CLOSE' AND II_CLOSE_ICHISIGNAL.ID_INDICADOR='ICHIMOKU_SIGNAL' AND IND.ID = V.ID_INDIVIDUO ;
SELECT SYSDATE, SYSDATE-1/24/60 FROM DUAL;
SELECT OPER1.*, CONTADOR.CO --CONTADOR.CO, CONTADOR.DIFF, SUM(OPER1.PIPS) SUMA FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2, OPERACION OPER1, (SELECT * FROM (SELECT (T2.SUMA_PIPS-T1.SUMA_PIPS) DIFF, COUNT(*) CO FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2 WHERE T2.FECHA_OPERACION > T1.FECHA_OPERACION AND (T2.SUMA_PIPS-T1.SUMA_PIPS)>0 GROUP BY (T2.SUMA_PIPS-T1.SUMA_PIPS) --HAVING COUNT(*)=21 ORDER BY COUNT(*) DESC) WHERE ROWNUM T1.FECHA_OPERACION AND OPER1.FECHA_APERTURA=(SELECT MIN(OPER2.FECHA_APERTURA) FROM OPERACION OPER2 WHERE OPER2.FECHA_APERTURA>T2.FECHA_OPERACION) AND (T2.SUMA_PIPS - T1.SUMA_PIPS)=CONTADOR.DIFF -- GROUP BY CONTADOR.CO, CONTADOR.DIFF ORDER BY CONTADOR.CO DESC , T1.FECHA_OPERACION ASC;
SELECT (T2.SUMA_PIPS-T1.SUMA_PIPS) DIFF, COUNT(*) FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2 WHERE T2.FECHA_OPERACION > T1.FECHA_OPERACION --AND (T2.SUMA_PIPS-T1.SUMA_PIPS)>0 GROUP BY (T2.SUMA_PIPS-T1.SUMA_PIPS) ORDER BY COUNT(*) DESC;
SELECT (T2.SUMA_PIPS-T1.SUMA_PIPS) DIFF, COUNT(*) FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2 WHERE T2.FECHA_OPERACION > T1.FECHA_OPERACION GROUP BY (T2.SUMA_PIPS-T1.SUMA_PIPS) ORDER BY COUNT(*) ASC;
SELECT T2.* --(T2.SUMA_PIPS-T1.SUMA_PIPS) DIFF, COUNT(*) FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2 WHERE T2.FECHA_OPERACION > T1.FECHA_OPERACION --GROUP BY (T2.SUMA_PIPS-T1.SUMA_PIPS) --ORDER BY COUNT(*) ASC;
SELECT --OPER1.*, CONTADOR.CO CONTADOR.CO, SUM(OPER1.PIPS) FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2, OPERACION OPER1, (SELECT * FROM (SELECT (T2.SUMA_PIPS-T1.SUMA_PIPS) DIFF, COUNT(*) CO FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2 WHERE T2.FECHA_OPERACION > T1.FECHA_OPERACION GROUP BY (T2.SUMA_PIPS-T1.SUMA_PIPS) --HAVING COUNT(*)=21 ORDER BY COUNT(*) DESC) --WHERE ROWNUM T1.FECHA_OPERACION AND OPER1.FECHA_APERTURA=(SELECT MIN(OPER2.FECHA_APERTURA) FROM OPERACION OPER2 WHERE OPER2.FECHA_APERTURA>T2.FECHA_OPERACION) AND (T2.SUMA_PIPS - T1.SUMA_PIPS)=CONTADOR.DIFF GROUP BY CONTADOR.CO ORDER BY CONTADOR.CO DESC --, T1.FECHA_OPERACION ASC;
SELECT --OPER1.*, CONTADOR.CO SUM(OPER1.PIPS) FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2, OPERACION OPER1, (SELECT * FROM (SELECT (T2.SUMA_PIPS-T1.SUMA_PIPS) DIFF, COUNT(*) CO FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2 WHERE T2.FECHA_OPERACION > T1.FECHA_OPERACION GROUP BY (T2.SUMA_PIPS-T1.SUMA_PIPS) HAVING COUNT(*)=21 ORDER BY COUNT(*) DESC) WHERE ROWNUM T1.FECHA_OPERACION AND OPER1.FECHA_APERTURA=(SELECT MIN(OPER2.FECHA_APERTURA) FROM OPERACION OPER2 WHERE OPER2.FECHA_APERTURA>T2.FECHA_OPERACION) AND (T2.SUMA_PIPS - T1.SUMA_PIPS)=CONTADOR.DIFF ORDER BY CONTADOR.CO DESC, T1.FECHA_OPERACION ASC;
SELECT --OPER1.*, CONTADOR.CO SUM(OPER1.PIPS) FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2, OPERACION OPER1, (SELECT * FROM (SELECT (T2.SUMA_PIPS-T1.SUMA_PIPS) DIFF, COUNT(*) CO FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2 WHERE T2.FECHA_OPERACION > T1.FECHA_OPERACION GROUP BY (T2.SUMA_PIPS-T1.SUMA_PIPS) HAVING COUNT(*)=29 ORDER BY COUNT(*) DESC) WHERE ROWNUM T1.FECHA_OPERACION AND OPER1.FECHA_APERTURA=(SELECT MIN(OPER2.FECHA_APERTURA) FROM OPERACION OPER2 WHERE OPER2.FECHA_APERTURA>T2.FECHA_OPERACION) AND (T2.SUMA_PIPS - T1.SUMA_PIPS)=CONTADOR.DIFF ORDER BY CONTADOR.CO DESC, T1.FECHA_OPERACION ASC;
SELECT --OPER1.*, CONTADOR.CO SUM(OPER1.PIPS) FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2, OPERACION OPER1, (SELECT * FROM (SELECT (T2.SUMA_PIPS-T1.SUMA_PIPS) DIFF, COUNT(*) CO FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2 WHERE T2.FECHA_OPERACION > T1.FECHA_OPERACION GROUP BY (T2.SUMA_PIPS-T1.SUMA_PIPS) HAVING COUNT(*)=40 ORDER BY COUNT(*) DESC) WHERE ROWNUM T1.FECHA_OPERACION AND OPER1.FECHA_APERTURA=(SELECT MIN(OPER2.FECHA_APERTURA) FROM OPERACION OPER2 WHERE OPER2.FECHA_APERTURA>T2.FECHA_OPERACION) AND (T2.SUMA_PIPS - T1.SUMA_PIPS)=CONTADOR.DIFF ORDER BY CONTADOR.CO DESC, T1.FECHA_OPERACION ASC;
SELECT OPER1.*, CONTADOR.CO --SUM(OPER1.PIPS), COUNT(*) FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2, OPERACION OPER1, (SELECT * FROM (SELECT (T2.SUMA_PIPS-T1.SUMA_PIPS) DIFF, COUNT(*) CO FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2 WHERE T2.FECHA_OPERACION > T1.FECHA_OPERACION GROUP BY (T2.SUMA_PIPS-T1.SUMA_PIPS) ORDER BY COUNT(*) DESC) WHERE ROWNUM T1.FECHA_OPERACION AND OPER1.FECHA_APERTURA=(SELECT MIN(OPER2.FECHA_APERTURA) FROM OPERACION OPER2 WHERE OPER2.FECHA_APERTURA>T2.FECHA_OPERACION) AND (T2.SUMA_PIPS - T1.SUMA_PIPS)=CONTADOR.DIFF ORDER BY CONTADOR.CO DESC, T1.FECHA_OPERACION ASC;
SELECT OPER1.* --SUM(OPER1.PIPS), COUNT(*) FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2, OPERACION OPER1, (SELECT * FROM (SELECT (T2.SUMA_PIPS-T1.SUMA_PIPS) DIFF, COUNT(*) CO FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2 WHERE T2.FECHA_OPERACION > T1.FECHA_OPERACION GROUP BY (T2.SUMA_PIPS-T1.SUMA_PIPS) ORDER BY COUNT(*) DESC) WHERE ROWNUM T1.FECHA_OPERACION AND OPER1.FECHA_APERTURA=(SELECT MIN(OPER2.FECHA_APERTURA) FROM OPERACION OPER2 WHERE OPER2.FECHA_APERTURA>T2.FECHA_OPERACION) AND (T2.SUMA_PIPS - T1.SUMA_PIPS)=CONTADOR.DIFF ORDER BY CONTADOR.CO DESC, T1.FECHA_OPERACION ASC;
SELECT OPER1.* --SUM(OPER1.PIPS), COUNT(*) FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2, OPERACION OPER1, (SELECT * FROM (SELECT (T2.SUMA_PIPS-T1.SUMA_PIPS) DIFF, COUNT(*) CO FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2 WHERE T2.FECHA_OPERACION > T1.FECHA_OPERACION GROUP BY (T2.SUMA_PIPS-T1.SUMA_PIPS) ORDER BY COUNT(*) DESC) WHERE ROWNUM T1.FECHA_OPERACION AND OPER1.FECHA_APERTURA=(SELECT MIN(OPER2.FECHA_APERTURA) FROM OPERACION OPER2 WHERE OPER2.FECHA_APERTURA>T2.FECHA_OPERACION) AND (T2.SUMA_PIPS - T1.SUMA_PIPS)=CONTADOR.DIFF ORDER BY CONTADOR.CO DESC, T1.FECHA_OPERACION ASC;
SELECT OPER1.* FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2, OPERACION OPER1, (SELECT * FROM (SELECT (T2.SUMA_PIPS-T1.SUMA_PIPS) DIFF, COUNT(*) CO FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2 WHERE T2.FECHA_OPERACION > T1.FECHA_OPERACION GROUP BY (T2.SUMA_PIPS-T1.SUMA_PIPS) ORDER BY COUNT(*) DESC) WHERE ROWNUM T1.FECHA_OPERACION AND OPER1.FECHA_APERTURA=(SELECT MIN(OPER2.FECHA_APERTURA) FROM OPERACION OPER2 WHERE OPER2.FECHA_APERTURA>T2.FECHA_OPERACION) AND (T2.SUMA_PIPS - T1.SUMA_PIPS)=CONTADOR.DIFF ORDER BY CONTADOR.CO DESC, T1.FECHA_OPERACION ASC;
SELECT * FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2, (SELECT * FROM (SELECT (T2.SUMA_PIPS-T1.SUMA_PIPS) DIFF, COUNT(*) CO FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2 WHERE T2.FECHA_OPERACION > T1.FECHA_OPERACION GROUP BY (T2.SUMA_PIPS-T1.SUMA_PIPS) ORDER BY COUNT(*) DESC) WHERE ROWNUM T1.FECHA_OPERACION --AND OPER1.FECHA_APERTURA=(SELECT MIN(OPER2.FECHA_APERTURA) FROM OPERACION OPER2 WHERE OPER2.FECHA_APERTURA>T2.FECHA_OPERACION) AND (T2.SUMA_PIPS - T1.SUMA_PIPS)=CONTADOR.DIFF ORDER BY CONTADOR.CO DESC, T1.FECHA_OPERACION ASC --WHERE OPER2.FECHA_APERTURA>SUB_FOPERACION.FECHA_OPERACION ;
SELECT * FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2, (SELECT (T2.SUMA_PIPS-T1.SUMA_PIPS) DIFF, COUNT(*) CO FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2 WHERE T2.FECHA_OPERACION > T1.FECHA_OPERACION GROUP BY (T2.SUMA_PIPS-T1.SUMA_PIPS) ORDER BY COUNT(*) DESC) CONTADOR WHERE T2.FECHA_OPERACION > T1.FECHA_OPERACION --AND OPER1.FECHA_APERTURA=(SELECT MIN(OPER2.FECHA_APERTURA) FROM OPERACION OPER2 WHERE OPER2.FECHA_APERTURA>T2.FECHA_OPERACION) AND (T2.SUMA_PIPS - T1.SUMA_PIPS)=CONTADOR.DIFF ORDER BY CONTADOR.CO DESC, T1.FECHA_OPERACION ASC --WHERE OPER2.FECHA_APERTURA>SUB_FOPERACION.FECHA_OPERACION ;
SELECT T2.FECHA_OPERACION FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2, (SELECT (T2.SUMA_PIPS-T1.SUMA_PIPS) DIFF, COUNT(*) CO FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2 WHERE T2.FECHA_OPERACION > T1.FECHA_OPERACION GROUP BY (T2.SUMA_PIPS-T1.SUMA_PIPS) ORDER BY COUNT(*) DESC) CONTADOR WHERE T2.FECHA_OPERACION > T1.FECHA_OPERACION --AND OPER1.FECHA_APERTURA=(SELECT MIN(OPER2.FECHA_APERTURA) FROM OPERACION OPER2 WHERE OPER2.FECHA_APERTURA>T2.FECHA_OPERACION) AND (T2.SUMA_PIPS - T1.SUMA_PIPS)=CONTADOR.DIFF ORDER BY CONTADOR.CO DESC
SELECT * FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2, (SELECT (T2.SUMA_PIPS-T1.SUMA_PIPS) DIFF, COUNT(*) CO FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2 WHERE T2.FECHA_OPERACION > T1.FECHA_OPERACION GROUP BY (T2.SUMA_PIPS-T1.SUMA_PIPS) ORDER BY COUNT(*) DESC) CONTADOR WHERE T2.FECHA_OPERACION > T1.FECHA_OPERACION --AND OPER1.FECHA_APERTURA=(SELECT MIN(OPER2.FECHA_APERTURA) FROM OPERACION OPER2 WHERE OPER2.FECHA_APERTURA>T2.FECHA_OPERACION) AND (T2.SUMA_PIPS - T1.SUMA_PIPS)=CONTADOR.DIFF ORDER BY CONTADOR.CO DESC;
SELECT MIN(OPER2.FECHA_APERTURA) FROM OPERACION OPER2 WHERE OPER2.FECHA_APERTURA>SYSDATE-4000;
SELECT * FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2, (SELECT (T2.SUMA_PIPS-T1.SUMA_PIPS) DIFF, COUNT(*) CO FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2 WHERE T2.FECHA_OPERACION > T1.FECHA_OPERACION GROUP BY (T2.SUMA_PIPS-T1.SUMA_PIPS) ORDER BY COUNT(*) DESC) CONTADOR WHERE T2.FECHA_OPERACION > T1.FECHA_OPERACION --AND OPER1.FECHA_APERTURA>T2.FECHA_OPERACION AND (T2.SUMA_PIPS - T1.SUMA_PIPS)=CONTADOR.DIFF --AND ROWNUM<2;
SELECT OPER1.* FROM TENDENCIA_PIPS T1, TENDENCIA_PIPS T2, OPERACION OPER1 WHERE T2.FECHA_OPERACION > T1.FECHA_OPERACION AND OPER1.FECHA_APERTURA>T2.FECHA_OPERACION --(SELECT MIN(OPER2.FECHA_APERTURA) FROM OPERACION OPER2 WHERE OPER1.FECHA_APERTURA>T2.FECHA_OPERACION) AND (T2.SUMA_PIPS - T1.SUMA_PIPS)=226 AND ROWNUM<2;
SELECT * FROM OPERACION WHERE FECHA_APERTURA<=(SELECT NVL(TO_DATE(PARAM.VALOR,'YYYY/MM/DD HH24:MI'),SYSDATE) FROM PARAMETRO PARAM WHERE NOMBRE='FECHA_ESTADISTICAS') AND FECHA_APERTURA>(SELECT MIN(FECHA_APERTURA) FROM OPERACION) ORDER BY FECHA_APERTURA ASC;
SELECT (OPER2.OPEN_PRICE - OPER1.OPEN_PRICE) DIFERENCIA_OPEN, COUNT(*) CONTAR, OPER2.OPEN_PRICE --, OPER1.*, OPER2.* --, COUNT(*) CO FROM OPERACION OPER1, OPERACION OPER2 WHERE OPER2.FECHA_APERTURA <> OPER1.FECHA_APERTURA AND OPER2.FECHA_APERTURA > OPER1.FECHA_APERTURA AND (OPER2.FECHA_APERTURA - OPER1.FECHA_APERTURA) < 30 AND ROWNUM < 20000 GROUP BY (OPER2.OPEN_PRICE - OPER1.OPEN_PRICE), OPER2.OPEN_PRICE ORDER BY COUNT(*) DESC;
SELECT ROUND(PROMEDIO_PIPS_OPER()) PROMEDIO, ROUND(VARIANZA_PIPS_OPER()) VARIANZA, ROUND(DESV_ESTANDAR_PIPS_OPER()) DESV_ESTANDARD, ROUND(PROMEDIO_PIPS_OPER()-DESV_ESTANDAR_PIPS_OPER()) PROB_68_MINUS, ROUND(PROMEDIO_PIPS_OPER()+DESV_ESTANDAR_PIPS_OPER()) PROB_68_PLUS, ROUND(PROMEDIO_PIPS_OPER()-2*DESV_ESTANDAR_PIPS_OPER()) PROB_95_MINUS, ROUND(PROMEDIO_PIPS_OPER()+2*DESV_ESTANDAR_PIPS_OPER()) PROB_95_PLUS, ROUND(PROMEDIO_PIPS_OPER()-3*DESV_ESTANDAR_PIPS_OPER()) PROB_98_MINUS, ROUND(PROMEDIO_PIPS_OPER()+3*DESV_ESTANDAR_PIPS_OPER()) PROB_98_PLUS FROM DUAL;
DROP PROCEDURE CALCULAR_CLOSE_PRICE_TP; create or replace FUNCTION CALCULAR_CLOSE_PRICE_TP ( FECHA_CURRENT IN DATE ) RETURN NUMBER AS CLOSE_PRICE NUMBER; FECHA_PREV DATE; REG_DH FOREX.DATOHISTORICO%ROWTYPE; CURSOR C_DATOHISTORICO(FECHA_PROCESO IN DATE) IS SELECT * FROM DATOHISTORICO WHERE FECHA=FECHA_PROCESO;-- AND PAR=PAR_PROCESO; BEGIN SELECT MIN(FECHA) INTO FECHA_PREV FROM DATOHISTORICO WHERE FECHA > FECHA_CURRENT;-- AND PAR=PAR_PROCESO; OPEN C_DATOHISTORICO(FECHA_PREV); FETCH C_DATOHISTORICO INTO REG_DH; CLOSE_PRICE := REG_DH.LOW; CLOSE C_DATOHISTORICO; RETURN CLOSE_PRICE; END CALCULAR_CLOSE_PRICE_TP;
SELECT * FROM FOREX.INDIVIDUO_BORRADO WHERE ID='1341687718670.12771';
SELECT * FROM (SELECT POSITIVOS.ID_INDIVIDUO, COUNT(POSITIVOS.ID_INDIVIDUO), SUM(POSITIVOS.PIPS) FROM FOREX.OPERACION POSITIVOS WHERE POSITIVOS.PIPS>0 GROUP BY POSITIVOS.ID_INDIVIDUO) P, (SELECT NEGATIVOS.ID_INDIVIDUO, COUNT(NEGATIVOS.ID_INDIVIDUO), SUM(NEGATIVOS.PIPS) FROM FOREX.OPERACION NEGATIVOS WHERE NEGATIVOS.PIPS
SELECT * FROM FOREX.PROCESO WHERE ID_INDIVIDUO='1329927210938.9644';
SELECT TO_CHAR(FECHA_PROCESO, 'YYYY/MM/DD HH24:MI:SS'), COUNT(*) FROM FOREX.PROCESO GROUP BY FECHA_PROCESO ORDER BY FECHA_PROCESO DESC;
SELECT IND.ID, DH1_OPEN.FECHA OPEN_FECHA, min(DH1_CLOSE.FECHA) CLOSE_FECHA /*IND.ID, IND.TAKE_PROFIT, IND.STOP_LOSS, DH1_OPEN.FECHA OPEN_FECHA, (DH1_OPEN.OPEN+DH1_OPEN.CLOSE+DH1_OPEN.HIGH+DH1_OPEN.LOW)/4 OPEN_VALUE, DH1_CLOSE.FECHA CLOSE_FECHA, (DH1_CLOSE.OPEN+DH1_CLOSE.CLOSE+DH1_CLOSE.HIGH+DH1_CLOSE.LOW)/4 CLOSE_VALUE, (((DH1_OPEN.OPEN+DH1_OPEN.CLOSE+DH1_OPEN.HIGH+DH1_OPEN.LOW)/4 - (DH1_CLOSE.OPEN+DH1_CLOSE.CLOSE+DH1_CLOSE.HIGH+DH1_CLOSE.LOW)/4)*100000)-DH1_OPEN.SPREAD PIPS, DH1_OPEN.SPREAD*/ FROM DATOHISTORICO DH1_OPEN, DATOHISTORICO DH1_CLOSE, INDIVIDUO IND, INDICADOR_INDIVIDUO II_OPEN, INDICADOR_INDIVIDUO II_CLOSE WHERE IND.ID=II_OPEN.ID_INDIVIDUO AND IND.ID=II_CLOSE.ID_INDIVIDUO AND II_OPEN.ID_INDICADOR='MA' AND II_CLOSE.ID_INDICADOR='MA' AND II_OPEN.TIPO='OPEN' AND II_CLOSE.TIPO='CLOSE' AND (DH1_OPEN.AVERAGE-(DH1_OPEN.OPEN+DH1_OPEN.CLOSE+DH1_OPEN.HIGH+DH1_OPEN.LOW)/4)>=II_OPEN.INTERVALO_INFERIOR AND (DH1_OPEN.AVERAGE-(DH1_OPEN.OPEN+DH1_OPEN.CLOSE+DH1_OPEN.HIGH+DH1_OPEN.LOW)/4)<=II_OPEN.INTERVALO_SUPERIOR AND ((II_CLOSE.INTERVALO_INFERIOR IS NOT NULL AND II_CLOSE.INTERVALO_SUPERIOR IS NOT NULL AND ((DH1_CLOSE.AVERAGE-(DH1_CLOSE.OPEN+DH1_CLOSE.CLOSE+DH1_CLOSE.HIGH+DH1_CLOSE.LOW)/4)>=II_CLOSE.INTERVALO_INFERIOR AND (DH1_CLOSE.AVERAGE-(DH1_CLOSE.OPEN+DH1_CLOSE.CLOSE+DH1_CLOSE.HIGH+DH1_CLOSE.LOW)/4)<=II_CLOSE.INTERVALO_SUPERIOR)) OR ((((DH1_OPEN.OPEN+DH1_OPEN.CLOSE+DH1_OPEN.HIGH+DH1_OPEN.LOW)/4 - (DH1_CLOSE.OPEN+DH1_CLOSE.CLOSE+DH1_CLOSE.HIGH+DH1_CLOSE.LOW)/4)*100000)-DH1_OPEN.SPREAD >= IND.TAKE_PROFIT) OR ((((DH1_OPEN.OPEN+DH1_OPEN.CLOSE+DH1_OPEN.HIGH+DH1_OPEN.LOW)/4 - (DH1_CLOSE.OPEN+DH1_CLOSE.CLOSE+DH1_CLOSE.HIGH+DH1_CLOSE.LOW)/4)*100000)-DH1_OPEN.SPREAD <= -IND.STOP_LOSS) --OR (DH1_CLOSE.FECHA>=TO_DATE('2012/06/14 12:40', 'YYYY/MM/DD HH24:MI')) ) AND DH1_CLOSE.FECHA > DH1_OPEN.FECHA AND DH1_OPEN.FECHA > SYSDATE-100 AND ROWNUM < 200 GROUP BY IND.ID, DH1_OPEN.FECHA ORDER BY DH1_OPEN.FECHA ASC;
SELECT IND.ID, IND.TAKE_PROFIT, IND.STOP_LOSS, DH1_OPEN.FECHA, DH1_CLOSE.FECHA, ((DH1_CLOSE.OPEN+DH1_CLOSE.CLOSE+DH1_CLOSE.HIGH+DH1_CLOSE.LOW)/4 - (DH1_OPEN.OPEN+DH1_OPEN.CLOSE+DH1_OPEN.HIGH+DH1_OPEN.LOW)/4)*100000 PIPS FROM DATOHISTORICO DH1_OPEN, DATOHISTORICO DH1_CLOSE, INDIVIDUO IND, INDICADOR_INDIVIDUO II_OPEN, INDICADOR_INDIVIDUO II_CLOSE WHERE IND.ID=II_OPEN.ID_INDIVIDUO AND IND.ID=II_CLOSE.ID_INDIVIDUO AND II_OPEN.ID_INDICADOR='MA' AND II_CLOSE.ID_INDICADOR='MA' AND II_OPEN.TIPO='OPEN' AND II_CLOSE.TIPO='CLOSE' AND (DH1_OPEN.AVERAGE-(DH1_OPEN.OPEN+DH1_OPEN.CLOSE+DH1_OPEN.HIGH+DH1_OPEN.LOW)/4)>=II_OPEN.INTERVALO_INFERIOR AND (DH1_OPEN.AVERAGE-(DH1_OPEN.OPEN+DH1_OPEN.CLOSE+DH1_OPEN.HIGH+DH1_OPEN.LOW)/4)<=II_OPEN.INTERVALO_SUPERIOR AND (((DH1_CLOSE.AVERAGE-(DH1_CLOSE.OPEN+DH1_CLOSE.CLOSE+DH1_CLOSE.HIGH+DH1_CLOSE.LOW)/4)>=II_CLOSE.INTERVALO_INFERIOR AND (DH1_CLOSE.AVERAGE-(DH1_CLOSE.OPEN+DH1_CLOSE.CLOSE+DH1_CLOSE.HIGH+DH1_CLOSE.LOW)/4)<=II_CLOSE.INTERVALO_SUPERIOR) OR (((DH1_CLOSE.OPEN+DH1_CLOSE.CLOSE+DH1_CLOSE.HIGH+DH1_CLOSE.LOW)/4 - (DH1_OPEN.OPEN+DH1_OPEN.CLOSE+DH1_OPEN.HIGH+DH1_OPEN.LOW)/4*100000) >= IND.TAKE_PROFIT) OR (((DH1_CLOSE.OPEN+DH1_CLOSE.CLOSE+DH1_CLOSE.HIGH+DH1_CLOSE.LOW)/4 - (DH1_OPEN.OPEN+DH1_OPEN.CLOSE+DH1_OPEN.HIGH+DH1_OPEN.LOW)/4*100000) <= -IND.STOP_LOSS) ) AND DH1_CLOSE.FECHA > DH1_OPEN.FECHA AND ROWNUM < 20 ORDER BY DH1_OPEN.FECHA ASC;
SELECT count(*) FROM INDIVIDUO;
